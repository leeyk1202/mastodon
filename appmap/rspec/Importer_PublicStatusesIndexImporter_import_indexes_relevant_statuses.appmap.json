{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","status":["M .husky/pre-commit"],"git_last_annotated_tag":"0.1.2-14608-g2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Importer::PublicStatusesIndexImporter import! indexes relevant statuses","source_location":"spec/lib/importer/public_statuses_index_importer_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"lib/importer","type":"package","children":[{"name":"Importer","type":"class","children":[{"name":"PublicStatusesIndexImporter","type":"class","children":[{"name":"import!","type":"function","location":"app/lib/importer/public_statuses_index_importer.rb:4","static":false}]},{"name":"BaseImporter","type":"class","children":[{"name":"in_work_unit","type":"function","location":"app/lib/importer/base_importer.rb:81","static":false},{"name":"wait!","type":"function","location":"app/lib/importer/base_importer.rb:93","static":false},{"name":"build_bulk_body","type":"function","location":"app/lib/importer/base_importer.rb:73","static":false}]}]}]},{"name":"models","type":"package","children":[{"name":"concerns","type":"package","children":[{"name":"StatusSearchConcern","type":"class","children":[{"name":"searchable_text","type":"function","location":"app/models/concerns/status_search_concern.rb:26","static":false},{"name":"searchable_properties","type":"function","location":"app/models/concerns/status_search_concern.rb:35","static":false}]}]},{"name":"Status","type":"class","children":[{"name":"local?","type":"function","location":"app/models/status.rb:188","static":false},{"name":"ordered_media_attachments","type":"function","location":"app/models/status.rb:271","static":false},{"name":"with_media?","type":"function","location":"app/models/status.rb:242","static":false},{"name":"with_poll?","type":"function","location":"app/models/status.rb:250","static":false},{"name":"with_preview_card?","type":"function","location":"app/models/status.rb:246","static":false},{"name":"reply?","type":"function","location":"app/models/status.rb:184","static":false}]}]},{"name":"helpers","type":"package","children":[{"name":"FormattingHelper","type":"class","children":[{"name":"extract_status_plain_text","type":"function","location":"app/helpers/formatting_helper.rb:16","static":true}]}]}]},{"name":"ruby","type":"package","children":[{"name":"String","type":"class","children":[{"name":"unpack1","type":"function","location":"<internal:pack>:28","static":false,"labels":["string.unpack"]}]}]}],"events":[{"id":3262795,"event":"call","thread_id":9160,"defined_class":"Importer::PublicStatusesIndexImporter","method_id":"import!","path":"app/lib/importer/public_statuses_index_importer.rb","lineno":4,"static":false,"parameters":[],"receiver":{"class":"Importer::PublicStatusesIndexImporter","object_id":15931780,"value":"#<Importer::PublicStatusesIndexImporter:0x00007fc8e1983968>"}},{"id":3262796,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"statuses\".\"id\" FROM \"statuses\" INNER JOIN \"accounts\" \"account\" ON \"account\".\"id\" = \"statuses\".\"account_id\" WHERE \"statuses\".\"deleted_at\" IS NULL AND \"statuses\".\"reblog_of_id\" IS NULL AND \"statuses\".\"visibility\" = $1 AND \"account\".\"indexable\" = $2 ORDER BY \"statuses\".\"id\" ASC LIMIT $3","database_type":"postgres"}},{"id":3262797,"event":"return","thread_id":9160,"parent_id":3262796,"elapsed":0.001126568,"elapsed_instrumentation":0.00011395401088520885},{"id":3262798,"event":"call","thread_id":9160,"defined_class":"Importer::BaseImporter","method_id":"in_work_unit","path":"app/lib/importer/base_importer.rb","lineno":81,"static":false,"parameters":[{"name":"*","class":"Array","object_id":15931800,"value":"[[111361457001975219]]","kind":"rest","size":1},{"name":"**","class":"Hash","object_id":15931820,"value":"{}","kind":"keyrest","size":0},{"name":"&","class":"NilClass","object_id":4,"value":null,"kind":"block"}],"receiver":{"class":"Importer::PublicStatusesIndexImporter","object_id":15931780,"value":"#<Importer::PublicStatusesIndexImporter:0x00007fc8e1983968>"}},{"id":3262799,"event":"return","thread_id":9160,"parent_id":3262798,"elapsed":0.0005950179765932262,"elapsed_instrumentation":0.00033970701042562723,"return_value":{"class":"Concurrent::Set","value":"#<Concurrent::Set: {#<Concurrent::Promises::Future:0x00007fc8e136ea78 pending>}>","object_id":15931860}},{"id":3262800,"event":"call","thread_id":9160,"defined_class":"Importer::BaseImporter","method_id":"wait!","path":"app/lib/importer/base_importer.rb","lineno":93,"static":false,"parameters":[],"receiver":{"class":"Importer::PublicStatusesIndexImporter","object_id":15931780,"value":"#<Importer::PublicStatusesIndexImporter:0x00007fc8e1983968>"}},{"id":3262801,"event":"call","thread_id":15931880,"defined_class":"Importer::BaseImporter","method_id":"build_bulk_body","path":"app/lib/importer/base_importer.rb","lineno":73,"static":false,"parameters":[{"name":"to_import","class":"ActiveRecord::Relation","object_id":15931900,"value":"#<Status::ActiveRecord_Relation:0x00007fc91a3044c8>","kind":"req"}],"receiver":{"class":"Importer::PublicStatusesIndexImporter","object_id":15931780,"value":"#<Importer::PublicStatusesIndexImporter:0x00007fc8e1983968>"}},{"id":3262802,"event":"call","thread_id":15931880,"sql_query":{"sql":"SELECT \"statuses\".* FROM \"statuses\" INNER JOIN \"accounts\" \"account\" ON \"account\".\"id\" = \"statuses\".\"account_id\" WHERE \"statuses\".\"deleted_at\" IS NULL AND \"statuses\".\"reblog_of_id\" IS NULL AND \"statuses\".\"visibility\" = $1 AND \"account\".\"indexable\" = $2 AND \"statuses\".\"id\" = $3","database_type":"postgres"}},{"id":3262803,"event":"return","thread_id":15931880,"parent_id":3262802,"elapsed":0.001400449,"elapsed_instrumentation":0.0001141539542004466},{"id":3262804,"event":"call","thread_id":15931880,"defined_class":"String","method_id":"unpack1","path":"<internal:pack>","lineno":28,"static":false,"parameters":[{"name":"fmt","class":"String","object_id":319240,"value":"H*","kind":"req"},{"name":"offset","class":"NilClass","object_id":4,"value":null,"kind":"key"}],"receiver":{"class":"String","object_id":15931920,"value":"_\u0011R__n_d(@"}},{"id":3262805,"event":"return","thread_id":15931880,"parent_id":3262804,"elapsed":5.920010153204203e-06,"elapsed_instrumentation":0.0001913940068334341,"return_value":{"class":"String","value":"b711529eaf6eea642840","object_id":15931940}},{"id":3262806,"event":"call","thread_id":15931880,"sql_query":{"sql":"SELECT \"media_attachments\".* FROM \"media_attachments\" WHERE \"media_attachments\".\"status_id\" = $1 ORDER BY \"media_attachments\".\"id\" ASC","database_type":"postgres"}},{"id":3262807,"event":"return","thread_id":15931880,"parent_id":3262806,"elapsed":0.000637981,"elapsed_instrumentation":0.000107427011243999},{"id":3262808,"event":"call","thread_id":15931880,"sql_query":{"sql":"SELECT \"preview_cards_statuses\".* FROM \"preview_cards_statuses\" WHERE \"preview_cards_statuses\".\"status_id\" = $1","database_type":"postgres"}},{"id":3262809,"event":"return","thread_id":15931880,"parent_id":3262808,"elapsed":0.000495528,"elapsed_instrumentation":9.847799083217978e-05},{"id":3262810,"event":"call","thread_id":15931880,"sql_query":{"sql":"SELECT \"statuses_tags\".* FROM \"statuses_tags\" WHERE \"statuses_tags\".\"status_id\" = $1","database_type":"postgres"}},{"id":3262811,"event":"return","thread_id":15931880,"parent_id":3262810,"elapsed":0.000361174,"elapsed_instrumentation":7.63639691285789e-05},{"id":3262812,"event":"call","thread_id":15931880,"defined_class":"StatusSearchConcern","method_id":"searchable_text","path":"app/models/concerns/status_search_concern.rb","lineno":26,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262813,"event":"call","thread_id":15931880,"defined_class":"FormattingHelper","method_id":"extract_status_plain_text","path":"app/helpers/formatting_helper.rb","lineno":16,"static":true,"parameters":[{"name":"status","class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>","kind":"req"}],"receiver":{"class":"Module","object_id":33080,"value":"FormattingHelper"}},{"id":3262814,"event":"call","thread_id":15931880,"defined_class":"Status","method_id":"local?","path":"app/models/status.rb","lineno":188,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262815,"event":"return","thread_id":15931880,"parent_id":3262814,"elapsed":0.00024790799943730235,"elapsed_instrumentation":0.00021198601461946964,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":3262816,"event":"return","thread_id":15931880,"parent_id":3262813,"elapsed":0.0005058450042270124,"elapsed_instrumentation":0.00011891202302649617,"return_value":{"class":"String","value":"Lorem ipsum dolor sit amet","object_id":15931980}},{"id":3262817,"event":"call","thread_id":15931880,"defined_class":"Status","method_id":"ordered_media_attachments","path":"app/models/status.rb","lineno":271,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262818,"event":"return","thread_id":15931880,"parent_id":3262817,"elapsed":0.00021678098710253835,"elapsed_instrumentation":0.00013831700198352337,"return_value":{"class":"ActiveRecord::Associations::CollectionProxy","value":"#<MediaAttachment::ActiveRecord_Associations_CollectionProxy:0x00007fc91a301688>","object_id":15932000}},{"id":3262819,"event":"return","thread_id":15931880,"parent_id":3262812,"elapsed":0.001080540008842945,"elapsed_instrumentation":0.00014240696327760816,"return_value":{"class":"String","value":"\n\nLorem ipsum dolor sit amet\n\n","object_id":15932020}},{"id":3262820,"event":"call","thread_id":15931880,"defined_class":"StatusSearchConcern","method_id":"searchable_properties","path":"app/models/concerns/status_search_concern.rb","lineno":35,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262821,"event":"call","thread_id":15931880,"defined_class":"Status","method_id":"ordered_media_attachments","path":"app/models/status.rb","lineno":271,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262822,"event":"return","thread_id":15931880,"parent_id":3262821,"elapsed":1.9444036297500134e-05,"elapsed_instrumentation":8.39380081743002e-05,"return_value":{"class":"ActiveRecord::Associations::CollectionProxy","value":"#<MediaAttachment::ActiveRecord_Associations_CollectionProxy:0x00007fc91a301688>","object_id":15932000}},{"id":3262823,"event":"call","thread_id":15931880,"defined_class":"Status","method_id":"ordered_media_attachments","path":"app/models/status.rb","lineno":271,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262824,"event":"return","thread_id":15931880,"parent_id":3262823,"elapsed":9.751995094120502e-06,"elapsed_instrumentation":7.804099004715681e-05,"return_value":{"class":"ActiveRecord::Associations::CollectionProxy","value":"#<MediaAttachment::ActiveRecord_Associations_CollectionProxy:0x00007fc91a301688>","object_id":15932000}},{"id":3262825,"event":"call","thread_id":15931880,"defined_class":"Status","method_id":"ordered_media_attachments","path":"app/models/status.rb","lineno":271,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262826,"event":"return","thread_id":15931880,"parent_id":3262825,"elapsed":9.238021448254585e-06,"elapsed_instrumentation":7.340597221627831e-05,"return_value":{"class":"ActiveRecord::Associations::CollectionProxy","value":"#<MediaAttachment::ActiveRecord_Associations_CollectionProxy:0x00007fc91a301688>","object_id":15932000}},{"id":3262827,"event":"call","thread_id":15931880,"defined_class":"Status","method_id":"with_media?","path":"app/models/status.rb","lineno":242,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262828,"event":"call","thread_id":15931880,"defined_class":"Status","method_id":"ordered_media_attachments","path":"app/models/status.rb","lineno":271,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262829,"event":"return","thread_id":15931880,"parent_id":3262828,"elapsed":9.21997707337141e-06,"elapsed_instrumentation":7.063604425638914e-05,"return_value":{"class":"ActiveRecord::Associations::CollectionProxy","value":"#<MediaAttachment::ActiveRecord_Associations_CollectionProxy:0x00007fc91a301688>","object_id":15932000}},{"id":3262830,"event":"return","thread_id":15931880,"parent_id":3262827,"elapsed":0.00010581198148429394,"elapsed_instrumentation":5.313800647854805e-05},{"id":3262831,"event":"call","thread_id":15931880,"defined_class":"Status","method_id":"with_poll?","path":"app/models/status.rb","lineno":250,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262832,"event":"return","thread_id":15931880,"parent_id":3262831,"elapsed":1.786398934200406e-05,"elapsed_instrumentation":5.354598397389054e-05},{"id":3262833,"event":"call","thread_id":15931880,"defined_class":"Status","method_id":"with_preview_card?","path":"app/models/status.rb","lineno":246,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262834,"event":"return","thread_id":15931880,"parent_id":3262833,"elapsed":7.984001422300935e-05,"elapsed_instrumentation":8.279900066554546e-05},{"id":3262835,"event":"call","thread_id":15931880,"defined_class":"Status","method_id":"reply?","path":"app/models/status.rb","lineno":184,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":15931960,"value":"#<Status:0x00007fc8e1a523d0>"}},{"id":3262836,"event":"return","thread_id":15931880,"parent_id":3262835,"elapsed":6.299401866272092e-05,"elapsed_instrumentation":6.3376035541296e-05},{"id":3262837,"event":"return","thread_id":15931880,"parent_id":3262820,"elapsed":0.001109192962758243,"elapsed_instrumentation":0.00011361204087734222,"return_value":{"class":"Array","value":"[]","object_id":15932040,"size":0}},{"id":3262838,"event":"return","thread_id":15931880,"parent_id":3262801,"elapsed":0.017187403980642557,"elapsed_instrumentation":0.0003089190577156842,"return_value":{"class":"Array","value":"[{:index=>{:_id=>111361457001975219, :data=>{id=>111361457001975219, account_id=>111361457001986316, text=>\n\nLorem ipsum dolor sit amet\n\n, tags=>[], language=>, properties=>[], created_at=>2023-11-06T03:23:02.187Z}}}]","object_id":15932060,"size":1}},{"id":3262839,"event":"return","thread_id":9160,"parent_id":3262800,"elapsed":0.019079374033026397,"elapsed_instrumentation":0.00018180598272010684,"return_value":{"class":"Concurrent::Promises::Future","value":"#<Concurrent::Promises::Future:0x00007fc8e136e848 fulfilled with [[1, 0]]>","object_id":15932080}},{"id":3262840,"event":"return","thread_id":9160,"parent_id":3262795,"elapsed":0.027810283994767815,"elapsed_instrumentation":0.0002114049857482314,"return_value":{"class":"Concurrent::Promises::Future","value":"#<Concurrent::Promises::Future:0x00007fc8e136e848 fulfilled with [[1, 0]]>","object_id":15932080}}]}