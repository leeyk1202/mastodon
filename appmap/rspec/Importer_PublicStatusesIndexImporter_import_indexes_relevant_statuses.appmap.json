{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"743782bd299fd54e12a4a5829872efc505132ab3","status":["M .husky/pre-commit","?? sql_warning.txt"],"git_last_annotated_tag":"0.1.2-14597-g743782bd299fd54e12a4a5829872efc505132ab3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Importer::PublicStatusesIndexImporter import! indexes relevant statuses","source_location":"spec/lib/importer/public_statuses_index_importer_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"lib/importer","type":"package","children":[{"name":"Importer","type":"class","children":[{"name":"PublicStatusesIndexImporter","type":"class","children":[{"name":"import!","type":"function","location":"app/lib/importer/public_statuses_index_importer.rb:4","static":false}]},{"name":"BaseImporter","type":"class","children":[{"name":"in_work_unit","type":"function","location":"app/lib/importer/base_importer.rb:81","static":false},{"name":"wait!","type":"function","location":"app/lib/importer/base_importer.rb:93","static":false},{"name":"build_bulk_body","type":"function","location":"app/lib/importer/base_importer.rb:73","static":false}]}]}]},{"name":"models","type":"package","children":[{"name":"concerns","type":"package","children":[{"name":"StatusSearchConcern","type":"class","children":[{"name":"searchable_text","type":"function","location":"app/models/concerns/status_search_concern.rb:26","static":false},{"name":"searchable_properties","type":"function","location":"app/models/concerns/status_search_concern.rb:35","static":false}]}]},{"name":"Status","type":"class","children":[{"name":"local?","type":"function","location":"app/models/status.rb:188","static":false},{"name":"ordered_media_attachments","type":"function","location":"app/models/status.rb:271","static":false},{"name":"with_media?","type":"function","location":"app/models/status.rb:242","static":false},{"name":"with_poll?","type":"function","location":"app/models/status.rb:250","static":false},{"name":"with_preview_card?","type":"function","location":"app/models/status.rb:246","static":false},{"name":"reply?","type":"function","location":"app/models/status.rb:184","static":false}]}]},{"name":"helpers","type":"package","children":[{"name":"FormattingHelper","type":"class","children":[{"name":"extract_status_plain_text","type":"function","location":"app/helpers/formatting_helper.rb:16","static":true}]}]}]},{"name":"ruby","type":"package","children":[{"name":"String","type":"class","children":[{"name":"unpack1","type":"function","location":"<internal:pack>:28","static":false,"labels":["string.unpack"]}]}]}],"events":[{"id":149421,"event":"call","thread_id":9160,"defined_class":"Importer::PublicStatusesIndexImporter","method_id":"import!","path":"app/lib/importer/public_statuses_index_importer.rb","lineno":4,"static":false,"parameters":[],"receiver":{"class":"Importer::PublicStatusesIndexImporter","object_id":1267020,"value":"#<Importer::PublicStatusesIndexImporter:0x00007fdc089b9c40>"}},{"id":149422,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"statuses\".\"id\" FROM \"statuses\" INNER JOIN \"accounts\" \"account\" ON \"account\".\"id\" = \"statuses\".\"account_id\" WHERE \"statuses\".\"deleted_at\" IS NULL AND \"statuses\".\"reblog_of_id\" IS NULL AND \"statuses\".\"visibility\" = $1 AND \"account\".\"indexable\" = $2 ORDER BY \"statuses\".\"id\" ASC LIMIT $3","database_type":"postgres"}},{"id":149423,"event":"return","thread_id":9160,"parent_id":149422,"elapsed":0.002028795,"elapsed_instrumentation":0.00012950898963026702},{"id":149424,"event":"call","thread_id":9160,"defined_class":"Importer::BaseImporter","method_id":"in_work_unit","path":"app/lib/importer/base_importer.rb","lineno":81,"static":false,"parameters":[{"name":"*","class":"Array","object_id":1267040,"value":"[[111360436665294789]]","kind":"rest","size":1},{"name":"**","class":"Hash","object_id":1267060,"value":"{}","kind":"keyrest","size":0},{"name":"&","class":"NilClass","object_id":4,"value":null,"kind":"block"}],"receiver":{"class":"Importer::PublicStatusesIndexImporter","object_id":1267020,"value":"#<Importer::PublicStatusesIndexImporter:0x00007fdc089b9c40>"}},{"id":149425,"event":"return","thread_id":9160,"parent_id":149424,"elapsed":0.0008064459834713489,"elapsed_instrumentation":0.00039849302265793085,"return_value":{"class":"Concurrent::Set","value":"#<Concurrent::Set: {#<Concurrent::Promises::Future:0x00007fdc096078a8 pending>}>","object_id":1267100}},{"id":149426,"event":"call","thread_id":9160,"defined_class":"Importer::BaseImporter","method_id":"wait!","path":"app/lib/importer/base_importer.rb","lineno":93,"static":false,"parameters":[],"receiver":{"class":"Importer::PublicStatusesIndexImporter","object_id":1267020,"value":"#<Importer::PublicStatusesIndexImporter:0x00007fdc089b9c40>"}},{"id":149427,"event":"call","thread_id":1267120,"defined_class":"Importer::BaseImporter","method_id":"build_bulk_body","path":"app/lib/importer/base_importer.rb","lineno":73,"static":false,"parameters":[{"name":"to_import","class":"ActiveRecord::Relation","object_id":1267140,"value":"#<Status::ActiveRecord_Relation:0x00007fdc07c4f960>","kind":"req"}],"receiver":{"class":"Importer::PublicStatusesIndexImporter","object_id":1267020,"value":"#<Importer::PublicStatusesIndexImporter:0x00007fdc089b9c40>"}},{"id":149428,"event":"call","thread_id":1267120,"sql_query":{"sql":"SELECT \"statuses\".* FROM \"statuses\" INNER JOIN \"accounts\" \"account\" ON \"account\".\"id\" = \"statuses\".\"account_id\" WHERE \"statuses\".\"deleted_at\" IS NULL AND \"statuses\".\"reblog_of_id\" IS NULL AND \"statuses\".\"visibility\" = $1 AND \"account\".\"indexable\" = $2 AND \"statuses\".\"id\" = $3","database_type":"postgres"}},{"id":149429,"event":"return","thread_id":1267120,"parent_id":149428,"elapsed":0.001634114,"elapsed_instrumentation":0.0002721099881455302},{"id":149430,"event":"call","thread_id":1267120,"defined_class":"String","method_id":"unpack1","path":"<internal:pack>","lineno":28,"static":false,"parameters":[{"name":"fmt","class":"String","object_id":210800,"value":"H*","kind":"req"},{"name":"offset","class":"NilClass","object_id":4,"value":null,"kind":"key"}],"receiver":{"class":"String","object_id":1267160,"value":"_K\u0013\u0003_r_9__"}},{"id":149431,"event":"return","thread_id":1267120,"parent_id":149430,"elapsed":6.229005521163344e-06,"elapsed_instrumentation":0.00020908599253743887,"return_value":{"class":"String","value":"8d4b1303c772cb39ada6","object_id":1267180}},{"id":149432,"event":"call","thread_id":1267120,"sql_query":{"sql":"SELECT \"media_attachments\".* FROM \"media_attachments\" WHERE \"media_attachments\".\"status_id\" = $1 ORDER BY \"media_attachments\".\"id\" ASC","database_type":"postgres"}},{"id":149433,"event":"return","thread_id":1267120,"parent_id":149432,"elapsed":0.000929167,"elapsed_instrumentation":0.00017063599079847336},{"id":149434,"event":"call","thread_id":1267120,"sql_query":{"sql":"SELECT \"preview_cards_statuses\".* FROM \"preview_cards_statuses\" WHERE \"preview_cards_statuses\".\"status_id\" = $1","database_type":"postgres"}},{"id":149435,"event":"return","thread_id":1267120,"parent_id":149434,"elapsed":0.000855139,"elapsed_instrumentation":0.0001096649793908},{"id":149436,"event":"call","thread_id":1267120,"sql_query":{"sql":"SELECT \"statuses_tags\".* FROM \"statuses_tags\" WHERE \"statuses_tags\".\"status_id\" = $1","database_type":"postgres"}},{"id":149437,"event":"return","thread_id":1267120,"parent_id":149436,"elapsed":0.000879135,"elapsed_instrumentation":0.00011271500261500478},{"id":149438,"event":"call","thread_id":1267120,"defined_class":"StatusSearchConcern","method_id":"searchable_text","path":"app/models/concerns/status_search_concern.rb","lineno":26,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149439,"event":"call","thread_id":1267120,"defined_class":"FormattingHelper","method_id":"extract_status_plain_text","path":"app/helpers/formatting_helper.rb","lineno":16,"static":true,"parameters":[{"name":"status","class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>","kind":"req"}],"receiver":{"class":"Module","object_id":33080,"value":"FormattingHelper"}},{"id":149440,"event":"call","thread_id":1267120,"defined_class":"Status","method_id":"local?","path":"app/models/status.rb","lineno":188,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149441,"event":"return","thread_id":1267120,"parent_id":149440,"elapsed":0.00045845398562960327,"elapsed_instrumentation":0.00013796502025797963,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":149442,"event":"return","thread_id":1267120,"parent_id":149439,"elapsed":0.0006910839874763042,"elapsed_instrumentation":0.001151443982962519,"return_value":{"class":"String","value":"Lorem ipsum dolor sit amet","object_id":1267220}},{"id":149443,"event":"call","thread_id":1267120,"defined_class":"Status","method_id":"ordered_media_attachments","path":"app/models/status.rb","lineno":271,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149444,"event":"return","thread_id":1267120,"parent_id":149443,"elapsed":0.0003326639998704195,"elapsed_instrumentation":0.0004793239932041615,"return_value":{"class":"ActiveRecord::Associations::CollectionProxy","value":"#<MediaAttachment::ActiveRecord_Associations_CollectionProxy:0x00007fdc07c4c800>","object_id":1267240}},{"id":149445,"event":"return","thread_id":1267120,"parent_id":149438,"elapsed":0.0032445430115330964,"elapsed_instrumentation":0.001910605962621048,"return_value":{"class":"String","value":"\n\nLorem ipsum dolor sit amet\n\n","object_id":1267260}},{"id":149446,"event":"call","thread_id":1267120,"defined_class":"StatusSearchConcern","method_id":"searchable_properties","path":"app/models/concerns/status_search_concern.rb","lineno":35,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149447,"event":"call","thread_id":1267120,"defined_class":"Status","method_id":"ordered_media_attachments","path":"app/models/status.rb","lineno":271,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149448,"event":"return","thread_id":1267120,"parent_id":149447,"elapsed":2.2805004846304655e-05,"elapsed_instrumentation":0.00027987200883217156,"return_value":{"class":"ActiveRecord::Associations::CollectionProxy","value":"#<MediaAttachment::ActiveRecord_Associations_CollectionProxy:0x00007fdc07c4c800>","object_id":1267240}},{"id":149449,"event":"call","thread_id":1267120,"defined_class":"Status","method_id":"ordered_media_attachments","path":"app/models/status.rb","lineno":271,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149450,"event":"return","thread_id":1267120,"parent_id":149449,"elapsed":2.1068000933155417e-05,"elapsed_instrumentation":0.00022047999664209783,"return_value":{"class":"ActiveRecord::Associations::CollectionProxy","value":"#<MediaAttachment::ActiveRecord_Associations_CollectionProxy:0x00007fdc07c4c800>","object_id":1267240}},{"id":149451,"event":"call","thread_id":1267120,"defined_class":"Status","method_id":"ordered_media_attachments","path":"app/models/status.rb","lineno":271,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149452,"event":"return","thread_id":1267120,"parent_id":149451,"elapsed":2.4078006390482187e-05,"elapsed_instrumentation":0.00025214400375261903,"return_value":{"class":"ActiveRecord::Associations::CollectionProxy","value":"#<MediaAttachment::ActiveRecord_Associations_CollectionProxy:0x00007fdc07c4c800>","object_id":1267240}},{"id":149453,"event":"call","thread_id":1267120,"defined_class":"Status","method_id":"with_media?","path":"app/models/status.rb","lineno":242,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149454,"event":"call","thread_id":1267120,"defined_class":"Status","method_id":"ordered_media_attachments","path":"app/models/status.rb","lineno":271,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149455,"event":"return","thread_id":1267120,"parent_id":149454,"elapsed":0.00014942101552151144,"elapsed_instrumentation":0.00022615198395214975,"return_value":{"class":"ActiveRecord::Associations::CollectionProxy","value":"#<MediaAttachment::ActiveRecord_Associations_CollectionProxy:0x00007fdc07c4c800>","object_id":1267240}},{"id":149456,"event":"return","thread_id":1267120,"parent_id":149453,"elapsed":0.0005516199744306505,"elapsed_instrumentation":0.0001786400389391929},{"id":149457,"event":"call","thread_id":1267120,"defined_class":"Status","method_id":"with_poll?","path":"app/models/status.rb","lineno":250,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149458,"event":"return","thread_id":1267120,"parent_id":149457,"elapsed":3.5828998079523444e-05,"elapsed_instrumentation":0.00019684899598360062},{"id":149459,"event":"call","thread_id":1267120,"defined_class":"Status","method_id":"with_preview_card?","path":"app/models/status.rb","lineno":246,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149460,"event":"return","thread_id":1267120,"parent_id":149459,"elapsed":0.00024045200552791357,"elapsed_instrumentation":0.0006401370046660304},{"id":149461,"event":"call","thread_id":1267120,"defined_class":"Status","method_id":"reply?","path":"app/models/status.rb","lineno":184,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":1267200,"value":"#<Status:0x00007fdc0894b3f8>"}},{"id":149462,"event":"return","thread_id":1267120,"parent_id":149461,"elapsed":0.0003510400129016489,"elapsed_instrumentation":0.0004701459838543087},{"id":149463,"event":"return","thread_id":1267120,"parent_id":149446,"elapsed":0.003946657001506537,"elapsed_instrumentation":0.00028021601610817015,"return_value":{"class":"Array","value":"[]","object_id":1267280,"size":0}},{"id":149464,"event":"return","thread_id":1267120,"parent_id":149427,"elapsed":0.03590125899063423,"elapsed_instrumentation":0.0004844040086027235,"return_value":{"class":"Array","value":"[{:index=>{:_id=>111360436665294789, :data=>{id=>111360436665294789, account_id=>111360436665272782, text=>\n\nLorem ipsum dolor sit amet\n\n, tags=>[], language=>, properties=>[], created_at=>2023-11-05T23:03:33.118Z}}}]","object_id":1267300,"size":1}},{"id":149465,"event":"return","thread_id":9160,"parent_id":149426,"elapsed":0.040086010994855314,"elapsed_instrumentation":0.00028477696469053626,"return_value":{"class":"Concurrent::Promises::Future","value":"#<Concurrent::Promises::Future:0x00007fdc096075d8 fulfilled with [[1, 0]]>","object_id":1267340}},{"id":149466,"event":"return","thread_id":9160,"parent_id":149421,"elapsed":0.052012300002388656,"elapsed_instrumentation":0.00038283501635305583,"return_value":{"class":"Concurrent::Promises::Future","value":"#<Concurrent::Promises::Future:0x00007fdc096075d8 fulfilled with [[1, 0]]>","object_id":1267340}}]}