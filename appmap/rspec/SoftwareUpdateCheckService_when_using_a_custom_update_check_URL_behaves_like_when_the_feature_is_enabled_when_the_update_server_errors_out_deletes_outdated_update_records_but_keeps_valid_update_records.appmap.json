{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"743782bd299fd54e12a4a5829872efc505132ab3","status":["M .husky/pre-commit","?? sql_warning.txt"],"git_last_annotated_tag":"0.1.2-14597-g743782bd299fd54e12a4a5829872efc505132ab3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"SoftwareUpdateCheckService when using a custom update check URL behaves like when the feature is enabled when the update server errors out deletes outdated update records but keeps valid update records","source_location":"spec/services/software_update_check_service_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"lib/mastodon","type":"package","children":[{"name":"Mastodon","type":"class","children":[{"name":"Version","type":"class","children":[{"name":"gem_version","type":"function","location":"lib/mastodon/version.rb:42","static":true},{"name":"to_a","type":"function","location":"lib/mastodon/version.rb:31","static":true},{"name":"major","type":"function","location":"lib/mastodon/version.rb:7","static":true},{"name":"minor","type":"function","location":"lib/mastodon/version.rb:11","static":true},{"name":"patch","type":"function","location":"lib/mastodon/version.rb:15","static":true},{"name":"prerelease","type":"function","location":"lib/mastodon/version.rb:23","static":true},{"name":"default_prerelease","type":"function","location":"lib/mastodon/version.rb:19","static":true},{"name":"build_metadata","type":"function","location":"lib/mastodon/version.rb:27","static":true},{"name":"user_agent","type":"function","location":"lib/mastodon/version.rb:67","static":true}]}]}]},{"name":"app","type":"package","children":[{"name":"models","type":"package","children":[{"name":"SoftwareUpdate","type":"class","children":[{"name":"gem_version","type":"function","location":"app/models/software_update.rb:21","static":false},{"name":"check_enabled?","type":"function","location":"app/models/software_update.rb:26","static":true}]}]},{"name":"lib","type":"package","children":[{"name":"Request","type":"class","children":[{"name":"add_headers","type":"function","location":"app/lib/request.rb:100","static":false},{"name":"perform","type":"function","location":"app/lib/request.rb:105","static":false},{"name":"http_client","type":"function","location":"app/lib/request.rb:141","static":true},{"name":"headers","type":"function","location":"app/lib/request.rb:126","static":false}]}]}]}],"events":[{"id":1102220,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"software_updates\".\"version\" FROM \"software_updates\"","database_type":"postgres"}},{"id":1102221,"event":"return","thread_id":9160,"parent_id":1102220,"elapsed":0.001364288,"elapsed_instrumentation":0.0003275579947512597},{"id":1102222,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"software_updates\".* FROM \"software_updates\" ORDER BY \"software_updates\".\"id\" ASC LIMIT $1","database_type":"postgres"}},{"id":1102223,"event":"return","thread_id":9160,"parent_id":1102222,"elapsed":0.001191874,"elapsed_instrumentation":0.0005432390025816858},{"id":1102224,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"gem_version","path":"lib/mastodon/version.rb","lineno":42,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102225,"event":"return","thread_id":9160,"parent_id":1102224,"elapsed":6.4490013755857944e-06,"elapsed_instrumentation":0.00045989101636223495,"return_value":{"class":"Gem::Version","value":"4.3.0.pre.alpha.0","object_id":6159580}},{"id":1102226,"event":"call","thread_id":9160,"defined_class":"SoftwareUpdate","method_id":"gem_version","path":"app/models/software_update.rb","lineno":21,"static":false,"parameters":[],"receiver":{"class":"SoftwareUpdate","object_id":6159900,"value":"#<SoftwareUpdate:0x00007fdc062feec0>"}},{"id":1102227,"event":"return","thread_id":9160,"parent_id":1102226,"elapsed":3.544599167071283e-05,"elapsed_instrumentation":0.0001864299993030727,"return_value":{"class":"Gem::Version","value":"3.5.0","object_id":6159620}},{"id":1102228,"event":"call","thread_id":9160,"sql_query":{"sql":"DELETE FROM \"software_updates\" WHERE \"software_updates\".\"id\" = $1","database_type":"postgres"}},{"id":1102229,"event":"return","thread_id":9160,"parent_id":1102228,"elapsed":0.00094061,"elapsed_instrumentation":0.00014080700930207968},{"id":1102230,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"gem_version","path":"lib/mastodon/version.rb","lineno":42,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102231,"event":"return","thread_id":9160,"parent_id":1102230,"elapsed":0.00023923799744807184,"elapsed_instrumentation":0.000587830989388749,"return_value":{"class":"Gem::Version","value":"4.3.0.pre.alpha.0","object_id":6159580}},{"id":1102232,"event":"call","thread_id":9160,"defined_class":"SoftwareUpdate","method_id":"gem_version","path":"app/models/software_update.rb","lineno":21,"static":false,"parameters":[],"receiver":{"class":"SoftwareUpdate","object_id":6159920,"value":"#<SoftwareUpdate:0x00007fdc062fec40>"}},{"id":1102233,"event":"return","thread_id":9160,"parent_id":1102232,"elapsed":6.948199006728828e-05,"elapsed_instrumentation":0.0003069089725613594,"return_value":{"class":"Gem::Version","value":"42.13.12","object_id":6159940}},{"id":1102234,"event":"call","thread_id":9160,"defined_class":"SoftwareUpdate","method_id":"check_enabled?","path":"app/models/software_update.rb","lineno":26,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":61780,"value":"SoftwareUpdate"}},{"id":1102235,"event":"return","thread_id":9160,"parent_id":1102234,"elapsed":1.3109005521982908e-05,"elapsed_instrumentation":0.0002315509773325175,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1102236,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"to_a","path":"lib/mastodon/version.rb","lineno":31,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102237,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"major","path":"lib/mastodon/version.rb","lineno":7,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102238,"event":"return","thread_id":9160,"parent_id":1102237,"elapsed":2.235989086329937e-06,"elapsed_instrumentation":0.00018820399418473244,"return_value":{"class":"Integer","value":"4","object_id":9}},{"id":1102239,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"minor","path":"lib/mastodon/version.rb","lineno":11,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102240,"event":"return","thread_id":9160,"parent_id":1102239,"elapsed":4.489003913477063e-06,"elapsed_instrumentation":0.00021909299539402127,"return_value":{"class":"Integer","value":"3","object_id":7}},{"id":1102241,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"patch","path":"lib/mastodon/version.rb","lineno":15,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102242,"event":"return","thread_id":9160,"parent_id":1102241,"elapsed":4.5869965106248856e-06,"elapsed_instrumentation":0.0004862910136580467,"return_value":{"class":"Integer","value":"0","object_id":1}},{"id":1102243,"event":"return","thread_id":9160,"parent_id":1102236,"elapsed":0.0009780169930309057,"elapsed_instrumentation":0.00026066703139804304,"return_value":{"class":"Array","value":"[4, 3, 0]","object_id":6159960,"size":3}},{"id":1102244,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"prerelease","path":"lib/mastodon/version.rb","lineno":23,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102245,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"default_prerelease","path":"lib/mastodon/version.rb","lineno":19,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102246,"event":"return","thread_id":9160,"parent_id":1102245,"elapsed":2.4310138542205095e-06,"elapsed_instrumentation":0.00018964597256854177,"return_value":{"class":"String","value":"alpha.0","object_id":762740}},{"id":1102247,"event":"return","thread_id":9160,"parent_id":1102244,"elapsed":0.0002118620031978935,"elapsed_instrumentation":0.00016294600209221244,"return_value":{"class":"String","value":"alpha.0","object_id":762740}},{"id":1102248,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"prerelease","path":"lib/mastodon/version.rb","lineno":23,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102249,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"default_prerelease","path":"lib/mastodon/version.rb","lineno":19,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102250,"event":"return","thread_id":9160,"parent_id":1102249,"elapsed":2.3719912860542536e-06,"elapsed_instrumentation":0.0001404810172971338,"return_value":{"class":"String","value":"alpha.0","object_id":762740}},{"id":1102251,"event":"return","thread_id":9160,"parent_id":1102248,"elapsed":0.00016316899564117193,"elapsed_instrumentation":0.0006507729995064437,"return_value":{"class":"String","value":"alpha.0","object_id":762740}},{"id":1102252,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"build_metadata","path":"lib/mastodon/version.rb","lineno":27,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102253,"event":"return","thread_id":9160,"parent_id":1102252,"elapsed":5.249981768429279e-06,"elapsed_instrumentation":0.00016478699399158359},{"id":1102254,"event":"call","thread_id":9160,"defined_class":"Mastodon::Version","method_id":"user_agent","path":"lib/mastodon/version.rb","lineno":67,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":762660,"value":"4.3.0-alpha.0"}},{"id":1102255,"event":"return","thread_id":9160,"parent_id":1102254,"elapsed":7.14600901119411e-06,"elapsed_instrumentation":0.0006623050139751285,"return_value":{"class":"String","value":"http.rb/5.1.1 (Mastodon/4.3.0-alpha.0; +https://cb6e6126.ngrok.io/)","object_id":2322760}},{"id":1102256,"event":"call","thread_id":9160,"defined_class":"Request","method_id":"add_headers","path":"app/lib/request.rb","lineno":100,"static":false,"parameters":[{"name":"new_headers","class":"Hash","object_id":6159980,"value":"{Accept=>application/json, User-Agent=>Mastodon update checker}","kind":"req","size":2}],"receiver":{"class":"Request","object_id":6160000,"value":"#<Request:0x00007fdc07447e48>"}},{"id":1102257,"event":"return","thread_id":9160,"parent_id":1102256,"elapsed":9.707990102469921e-06,"elapsed_instrumentation":0.0002945460146293044,"return_value":{"class":"Request","value":"#<Request:0x00007fdc07447e48>","object_id":6160000}},{"id":1102258,"event":"call","thread_id":9160,"defined_class":"Request","method_id":"perform","path":"app/lib/request.rb","lineno":105,"static":false,"parameters":[],"receiver":{"class":"Request","object_id":6160000,"value":"#<Request:0x00007fdc07447e48>"}},{"id":1102259,"event":"call","thread_id":9160,"defined_class":"Request","method_id":"http_client","path":"app/lib/request.rb","lineno":141,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":55840,"value":"Request"}},{"id":1102260,"event":"return","thread_id":9160,"parent_id":1102259,"elapsed":0.00010731801739893854,"elapsed_instrumentation":0.0001303959870710969,"return_value":{"class":"HTTP::Client","value":"#<HTTP::Client:0x00007fdc0948a548>","object_id":6160020}},{"id":1102261,"event":"call","thread_id":9160,"defined_class":"Request","method_id":"headers","path":"app/lib/request.rb","lineno":126,"static":false,"parameters":[],"receiver":{"class":"Request","object_id":6160000,"value":"#<Request:0x00007fdc07447e48>"}},{"id":1102262,"event":"return","thread_id":9160,"parent_id":1102261,"elapsed":1.4313001884147525e-05,"elapsed_instrumentation":0.00018639600602909923,"return_value":{"class":"Hash","value":"{User-Agent=>Mastodon update checker, Host=>api.example.com, Date=>Sun, 05 Nov 2023 23:19:29 GMT, Accept-Encoding=>gzip, Accept=>application/json}","object_id":6160040,"size":5}},{"id":1102263,"event":"return","thread_id":9160,"parent_id":1102258,"elapsed":0.005051585001638159,"elapsed_instrumentation":0.0004717799893114716},{"id":1102264,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"software_updates\".\"version\" FROM \"software_updates\"","database_type":"postgres"}},{"id":1102265,"event":"return","thread_id":9160,"parent_id":1102264,"elapsed":0.001018192,"elapsed_instrumentation":0.00012703801621682942}]}