{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","status":["M .husky/pre-commit"],"git_last_annotated_tag":"0.1.2-14608-g2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Admin::Metrics::Dimension::SpaceUsageDimension #data runs data query without error","source_location":"spec/lib/admin/metrics/dimension/space_usage_dimension_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"lib/admin/metrics/dimension","type":"package","children":[{"name":"Admin","type":"class","children":[{"name":"Metrics","type":"class","children":[{"name":"Dimension","type":"class","children":[{"name":"BaseDimension","type":"class","children":[{"name":"data","type":"function","location":"app/lib/admin/metrics/dimension/base_dimension.rb:30","static":false},{"name":"load","type":"function","location":"app/lib/admin/metrics/dimension/base_dimension.rb:44","static":false},{"name":"cache_key","type":"function","location":"app/lib/admin/metrics/dimension/base_dimension.rb:26","static":false},{"name":"canonicalized_params","type":"function","location":"app/lib/admin/metrics/dimension/base_dimension.rb:65","static":false},{"name":"params","type":"function","location":"app/lib/admin/metrics/dimension/base_dimension.rb:61","static":false}]},{"name":"SpaceUsageDimension","type":"class","children":[{"name":"key","type":"function","location":"app/lib/admin/metrics/dimension/space_usage_dimension.rb:7","static":false},{"name":"perform_query","type":"function","location":"app/lib/admin/metrics/dimension/space_usage_dimension.rb:13","static":false},{"name":"postgresql_size","type":"function","location":"app/lib/admin/metrics/dimension/space_usage_dimension.rb:17","static":false},{"name":"redis_size","type":"function","location":"app/lib/admin/metrics/dimension/space_usage_dimension.rb:29","static":false},{"name":"redis_info","type":"function","location":"app/lib/admin/metrics/dimension/space_usage_dimension.rb:61","static":false},{"name":"media_size","type":"function","location":"app/lib/admin/metrics/dimension/space_usage_dimension.rb:41","static":false},{"name":"search_size","type":"function","location":"app/lib/admin/metrics/dimension/space_usage_dimension.rb:69","static":false}]}]}]}]}]},{"name":"models/concerns","type":"package","children":[{"name":"Redisable","type":"class","children":[{"name":"redis","type":"function","location":"app/models/concerns/redisable.rb:4","static":false}]}]}]},{"name":"logger","type":"package","children":[{"name":"Logger","type":"class","children":[{"name":"LogDevice","type":"class","children":[{"name":"write","type":"function","location":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb:31","static":false,"labels":["log"]}]}]}]},{"name":"lib/chewy","type":"package","children":[{"name":"Chewy","type":"class","children":[{"name":"SettingsExtensions","type":"class","children":[{"name":"enabled?","type":"function","location":"lib/chewy/settings_extensions.rb:5","static":true}]}]}]},{"name":"ruby","type":"package","children":[{"name":"Marshal","type":"class","children":[{"name":"dump","type":"function","location":"Marshal.dump","static":true,"labels":["serialize"]}]}]}],"events":[{"id":1476390,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::BaseDimension","method_id":"data","path":"app/lib/admin/metrics/dimension/base_dimension.rb","lineno":30,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476391,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::BaseDimension","method_id":"load","path":"app/lib/admin/metrics/dimension/base_dimension.rb","lineno":44,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476392,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::BaseDimension","method_id":"cache_key","path":"app/lib/admin/metrics/dimension/base_dimension.rb","lineno":26,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476393,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::SpaceUsageDimension","method_id":"key","path":"app/lib/admin/metrics/dimension/space_usage_dimension.rb","lineno":7,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476394,"event":"return","thread_id":9160,"parent_id":1476393,"elapsed":2.8730137273669243e-06,"elapsed_instrumentation":9.860203135758638e-05,"return_value":{"class":"String","value":"space_usage","object_id":8338280}},{"id":1476395,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::BaseDimension","method_id":"canonicalized_params","path":"app/lib/admin/metrics/dimension/base_dimension.rb","lineno":65,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476396,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::BaseDimension","method_id":"params","path":"app/lib/admin/metrics/dimension/base_dimension.rb","lineno":61,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476397,"event":"return","thread_id":9160,"parent_id":1476396,"elapsed":1.9189901649951935e-06,"elapsed_instrumentation":6.074697012081742e-05,"return_value":{"class":"Hash","value":"{}","object_id":8338300,"size":0}},{"id":1476398,"event":"return","thread_id":9160,"parent_id":1476395,"elapsed":8.152896771207452e-05,"elapsed_instrumentation":7.405504584312439e-05,"return_value":{"class":"String","value":"","object_id":8338320}},{"id":1476399,"event":"return","thread_id":9160,"parent_id":1476392,"elapsed":0.00034676602808758616,"elapsed_instrumentation":4.864600487053394e-05,"return_value":{"class":"String","value":"metrics/dimension/space_usage;2023-11-04T03:05:14+00:00;2023-11-06T03:05:14+00:00;10;","object_id":8338340}},{"id":1476400,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":8338360,"value":"Cache read: metrics/dimension/space_usage;2023-11-04T03:05:14+00:00;2023-11-06T03:05:14+00:00;10; ({ (...70 more characters)","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":1476401,"event":"return","thread_id":9160,"parent_id":1476400,"elapsed":0.0005394879844971001,"elapsed_instrumentation":0.0002186570200137794,"return_value":{"class":"Integer","value":"170","object_id":341}},{"id":1476402,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":8338380,"value":"Cache generate: metrics/dimension/space_usage;2023-11-04T03:05:14+00:00;2023-11-06T03:05:14+00:00;10 (...74 more characters)","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":1476403,"event":"return","thread_id":9160,"parent_id":1476402,"elapsed":0.0005554980016313493,"elapsed_instrumentation":0.00013685697922483087,"return_value":{"class":"Integer","value":"174","object_id":349}},{"id":1476404,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::SpaceUsageDimension","method_id":"perform_query","path":"app/lib/admin/metrics/dimension/space_usage_dimension.rb","lineno":13,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476405,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::SpaceUsageDimension","method_id":"postgresql_size","path":"app/lib/admin/metrics/dimension/space_usage_dimension.rb","lineno":17,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476406,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT pg_database_size(current_database())","database_type":"postgres"}},{"id":1476407,"event":"return","thread_id":9160,"parent_id":1476406,"elapsed":0.004221279,"elapsed_instrumentation":0.00013269501505419612},{"id":1476408,"event":"return","thread_id":9160,"parent_id":1476405,"elapsed":0.005506940011400729,"elapsed_instrumentation":0.0001989810261875391,"return_value":{"class":"Hash","value":"{:key=>postgresql, :human_key=>PostgreSQL, :value=>24732163, :unit=>bytes, :human_value=>23.6 MB}","object_id":8338400,"size":5}},{"id":1476409,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::SpaceUsageDimension","method_id":"redis_size","path":"app/lib/admin/metrics/dimension/space_usage_dimension.rb","lineno":29,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476410,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::SpaceUsageDimension","method_id":"redis_info","path":"app/lib/admin/metrics/dimension/space_usage_dimension.rb","lineno":61,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476411,"event":"call","thread_id":9160,"defined_class":"Redisable","method_id":"redis","path":"app/models/concerns/redisable.rb","lineno":4,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476412,"event":"return","thread_id":9160,"parent_id":1476411,"elapsed":4.692003130912781e-06,"elapsed_instrumentation":7.013499271124601e-05,"return_value":{"class":"Redis::Namespace","value":"#<Redis::Namespace:0x00007fc934c37e90>","object_id":319760}},{"id":1476413,"event":"call","thread_id":9160,"defined_class":"Redisable","method_id":"redis","path":"app/models/concerns/redisable.rb","lineno":4,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476414,"event":"return","thread_id":9160,"parent_id":1476413,"elapsed":2.6730122044682503e-06,"elapsed_instrumentation":6.470002699643373e-05,"return_value":{"class":"Redis::Namespace","value":"#<Redis::Namespace:0x00007fc934c37e90>","object_id":319760}},{"id":1476415,"event":"return","thread_id":9160,"parent_id":1476410,"elapsed":0.0012318309745751321,"elapsed_instrumentation":0.00022038602037355304,"return_value":{"class":"Hash","value":"{redis_version=>7.2.1, redis_git_sha1=>00000000, redis_git_dirty=>0, redis_build_id=>c9115c2d66ad7281, redis_mode=>standalone, os=>Linux 6.4.16-linuxkit x86_64, arch_bits=>64, monotonic_clock=>POSIX clock_gettime, multiplexing_api=>epoll, atomicvar_api=>c11-builtin (...184 more entries)}","object_id":8338420,"size":194}},{"id":1476416,"event":"return","thread_id":9160,"parent_id":1476409,"elapsed":0.002128361025825143,"elapsed_instrumentation":0.00028721493436023593,"return_value":{"class":"Hash","value":"{:key=>redis, :human_key=>Redis, :value=>2450408, :unit=>bytes, :human_value=>2.34 MB}","object_id":8338440,"size":5}},{"id":1476417,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::SpaceUsageDimension","method_id":"media_size","path":"app/lib/admin/metrics/dimension/space_usage_dimension.rb","lineno":41,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476418,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT SUM(COALESCE(file_file_size, 0) + COALESCE(thumbnail_file_size, 0)) FROM \"media_attachments\"","database_type":"postgres"}},{"id":1476419,"event":"return","thread_id":9160,"parent_id":1476418,"elapsed":0.000558006,"elapsed_instrumentation":8.645601337775588e-05},{"id":1476420,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT SUM(\"custom_emojis\".\"image_file_size\") FROM \"custom_emojis\"","database_type":"postgres"}},{"id":1476421,"event":"return","thread_id":9160,"parent_id":1476420,"elapsed":0.000587003,"elapsed_instrumentation":7.594202179461718e-05},{"id":1476422,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT SUM(\"preview_cards\".\"image_file_size\") FROM \"preview_cards\"","database_type":"postgres"}},{"id":1476423,"event":"return","thread_id":9160,"parent_id":1476422,"elapsed":0.000573059,"elapsed_instrumentation":6.781797856092453e-05},{"id":1476424,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT SUM(COALESCE(avatar_file_size, 0) + COALESCE(header_file_size, 0)) FROM \"accounts\"","database_type":"postgres"}},{"id":1476425,"event":"return","thread_id":9160,"parent_id":1476424,"elapsed":0.000701183,"elapsed_instrumentation":6.668397691100836e-05},{"id":1476426,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT SUM(\"backups\".\"dump_file_size\") FROM \"backups\"","database_type":"postgres"}},{"id":1476427,"event":"return","thread_id":9160,"parent_id":1476426,"elapsed":0.000526733,"elapsed_instrumentation":8.003105176612735e-05},{"id":1476428,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT SUM(\"imports\".\"data_file_size\") FROM \"imports\"","database_type":"postgres"}},{"id":1476429,"event":"return","thread_id":9160,"parent_id":1476428,"elapsed":0.000529084,"elapsed_instrumentation":0.00017464999109506607},{"id":1476430,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT SUM(\"site_uploads\".\"file_file_size\") FROM \"site_uploads\"","database_type":"postgres"}},{"id":1476431,"event":"return","thread_id":9160,"parent_id":1476430,"elapsed":0.000540494,"elapsed_instrumentation":7.041305070742965e-05},{"id":1476432,"event":"return","thread_id":9160,"parent_id":1476417,"elapsed":0.00943394296336919,"elapsed_instrumentation":0.00020760699408128858,"return_value":{"class":"Hash","value":"{:key=>media, :human_key=>Media storage, :value=>0, :unit=>bytes, :human_value=>0 Bytes}","object_id":8338460,"size":5}},{"id":1476433,"event":"call","thread_id":9160,"defined_class":"Admin::Metrics::Dimension::SpaceUsageDimension","method_id":"search_size","path":"app/lib/admin/metrics/dimension/space_usage_dimension.rb","lineno":69,"static":false,"parameters":[],"receiver":{"class":"Admin::Metrics::Dimension::SpaceUsageDimension","object_id":8338260,"value":"#<Admin::Metrics::Dimension::SpaceUsageDimension:0x00007fc93772a828>"}},{"id":1476434,"event":"call","thread_id":9160,"defined_class":"Chewy::SettingsExtensions","method_id":"enabled?","path":"lib/chewy/settings_extensions.rb","lineno":5,"static":true,"parameters":[],"receiver":{"class":"Module","object_id":688920,"value":"Chewy"}},{"id":1476435,"event":"return","thread_id":9160,"parent_id":1476434,"elapsed":1.0135001502931118e-05,"elapsed_instrumentation":7.049005944281816e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1476436,"event":"return","thread_id":9160,"parent_id":1476433,"elapsed":0.014089801989030093,"elapsed_instrumentation":0.00025657599326223135,"return_value":{"class":"Hash","value":"{:key=>search, :human_key=>Elasticsearch, :value=>208, :unit=>bytes, :human_value=>208 Bytes}","object_id":8338480,"size":5}},{"id":1476437,"event":"return","thread_id":9160,"parent_id":1476404,"elapsed":0.0323544520069845,"elapsed_instrumentation":0.00033012102358043194,"return_value":{"class":"Array","value":"[{:key=>postgresql, :human_key=>PostgreSQL, :value=>24732163, :unit=>bytes, :human_value=>23.6 MB}, {:key=>redis, :human_key=>Redis, :value=>2450408, :unit=>bytes, :human_value=>2.34 MB}, {:key=>media, :human_key=>Media storage, :value=>0, :unit=>bytes, :human_value=>0 Bytes}, {:key=>search, :human_key=>Elasticsearch, :value=>208, :unit=>bytes, :human_value=>208 Bytes}]","object_id":8338500,"size":4}},{"id":1476438,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":8338520,"value":"Cache write: metrics/dimension/space_usage;2023-11-04T03:05:14+00:00;2023-11-06T03:05:14+00:00;10; ( (...71 more characters)","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":1476439,"event":"return","thread_id":9160,"parent_id":1476438,"elapsed":0.000538777036126703,"elapsed_instrumentation":0.00015546998474746943,"return_value":{"class":"Integer","value":"171","object_id":343}},{"id":1476440,"event":"call","thread_id":9160,"defined_class":"Marshal","method_id":"dump","path":"Marshal.dump","static":true,"parameters":[{"name":"arg","class":"Array","object_id":8338540,"value":"[[{:key=>postgresql, :human_key=>PostgreSQL, :value=>24732163, :unit=>bytes, :human_value=>23.6 MB}, {:key=>redis, :human_key=>Redis, :value=>2450408, :unit=>bytes, :human_value=>2.34 MB}, {:key=>media, :human_key=>Media storage, :value=>0, :unit=>bytes, :human_value=>0 Bytes}, {:key=>search, :human_key=>Elasticsearch, :value=>208, :unit=>bytes, :human_value=>208 Bytes}]]","kind":"rest","size":1}],"receiver":{"class":"Module","object_id":318180,"value":"Marshal"}},{"id":1476441,"event":"return","thread_id":9160,"parent_id":1476440,"elapsed":5.0520000513643026e-05,"elapsed_instrumentation":0.0004095350159332156,"return_value":{"class":"String","value":"\u0004\b[\t{\n:\bkeyI\"\u000fpostgresql\u0006:\u0006ET:\u000ehuman_keyI\"\u000fPostgreSQL\u0006;\u0006T:\nvalueI\"\r24732163\u0006;\u0006F:\tunitI\"\nbytes\u0006;\u0006T:\u0010h (...290 more characters)","object_id":8338560}},{"id":1476442,"event":"return","thread_id":9160,"parent_id":1476391,"elapsed":0.03642174805281684,"elapsed_instrumentation":0.0003036599373444915,"return_value":{"class":"Array","value":"[{:key=>postgresql, :human_key=>PostgreSQL, :value=>24732163, :unit=>bytes, :human_value=>23.6 MB}, {:key=>redis, :human_key=>Redis, :value=>2450408, :unit=>bytes, :human_value=>2.34 MB}, {:key=>media, :human_key=>Media storage, :value=>0, :unit=>bytes, :human_value=>0 Bytes}, {:key=>search, :human_key=>Elasticsearch, :value=>208, :unit=>bytes, :human_value=>208 Bytes}]","object_id":8338500,"size":4}},{"id":1476443,"event":"return","thread_id":9160,"parent_id":1476390,"elapsed":0.03674576600315049,"elapsed_instrumentation":0.0003030899679288268,"return_value":{"class":"Array","value":"[{:key=>postgresql, :human_key=>PostgreSQL, :value=>24732163, :unit=>bytes, :human_value=>23.6 MB}, {:key=>redis, :human_key=>Redis, :value=>2450408, :unit=>bytes, :human_value=>2.34 MB}, {:key=>media, :human_key=>Media storage, :value=>0, :unit=>bytes, :human_value=>0 Bytes}, {:key=>search, :human_key=>Elasticsearch, :value=>208, :unit=>bytes, :human_value=>208 Bytes}]","object_id":8338500,"size":4}}]}