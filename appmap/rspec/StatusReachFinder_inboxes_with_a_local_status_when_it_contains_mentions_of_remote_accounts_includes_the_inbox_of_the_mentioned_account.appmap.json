{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"743782bd299fd54e12a4a5829872efc505132ab3","status":["M .husky/pre-commit","?? sql_warning.txt"],"git_last_annotated_tag":"0.1.2-14597-g743782bd299fd54e12a4a5829872efc505132ab3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"StatusReachFinder #inboxes with a local status when it contains mentions of remote accounts includes the inbox of the mentioned account","source_location":"spec/lib/status_reach_finder_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"lib","type":"package","children":[{"name":"StatusReachFinder","type":"class","children":[{"name":"inboxes","type":"function","location":"app/lib/status_reach_finder.rb:12","static":false}]},{"name":"DeliveryFailureTracker","type":"class","children":[{"name":"without_unavailable","type":"function","location":"app/lib/delivery_failure_tracker.rb:43","static":true}]}]},{"name":"models","type":"package","children":[{"name":"Status","type":"class","children":[{"name":"reblog?","type":"function","location":"app/models/status.rb:196","static":false},{"name":"in_reply_to_local_account?","type":"function","location":"app/models/status.rb:192","static":false},{"name":"reply?","type":"function","location":"app/models/status.rb:184","static":false}]},{"name":"Account","type":"class","children":[{"name":"inboxes","type":"function","location":"app/models/account.rb:436","static":true}]}]}]},{"name":"logger","type":"package","children":[{"name":"Logger","type":"class","children":[{"name":"LogDevice","type":"class","children":[{"name":"write","type":"function","location":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb:31","static":false,"labels":["log"]}]}]}]},{"name":"ruby","type":"package","children":[{"name":"Marshal","type":"class","children":[{"name":"dump","type":"function","location":"Marshal.dump","static":true,"labels":["serialize"]},{"name":"load","type":"function","location":"<internal:marshal>:33","static":true,"labels":["deserialize.unsafe"]}]}]}],"events":[{"id":1965281,"event":"call","thread_id":9160,"defined_class":"StatusReachFinder","method_id":"inboxes","path":"app/lib/status_reach_finder.rb","lineno":12,"static":false,"parameters":[],"receiver":{"class":"StatusReachFinder","object_id":10563460,"value":"#<StatusReachFinder:0x00007fdbf4e15b40>"}},{"id":1965282,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"reblog?","path":"app/models/status.rb","lineno":196,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":10563380,"value":"#<Status:0x00007fdbf4f46668>"}},{"id":1965283,"event":"return","thread_id":9160,"parent_id":1965282,"elapsed":9.520008461549878e-06,"elapsed_instrumentation":7.172400364652276e-05},{"id":1965284,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"reblog?","path":"app/models/status.rb","lineno":196,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":10563380,"value":"#<Status:0x00007fdbf4f46668>"}},{"id":1965285,"event":"return","thread_id":9160,"parent_id":1965284,"elapsed":4.631001502275467e-06,"elapsed_instrumentation":5.902998964302242e-05},{"id":1965286,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"mentions\".\"account_id\" FROM \"mentions\" WHERE \"mentions\".\"status_id\" = $1","database_type":"postgres"}},{"id":1965287,"event":"return","thread_id":9160,"parent_id":1965286,"elapsed":0.00061967,"elapsed_instrumentation":0.00010340800508856773},{"id":1965288,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"statuses\".\"account_id\" FROM \"statuses\" WHERE \"statuses\".\"reblog_of_id\" = $1 AND \"statuses\".\"deleted_at\" IS NULL ORDER BY \"statuses\".\"id\" DESC","database_type":"postgres"}},{"id":1965289,"event":"return","thread_id":9160,"parent_id":1965288,"elapsed":0.000807744,"elapsed_instrumentation":0.00010098301572725177},{"id":1965290,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"favourites\".\"account_id\" FROM \"favourites\" WHERE \"favourites\".\"status_id\" = $1","database_type":"postgres"}},{"id":1965291,"event":"return","thread_id":9160,"parent_id":1965290,"elapsed":0.000708272,"elapsed_instrumentation":0.00010410000686533749},{"id":1965292,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"statuses\".\"account_id\" FROM \"statuses\" WHERE \"statuses\".\"deleted_at\" IS NULL AND \"statuses\".\"in_reply_to_id\" = $1 ORDER BY \"statuses\".\"id\" DESC","database_type":"postgres"}},{"id":1965293,"event":"return","thread_id":9160,"parent_id":1965292,"elapsed":0.00086232,"elapsed_instrumentation":0.0001022449869196862},{"id":1965294,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"inboxes","path":"app/models/account.rb","lineno":436,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":36540,"value":"Account"}},{"id":1965295,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT coalesce(nullif(accounts.shared_inbox_url, ''), accounts.inbox_url) AS preferred_inbox_url FROM \"accounts\" WHERE \"accounts\".\"id\" = $1 AND \"accounts\".\"protocol\" = $2 GROUP BY \"preferred_inbox_url\"","database_type":"postgres"}},{"id":1965296,"event":"return","thread_id":9160,"parent_id":1965295,"elapsed":0.001146316,"elapsed_instrumentation":0.00010324298636987805},{"id":1965297,"event":"call","thread_id":9160,"defined_class":"DeliveryFailureTracker","method_id":"without_unavailable","path":"app/lib/delivery_failure_tracker.rb","lineno":43,"static":true,"parameters":[{"name":"urls","class":"Array","object_id":10563480,"value":"[https://foo.bar/inbox]","kind":"req","size":1}],"receiver":{"class":"Class","object_id":52940,"value":"DeliveryFailureTracker"}},{"id":1965298,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":10563500,"value":"Cache read: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1965299,"event":"return","thread_id":9160,"parent_id":1965298,"elapsed":0.0008492979977745563,"elapsed_instrumentation":0.00015187798999249935,"return_value":{"class":"Integer","value":"80","object_id":161}},{"id":1965300,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":10563520,"value":"Cache generate: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1965301,"event":"return","thread_id":9160,"parent_id":1965300,"elapsed":0.0009485569898970425,"elapsed_instrumentation":0.0001603499986231327,"return_value":{"class":"Integer","value":"84","object_id":169}},{"id":1965302,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"unavailable_domains\".\"domain\" FROM \"unavailable_domains\"","database_type":"postgres"}},{"id":1965303,"event":"return","thread_id":9160,"parent_id":1965302,"elapsed":0.000968381,"elapsed_instrumentation":0.0001282820012420416},{"id":1965304,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":10563540,"value":"Cache write: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1965305,"event":"return","thread_id":9160,"parent_id":1965304,"elapsed":0.0011490460019558668,"elapsed_instrumentation":0.00015416499809361994,"return_value":{"class":"Integer","value":"81","object_id":163}},{"id":1965306,"event":"call","thread_id":9160,"defined_class":"Marshal","method_id":"dump","path":"Marshal.dump","static":true,"parameters":[{"name":"arg","class":"Array","object_id":10563560,"value":"[{}]","kind":"rest","size":1}],"receiver":{"class":"Module","object_id":209120,"value":"Marshal"}},{"id":1965307,"event":"return","thread_id":9160,"parent_id":1965306,"elapsed":1.1599011486396194e-05,"elapsed_instrumentation":0.00024267699336633086,"return_value":{"class":"String","value":"\u0004\b{\u0000","object_id":10563580}},{"id":1965308,"event":"return","thread_id":9160,"parent_id":1965297,"elapsed":0.006376673001796007,"elapsed_instrumentation":0.000212569982977584,"return_value":{"class":"Array","value":"[https://foo.bar/inbox]","object_id":10563600,"size":1}},{"id":1965309,"event":"return","thread_id":9160,"parent_id":1965294,"elapsed":0.009475861996179447,"elapsed_instrumentation":0.00037521199556067586,"return_value":{"class":"Array","value":"[https://foo.bar/inbox]","object_id":10563600,"size":1}},{"id":1965310,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"in_reply_to_local_account?","path":"app/models/status.rb","lineno":192,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":10563380,"value":"#<Status:0x00007fdbf4f46668>"}},{"id":1965311,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"reply?","path":"app/models/status.rb","lineno":184,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":10563380,"value":"#<Status:0x00007fdbf4f46668>"}},{"id":1965312,"event":"return","thread_id":9160,"parent_id":1965311,"elapsed":0.0001518600038252771,"elapsed_instrumentation":6.130599649623036e-05},{"id":1965313,"event":"return","thread_id":9160,"parent_id":1965310,"elapsed":0.00023479299852624536,"elapsed_instrumentation":8.093801443465054e-05},{"id":1965314,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"inboxes","path":"app/models/account.rb","lineno":436,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":36540,"value":"Account"}},{"id":1965315,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT coalesce(nullif(accounts.shared_inbox_url, ''), accounts.inbox_url) AS preferred_inbox_url FROM \"accounts\" INNER JOIN \"follows\" ON \"accounts\".\"id\" = \"follows\".\"account_id\" WHERE \"follows\".\"target_account_id\" = $1 AND \"accounts\".\"protocol\" = $2 GROUP BY \"preferred_inbox_url\"","database_type":"postgres"}},{"id":1965316,"event":"return","thread_id":9160,"parent_id":1965315,"elapsed":0.001431056,"elapsed_instrumentation":9.809801122173667e-05},{"id":1965317,"event":"call","thread_id":9160,"defined_class":"DeliveryFailureTracker","method_id":"without_unavailable","path":"app/lib/delivery_failure_tracker.rb","lineno":43,"static":true,"parameters":[{"name":"urls","class":"Array","object_id":10563620,"value":"[]","kind":"req","size":0}],"receiver":{"class":"Class","object_id":52940,"value":"DeliveryFailureTracker"}},{"id":1965318,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":10563640,"value":"Cache read: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1965319,"event":"return","thread_id":9160,"parent_id":1965318,"elapsed":0.0010168039880227298,"elapsed_instrumentation":0.00023397902259603143,"return_value":{"class":"Integer","value":"80","object_id":161}},{"id":1965320,"event":"call","thread_id":9160,"defined_class":"Marshal","method_id":"load","path":"<internal:marshal>","lineno":33,"static":true,"parameters":[{"name":"source","class":"String","object_id":10563580,"value":"\u0004\b{\u0000","kind":"req"},{"name":"arg","class":"Array","object_id":10563660,"value":"[]","kind":"rest","size":0}],"receiver":{"class":"Module","object_id":209120,"value":"Marshal"}},{"id":1965321,"event":"return","thread_id":9160,"parent_id":1965320,"elapsed":1.1180003639310598e-05,"elapsed_instrumentation":0.0003583169891498983,"return_value":{"class":"Hash","value":"{}","object_id":10563680,"size":0}},{"id":1965322,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":10563700,"value":"Cache fetch_hit: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1965323,"event":"return","thread_id":9160,"parent_id":1965322,"elapsed":0.0008669630042277277,"elapsed_instrumentation":0.00026557399542070925,"return_value":{"class":"Integer","value":"85","object_id":171}},{"id":1965324,"event":"return","thread_id":9160,"parent_id":1965317,"elapsed":0.003505966014927253,"elapsed_instrumentation":0.0001426299859303981,"return_value":{"class":"Array","value":"[]","object_id":10563720,"size":0}},{"id":1965325,"event":"return","thread_id":9160,"parent_id":1965314,"elapsed":0.006638886028667912,"elapsed_instrumentation":0.00016116499318741262,"return_value":{"class":"Array","value":"[]","object_id":10563720,"size":0}},{"id":1965326,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"relays\".\"inbox_url\" FROM \"relays\" WHERE \"relays\".\"state\" = $1","database_type":"postgres"}},{"id":1965327,"event":"return","thread_id":9160,"parent_id":1965326,"elapsed":0.000801016,"elapsed_instrumentation":9.988999227061868e-05},{"id":1965328,"event":"return","thread_id":9160,"parent_id":1965281,"elapsed":0.03419141401536763,"elapsed_instrumentation":0.00016365500050596893,"return_value":{"class":"Array","value":"[https://foo.bar/inbox]","object_id":10563740,"size":1}}]}