{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","status":["M .husky/pre-commit"],"git_last_annotated_tag":"0.1.2-14608-g2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"User .those_who_can when there are not users with the needed role returns an empty list","source_location":"spec/models/user_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app/models","type":"package","children":[{"name":"User","type":"class","children":[{"name":"those_who_can","type":"function","location":"app/models/user.rb:143","static":true}]},{"name":"UserRole","type":"class","children":[{"name":"that_can","type":"function","location":"app/models/user_role.rb:111","static":true},{"name":"can?","type":"function","location":"app/models/user_role.rb:131","static":false},{"name":"computed_permissions","type":"function","location":"app/models/user_role.rb:139","static":false},{"name":"everyone?","type":"function","location":"app/models/user_role.rb:115","static":false},{"name":"nobody?","type":"function","location":"app/models/user_role.rb:119","static":false},{"name":"everyone","type":"function","location":"app/models/user_role.rb:105","static":true}]}]}],"events":[{"id":1348412,"event":"call","thread_id":9160,"defined_class":"User","method_id":"those_who_can","path":"app/models/user.rb","lineno":143,"static":true,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702820,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"Class","object_id":35120,"value":"User"}},{"id":1348413,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"that_can","path":"app/models/user_role.rb","lineno":111,"static":true,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702840,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1348414,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\"","database_type":"postgres"}},{"id":1348415,"event":"return","thread_id":9160,"parent_id":1348414,"elapsed":0.000664165,"elapsed_instrumentation":8.58129933476448e-05},{"id":1348416,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702860,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7702880,"value":"#<UserRole:0x00007fc91a3cb2d0>"}},{"id":1348417,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702880,"value":"#<UserRole:0x00007fc91a3cb2d0>"}},{"id":1348418,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702880,"value":"#<UserRole:0x00007fc91a3cb2d0>"}},{"id":1348419,"event":"return","thread_id":9160,"parent_id":1348418,"elapsed":1.3585027772933245e-05,"elapsed_instrumentation":8.453597547486424e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1348420,"event":"return","thread_id":9160,"parent_id":1348417,"elapsed":0.00012564001372084022,"elapsed_instrumentation":0.00012932898243889213,"return_value":{"class":"Integer","value":"65536","object_id":131073}},{"id":1348421,"event":"return","thread_id":9160,"parent_id":1348416,"elapsed":0.00028240500250831246,"elapsed_instrumentation":0.00010510499123483896},{"id":1348422,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702900,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7702920,"value":"#<UserRole:0x00007fc91a3cb050>"}},{"id":1348423,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702920,"value":"#<UserRole:0x00007fc91a3cb050>"}},{"id":1348424,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702920,"value":"#<UserRole:0x00007fc91a3cb050>"}},{"id":1348425,"event":"return","thread_id":9160,"parent_id":1348424,"elapsed":7.5150164775550365e-06,"elapsed_instrumentation":4.5783002860844135e-05},{"id":1348426,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"nobody?","path":"app/models/user_role.rb","lineno":119,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702920,"value":"#<UserRole:0x00007fc91a3cb050>"}},{"id":1348427,"event":"return","thread_id":9160,"parent_id":1348426,"elapsed":4.5879860408604145e-06,"elapsed_instrumentation":4.6989007387310266e-05},{"id":1348428,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone","path":"app/models/user_role.rb","lineno":105,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1348429,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2","database_type":"postgres"}},{"id":1348430,"event":"return","thread_id":9160,"parent_id":1348429,"elapsed":0.00048693,"elapsed_instrumentation":6.88210129737854e-05},{"id":1348431,"event":"return","thread_id":9160,"parent_id":1348428,"elapsed":0.001009283005259931,"elapsed_instrumentation":8.896499639376998e-05,"return_value":{"class":"UserRole","value":"#<UserRole:0x00007fc91a3cab50>","object_id":7702940}},{"id":1348432,"event":"return","thread_id":9160,"parent_id":1348423,"elapsed":0.0012604150106199086,"elapsed_instrumentation":5.94420125707984e-05,"return_value":{"class":"Integer","value":"66844","object_id":133689}},{"id":1348433,"event":"return","thread_id":9160,"parent_id":1348422,"elapsed":0.0013386899954639375,"elapsed_instrumentation":8.195702685043216e-05},{"id":1348434,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702960,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7702980,"value":"#<UserRole:0x00007fc91a3caf10>"}},{"id":1348435,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702980,"value":"#<UserRole:0x00007fc91a3caf10>"}},{"id":1348436,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702980,"value":"#<UserRole:0x00007fc91a3caf10>"}},{"id":1348437,"event":"return","thread_id":9160,"parent_id":1348436,"elapsed":8.549017366021872e-06,"elapsed_instrumentation":4.661304410547018e-05},{"id":1348438,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"nobody?","path":"app/models/user_role.rb","lineno":119,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702980,"value":"#<UserRole:0x00007fc91a3caf10>"}},{"id":1348439,"event":"return","thread_id":9160,"parent_id":1348438,"elapsed":4.110042937099934e-06,"elapsed_instrumentation":4.842097405344248e-05},{"id":1348440,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone","path":"app/models/user_role.rb","lineno":105,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1348441,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2","database_type":"postgres"}},{"id":1348442,"event":"return","thread_id":9160,"parent_id":1348441,"elapsed":0.000349559,"elapsed_instrumentation":7.58090172894299e-05},{"id":1348443,"event":"return","thread_id":9160,"parent_id":1348440,"elapsed":0.0009690200095064938,"elapsed_instrumentation":0.00032531400211155415,"return_value":{"class":"UserRole","value":"#<UserRole:0x00007fc91a3ca8d0>","object_id":7703000}},{"id":1348444,"event":"return","thread_id":9160,"parent_id":1348435,"elapsed":0.0014650209923274815,"elapsed_instrumentation":6.364198634400964e-05,"return_value":{"class":"Integer","value":"1048572","object_id":2097145}},{"id":1348445,"event":"return","thread_id":9160,"parent_id":1348434,"elapsed":0.0015486989868804812,"elapsed_instrumentation":9.728997247293591e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1348446,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7703020,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7703040,"value":"#<UserRole:0x00007fc91a3cadd0>"}},{"id":1348447,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7703040,"value":"#<UserRole:0x00007fc91a3cadd0>"}},{"id":1348448,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7703040,"value":"#<UserRole:0x00007fc91a3cadd0>"}},{"id":1348449,"event":"return","thread_id":9160,"parent_id":1348448,"elapsed":9.038019925355911e-06,"elapsed_instrumentation":4.9656955525279045e-05},{"id":1348450,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"nobody?","path":"app/models/user_role.rb","lineno":119,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7703040,"value":"#<UserRole:0x00007fc91a3cadd0>"}},{"id":1348451,"event":"return","thread_id":9160,"parent_id":1348450,"elapsed":4.6800123527646065e-06,"elapsed_instrumentation":5.066697485744953e-05},{"id":1348452,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone","path":"app/models/user_role.rb","lineno":105,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1348453,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2","database_type":"postgres"}},{"id":1348454,"event":"return","thread_id":9160,"parent_id":1348453,"elapsed":0.000453449,"elapsed_instrumentation":7.018697215244174e-05},{"id":1348455,"event":"return","thread_id":9160,"parent_id":1348452,"elapsed":0.0009973550331778824,"elapsed_instrumentation":9.59919998422265e-05,"return_value":{"class":"UserRole","value":"#<UserRole:0x00007fc91a3ca650>","object_id":7703060}},{"id":1348456,"event":"return","thread_id":9160,"parent_id":1348447,"elapsed":0.001266122970264405,"elapsed_instrumentation":6.481801392510533e-05,"return_value":{"class":"Integer","value":"1048575","object_id":2097151}},{"id":1348457,"event":"return","thread_id":9160,"parent_id":1348446,"elapsed":0.0013525999966077507,"elapsed_instrumentation":0.00010933197336271405,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1348458,"event":"return","thread_id":9160,"parent_id":1348413,"elapsed":0.006295927043538541,"elapsed_instrumentation":0.00011590402573347092,"return_value":{"class":"Array","value":"[#<UserRole:0x00007fc91a3caf10>, #<UserRole:0x00007fc91a3cadd0>]","object_id":7703080,"size":2}},{"id":1348459,"event":"return","thread_id":9160,"parent_id":1348412,"elapsed":0.006768867955543101,"elapsed_instrumentation":0.00020630407379940152,"return_value":{"class":"ActiveRecord::Relation","value":"#<User::ActiveRecord_Relation:0x00007fc919b324e8>","object_id":7703100}},{"id":1348460,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"users\".\"id\", \"users\".\"email\", \"users\".\"created_at\", \"users\".\"updated_at\", \"users\".\"encrypted_password\", \"users\".\"reset_password_token\", \"users\".\"reset_password_sent_at\", \"users\".\"sign_in_count\", \"users\".\"current_sign_in_at\", \"users\".\"last_sign_in_at\", \"users\".\"admin\", \"users\".\"confirmation_token\", \"users\".\"confirmed_at\", \"users\".\"confirmation_sent_at\", \"users\".\"unconfirmed_email\", \"users\".\"locale\", \"users\".\"encrypted_otp_secret\", \"users\".\"encrypted_otp_secret_iv\", \"users\".\"encrypted_otp_secret_salt\", \"users\".\"consumed_timestep\", \"users\".\"otp_required_for_login\", \"users\".\"last_emailed_at\", \"users\".\"otp_backup_codes\", \"users\".\"account_id\", \"users\".\"disabled\", \"users\".\"moderator\", \"users\".\"invite_id\", \"users\".\"chosen_languages\", \"users\".\"created_by_application_id\", \"users\".\"approved\", \"users\".\"sign_in_token\", \"users\".\"sign_in_token_sent_at\", \"users\".\"webauthn_id\", \"users\".\"sign_up_ip\", \"users\".\"role_id\", \"users\".\"settings\", \"users\".\"time_zone\" FROM \"users\" WHERE \"users\".\"role_id\" IN ($1, $2)","database_type":"postgres"}},{"id":1348461,"event":"return","thread_id":9160,"parent_id":1348460,"elapsed":0.000788074,"elapsed_instrumentation":9.206298273056746e-05}]}