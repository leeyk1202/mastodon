{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"743782bd299fd54e12a4a5829872efc505132ab3","status":["M .husky/pre-commit","?? sql_warning.txt"],"git_last_annotated_tag":"0.1.2-14597-g743782bd299fd54e12a4a5829872efc505132ab3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"StatusReachFinder #inboxes with a local status when it has been replied to by a remote account includes the inbox of the replier","source_location":"spec/lib/status_reach_finder_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"lib","type":"package","children":[{"name":"StatusReachFinder","type":"class","children":[{"name":"inboxes","type":"function","location":"app/lib/status_reach_finder.rb:12","static":false}]},{"name":"DeliveryFailureTracker","type":"class","children":[{"name":"without_unavailable","type":"function","location":"app/lib/delivery_failure_tracker.rb:43","static":true}]}]},{"name":"models","type":"package","children":[{"name":"Status","type":"class","children":[{"name":"reblog?","type":"function","location":"app/models/status.rb:196","static":false},{"name":"in_reply_to_local_account?","type":"function","location":"app/models/status.rb:192","static":false},{"name":"reply?","type":"function","location":"app/models/status.rb:184","static":false}]},{"name":"Account","type":"class","children":[{"name":"inboxes","type":"function","location":"app/models/account.rb:436","static":true}]}]}]},{"name":"logger","type":"package","children":[{"name":"Logger","type":"class","children":[{"name":"LogDevice","type":"class","children":[{"name":"write","type":"function","location":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb:31","static":false,"labels":["log"]}]}]}]},{"name":"ruby","type":"package","children":[{"name":"Marshal","type":"class","children":[{"name":"dump","type":"function","location":"Marshal.dump","static":true,"labels":["serialize"]},{"name":"load","type":"function","location":"<internal:marshal>:33","static":true,"labels":["deserialize.unsafe"]}]}]}],"events":[{"id":1965109,"event":"call","thread_id":9160,"defined_class":"StatusReachFinder","method_id":"inboxes","path":"app/lib/status_reach_finder.rb","lineno":12,"static":false,"parameters":[],"receiver":{"class":"StatusReachFinder","object_id":10561720,"value":"#<StatusReachFinder:0x00007fdbf5779088>"}},{"id":1965110,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"reblog?","path":"app/models/status.rb","lineno":196,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":10561640,"value":"#<Status:0x00007fdbf58aa308>"}},{"id":1965111,"event":"return","thread_id":9160,"parent_id":1965110,"elapsed":9.50600951910019e-06,"elapsed_instrumentation":0.00010717599070630968},{"id":1965112,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"reblog?","path":"app/models/status.rb","lineno":196,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":10561640,"value":"#<Status:0x00007fdbf58aa308>"}},{"id":1965113,"event":"return","thread_id":9160,"parent_id":1965112,"elapsed":4.76400600746274e-06,"elapsed_instrumentation":6.744900019839406e-05},{"id":1965114,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"mentions\".\"account_id\" FROM \"mentions\" WHERE \"mentions\".\"status_id\" = $1","database_type":"postgres"}},{"id":1965115,"event":"return","thread_id":9160,"parent_id":1965114,"elapsed":0.000801387,"elapsed_instrumentation":0.00013567000860348344},{"id":1965116,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"statuses\".\"account_id\" FROM \"statuses\" WHERE \"statuses\".\"reblog_of_id\" = $1 AND \"statuses\".\"deleted_at\" IS NULL ORDER BY \"statuses\".\"id\" DESC","database_type":"postgres"}},{"id":1965117,"event":"return","thread_id":9160,"parent_id":1965116,"elapsed":0.000632469,"elapsed_instrumentation":8.563502342440188e-05},{"id":1965118,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"favourites\".\"account_id\" FROM \"favourites\" WHERE \"favourites\".\"status_id\" = $1","database_type":"postgres"}},{"id":1965119,"event":"return","thread_id":9160,"parent_id":1965118,"elapsed":0.000639346,"elapsed_instrumentation":0.00027223999495618045},{"id":1965120,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"statuses\".\"account_id\" FROM \"statuses\" WHERE \"statuses\".\"deleted_at\" IS NULL AND \"statuses\".\"in_reply_to_id\" = $1 ORDER BY \"statuses\".\"id\" DESC","database_type":"postgres"}},{"id":1965121,"event":"return","thread_id":9160,"parent_id":1965120,"elapsed":0.000906887,"elapsed_instrumentation":0.0002857409999705851},{"id":1965122,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"inboxes","path":"app/models/account.rb","lineno":436,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":36540,"value":"Account"}},{"id":1965123,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT coalesce(nullif(accounts.shared_inbox_url, ''), accounts.inbox_url) AS preferred_inbox_url FROM \"accounts\" WHERE \"accounts\".\"id\" = $1 AND \"accounts\".\"protocol\" = $2 GROUP BY \"preferred_inbox_url\"","database_type":"postgres"}},{"id":1965124,"event":"return","thread_id":9160,"parent_id":1965123,"elapsed":0.001349819,"elapsed_instrumentation":0.00012149600661359727},{"id":1965125,"event":"call","thread_id":9160,"defined_class":"DeliveryFailureTracker","method_id":"without_unavailable","path":"app/lib/delivery_failure_tracker.rb","lineno":43,"static":true,"parameters":[{"name":"urls","class":"Array","object_id":10561740,"value":"[https://foo.bar/inbox]","kind":"req","size":1}],"receiver":{"class":"Class","object_id":52940,"value":"DeliveryFailureTracker"}},{"id":1965126,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":10561760,"value":"Cache read: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1965127,"event":"return","thread_id":9160,"parent_id":1965126,"elapsed":0.0009873450035229325,"elapsed_instrumentation":0.00023409296409226954,"return_value":{"class":"Integer","value":"80","object_id":161}},{"id":1965128,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":10561780,"value":"Cache generate: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1965129,"event":"return","thread_id":9160,"parent_id":1965128,"elapsed":0.0027411320188548416,"elapsed_instrumentation":0.0002865839924197644,"return_value":{"class":"Integer","value":"84","object_id":169}},{"id":1965130,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"unavailable_domains\".\"domain\" FROM \"unavailable_domains\"","database_type":"postgres"}},{"id":1965131,"event":"return","thread_id":9160,"parent_id":1965130,"elapsed":0.00146255,"elapsed_instrumentation":0.00018913298845291138},{"id":1965132,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":10561800,"value":"Cache write: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1965133,"event":"return","thread_id":9160,"parent_id":1965132,"elapsed":0.0008045760041568428,"elapsed_instrumentation":0.00021798096713609993,"return_value":{"class":"Integer","value":"81","object_id":163}},{"id":1965134,"event":"call","thread_id":9160,"defined_class":"Marshal","method_id":"dump","path":"Marshal.dump","static":true,"parameters":[{"name":"arg","class":"Array","object_id":10561820,"value":"[{}]","kind":"rest","size":1}],"receiver":{"class":"Module","object_id":209120,"value":"Marshal"}},{"id":1965135,"event":"return","thread_id":9160,"parent_id":1965134,"elapsed":1.5866971807554364e-05,"elapsed_instrumentation":0.000705424026818946,"return_value":{"class":"String","value":"\u0004\b{\u0000","object_id":10561840}},{"id":1965136,"event":"return","thread_id":9160,"parent_id":1965125,"elapsed":0.010905219009146094,"elapsed_instrumentation":0.00030519202118739486,"return_value":{"class":"Array","value":"[https://foo.bar/inbox]","object_id":10561860,"size":1}},{"id":1965137,"event":"return","thread_id":9160,"parent_id":1965122,"elapsed":0.014026853983523324,"elapsed_instrumentation":0.0004109170404262841,"return_value":{"class":"Array","value":"[https://foo.bar/inbox]","object_id":10561860,"size":1}},{"id":1965138,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"in_reply_to_local_account?","path":"app/models/status.rb","lineno":192,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":10561640,"value":"#<Status:0x00007fdbf58aa308>"}},{"id":1965139,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"reply?","path":"app/models/status.rb","lineno":184,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":10561640,"value":"#<Status:0x00007fdbf58aa308>"}},{"id":1965140,"event":"return","thread_id":9160,"parent_id":1965139,"elapsed":9.278600919060409e-05,"elapsed_instrumentation":8.318500476889312e-05},{"id":1965141,"event":"return","thread_id":9160,"parent_id":1965138,"elapsed":0.00021292001474648714,"elapsed_instrumentation":0.00021668599219992757},{"id":1965142,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"inboxes","path":"app/models/account.rb","lineno":436,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":36540,"value":"Account"}},{"id":1965143,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT coalesce(nullif(accounts.shared_inbox_url, ''), accounts.inbox_url) AS preferred_inbox_url FROM \"accounts\" INNER JOIN \"follows\" ON \"accounts\".\"id\" = \"follows\".\"account_id\" WHERE \"follows\".\"target_account_id\" = $1 AND \"accounts\".\"protocol\" = $2 GROUP BY \"preferred_inbox_url\"","database_type":"postgres"}},{"id":1965144,"event":"return","thread_id":9160,"parent_id":1965143,"elapsed":0.001364025,"elapsed_instrumentation":0.0001031740102916956},{"id":1965145,"event":"call","thread_id":9160,"defined_class":"DeliveryFailureTracker","method_id":"without_unavailable","path":"app/lib/delivery_failure_tracker.rb","lineno":43,"static":true,"parameters":[{"name":"urls","class":"Array","object_id":10561880,"value":"[]","kind":"req","size":0}],"receiver":{"class":"Class","object_id":52940,"value":"DeliveryFailureTracker"}},{"id":1965146,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":10561900,"value":"Cache read: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1965147,"event":"return","thread_id":9160,"parent_id":1965146,"elapsed":0.0010100009967572987,"elapsed_instrumentation":0.0001680040149949491,"return_value":{"class":"Integer","value":"80","object_id":161}},{"id":1965148,"event":"call","thread_id":9160,"defined_class":"Marshal","method_id":"load","path":"<internal:marshal>","lineno":33,"static":true,"parameters":[{"name":"source","class":"String","object_id":10561840,"value":"\u0004\b{\u0000","kind":"req"},{"name":"arg","class":"Array","object_id":10561920,"value":"[]","kind":"rest","size":0}],"receiver":{"class":"Module","object_id":209120,"value":"Marshal"}},{"id":1965149,"event":"return","thread_id":9160,"parent_id":1965148,"elapsed":9.915005648508668e-06,"elapsed_instrumentation":0.00026609800988808274,"return_value":{"class":"Hash","value":"{}","object_id":10561940,"size":0}},{"id":1965150,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":10561960,"value":"Cache fetch_hit: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1965151,"event":"return","thread_id":9160,"parent_id":1965150,"elapsed":0.0010156170174013823,"elapsed_instrumentation":0.00024846900487318635,"return_value":{"class":"Integer","value":"85","object_id":171}},{"id":1965152,"event":"return","thread_id":9160,"parent_id":1965145,"elapsed":0.0032594919903203845,"elapsed_instrumentation":0.00019299998530186713,"return_value":{"class":"Array","value":"[]","object_id":10561980,"size":0}},{"id":1965153,"event":"return","thread_id":9160,"parent_id":1965142,"elapsed":0.0066874990006908774,"elapsed_instrumentation":0.0002128329942934215,"return_value":{"class":"Array","value":"[]","object_id":10561980,"size":0}},{"id":1965154,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"relays\".\"inbox_url\" FROM \"relays\" WHERE \"relays\".\"state\" = $1","database_type":"postgres"}},{"id":1965155,"event":"return","thread_id":9160,"parent_id":1965154,"elapsed":0.00087816,"elapsed_instrumentation":0.00010587699944153428},{"id":1965156,"event":"return","thread_id":9160,"parent_id":1965109,"elapsed":0.038666611013468355,"elapsed_instrumentation":0.0002738699549809098,"return_value":{"class":"Array","value":"[https://foo.bar/inbox]","object_id":10562000,"size":1}}]}