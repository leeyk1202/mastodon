{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","status":["M .husky/pre-commit"],"git_last_annotated_tag":"0.1.2-14608-g2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"ApplicationController helper_method :current_theme returns \"default\" when theme wasn't changed in admin settings","source_location":"spec/controllers/application_controller_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"controllers","type":"package","children":[{"name":"ApplicationController","type":"class","children":[{"name":"current_theme","type":"function","location":"app/controllers/application_controller.rb:159","static":false}]}]},{"name":"lib","type":"package","children":[{"name":"Themes","type":"class","children":[{"name":"names","type":"function","location":"app/lib/themes.rb:13","static":false}]},{"name":"RequestPool","type":"class","children":[{"name":"flush","type":"function","location":"app/lib/request_pool.rb:114","static":false}]},{"name":"connection_pool","type":"package","children":[{"name":"ConnectionPool","type":"class","children":[{"name":"SharedConnectionPool","type":"class","children":[{"name":"flush","type":"function","location":"app/lib/connection_pool/shared_connection_pool.rb:13","static":false}]},{"name":"SharedTimedStack","type":"class","children":[{"name":"flush","type":"function","location":"app/lib/connection_pool/shared_timed_stack.rb:51","static":false}]}]}]}]},{"name":"models","type":"package","children":[{"name":"Setting","type":"class","children":[{"name":"[]","type":"function","location":"app/models/setting.rb:24","static":true}]}]}]},{"name":"actionpack","type":"package","children":[{"name":"ActionDispatch","type":"class","children":[{"name":"Cookies","type":"class","children":[{"name":"CookieJar","type":"class","children":[{"name":"update","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/actionpack-7.1.1/lib/action_dispatch/middleware/cookies.rb:344","static":false,"labels":["http.session.write"]},{"name":"[]","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/actionpack-7.1.1/lib/action_dispatch/middleware/cookies.rb:328","static":false,"labels":["http.session.read"]}]}]}]}]},{"name":"logger","type":"package","children":[{"name":"Logger","type":"class","children":[{"name":"LogDevice","type":"class","children":[{"name":"write","type":"function","location":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb:31","static":false,"labels":["log"]}]}]}]}],"events":[{"id":2813726,"event":"call","thread_id":9160,"defined_class":"ApplicationController","method_id":"current_theme","path":"app/controllers/application_controller.rb","lineno":159,"static":false,"parameters":[],"receiver":{"class":"AnonymousController","object_id":13712540,"value":"#<#<Class:0x00007fc93b27aab8>:0x00007fc919fc7d00>"}},{"id":2813727,"event":"call","thread_id":9160,"defined_class":"Themes","method_id":"names","path":"app/lib/themes.rb","lineno":13,"static":false,"parameters":[],"receiver":{"class":"Themes","object_id":902940,"value":"#<Themes:0x00007fc933db8478>"}},{"id":2813728,"event":"return","thread_id":9160,"parent_id":2813727,"elapsed":4.032044671475887e-06,"elapsed_instrumentation":0.0001332589308731258,"return_value":{"class":"Array","value":"[default, contrast, mastodon-light]","object_id":13712560,"size":3}},{"id":2813729,"event":"call","thread_id":9160,"defined_class":"ActionDispatch::Cookies::CookieJar","method_id":"update","path":"vendor/bundle/ruby/3.2.0/gems/actionpack-7.1.1/lib/action_dispatch/middleware/cookies.rb","lineno":344,"static":false,"parameters":[{"name":"other_hash","class":"ActiveSupport::HashWithIndifferentAccess","object_id":13712580,"value":"{}","kind":"req","size":0}],"receiver":{"class":"ActionDispatch::Cookies::CookieJar","object_id":13712600,"value":"#<ActionDispatch::Cookies::CookieJar:0x00007fc8e14e6cc0>"}},{"id":2813730,"event":"return","thread_id":9160,"parent_id":2813729,"elapsed":2.2280961275100708e-05,"elapsed_instrumentation":0.0001761390594765544,"return_value":{"class":"ActionDispatch::Cookies::CookieJar","value":"#<ActionDispatch::Cookies::CookieJar:0x00007fc8e14e6cc0>","object_id":13712600}},{"id":2813731,"event":"call","thread_id":9160,"defined_class":"ActionDispatch::Cookies::CookieJar","method_id":"[]","path":"vendor/bundle/ruby/3.2.0/gems/actionpack-7.1.1/lib/action_dispatch/middleware/cookies.rb","lineno":328,"static":false,"parameters":[{"name":"name","class":"String","object_id":317160,"value":"_session_id","kind":"req"}],"receiver":{"class":"ActionDispatch::Cookies::CookieJar","object_id":13712600,"value":"#<ActionDispatch::Cookies::CookieJar:0x00007fc8e14e6cc0>"}},{"id":2813732,"event":"return","thread_id":9160,"parent_id":2813731,"elapsed":4.467030521482229e-06,"elapsed_instrumentation":0.00012113002594560385},{"id":2813733,"event":"call","thread_id":9160,"defined_class":"Setting","method_id":"[]","path":"app/models/setting.rb","lineno":24,"static":true,"parameters":[{"name":"key","class":"String","object_id":13712620,"value":"theme","kind":"req"}],"receiver":{"class":"Class","object_id":61700,"value":"Setting"}},{"id":2813734,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":13712640,"value":"Cache read: rails_settings_cached/7236420e1d6bc0e8bb3d1d7df7c57de7/theme ({:compress=>false, :compre (...21 more characters)","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":2813735,"event":"return","thread_id":9160,"parent_id":2813734,"elapsed":0.001595095032826066,"elapsed_instrumentation":0.00018053496023640037,"return_value":{"class":"Integer","value":"121","object_id":243}},{"id":2813736,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":13712660,"value":"Cache generate: rails_settings_cached/7236420e1d6bc0e8bb3d1d7df7c57de7/theme ({:compress=>false, :co (...25 more characters)","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":2813737,"event":"return","thread_id":9160,"parent_id":2813736,"elapsed":0.001204029016662389,"elapsed_instrumentation":0.00020402198424562812,"return_value":{"class":"Integer","value":"125","object_id":251}},{"id":2813738,"event":"call","thread_id":13276700,"defined_class":"RequestPool","method_id":"flush","path":"app/lib/request_pool.rb","lineno":114,"static":false,"parameters":[{"name":"*","class":"Array","object_id":13712680,"value":"[]","kind":"rest","size":0},{"name":"**","class":"Hash","object_id":13712700,"value":"{}","kind":"keyrest","size":0},{"name":"&","class":"NilClass","object_id":4,"value":null,"kind":"block"}],"receiver":{"class":"RequestPool","object_id":13276720,"value":"#<RequestPool:0x00007fc937dbdb90>"}},{"id":2813739,"event":"call","thread_id":13276700,"defined_class":"ConnectionPool::SharedConnectionPool","method_id":"flush","path":"app/lib/connection_pool/shared_connection_pool.rb","lineno":13,"static":false,"parameters":[{"name":"*","class":"Array","object_id":13712720,"value":"[]","kind":"rest","size":0},{"name":"**","class":"Hash","object_id":13712740,"value":"{}","kind":"keyrest","size":0},{"name":"&","class":"NilClass","object_id":4,"value":null,"kind":"block"}],"receiver":{"class":"ConnectionPool::SharedConnectionPool","object_id":13276740,"value":"#<ConnectionPool::SharedConnectionPool:0x00007fc93772a698>"}},{"id":2813740,"event":"call","thread_id":13276700,"defined_class":"ConnectionPool::SharedTimedStack","method_id":"flush","path":"app/lib/connection_pool/shared_timed_stack.rb","lineno":51,"static":false,"parameters":[],"receiver":{"class":"ConnectionPool::SharedTimedStack","object_id":13276780,"value":"#<ConnectionPool::SharedTimedStack:0x00007fc93772a5a8>"}},{"id":2813741,"event":"return","thread_id":13276700,"parent_id":2813740,"elapsed":1.036300091072917e-05,"elapsed_instrumentation":0.00014896196080371737,"return_value":{"class":"Array","value":"[]","object_id":13277080,"size":0}},{"id":2813742,"event":"return","thread_id":13276700,"parent_id":2813739,"elapsed":0.00019088899716734886,"elapsed_instrumentation":0.00027078803395852447,"return_value":{"class":"Array","value":"[]","object_id":13277080,"size":0}},{"id":2813743,"event":"return","thread_id":13276700,"parent_id":2813738,"elapsed":0.0005008350126445293,"elapsed_instrumentation":0.00035147700691595674,"return_value":{"class":"Array","value":"[]","object_id":13277080,"size":0}},{"id":2813744,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"settings\".* FROM \"settings\" WHERE (thing_type is NULL and thing_id is NULL) AND \"settings\".\"var\" = $1 ORDER BY \"settings\".\"id\" ASC LIMIT $2","database_type":"postgres"}},{"id":2813745,"event":"return","thread_id":9160,"parent_id":2813744,"elapsed":0.001539392,"elapsed_instrumentation":0.00014470797032117844},{"id":2813746,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":13712760,"value":"Cache write: rails_settings_cached/7236420e1d6bc0e8bb3d1d7df7c57de7/theme ({:compress=>false, :compr (...22 more characters)","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":2813747,"event":"return","thread_id":9160,"parent_id":2813746,"elapsed":0.0013696710229851305,"elapsed_instrumentation":0.00020818895427510142,"return_value":{"class":"Integer","value":"122","object_id":245}},{"id":2813748,"event":"return","thread_id":9160,"parent_id":2813733,"elapsed":0.00997065898263827,"elapsed_instrumentation":0.000164442986715585,"return_value":{"class":"String","value":"default","object_id":891740}},{"id":2813749,"event":"return","thread_id":9160,"parent_id":2813726,"elapsed":0.012554273998830467,"elapsed_instrumentation":0.00029534607892856,"return_value":{"class":"String","value":"default","object_id":891740}}]}