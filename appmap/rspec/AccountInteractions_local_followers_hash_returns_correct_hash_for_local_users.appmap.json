{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","status":["M .husky/pre-commit"],"git_last_annotated_tag":"0.1.2-14608-g2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"AccountInteractions #local_followers_hash returns correct hash for local users","source_location":"spec/models/concerns/account_interactions_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"models","type":"package","children":[{"name":"concerns","type":"package","children":[{"name":"AccountInteractions","type":"class","children":[{"name":"local_followers_hash","type":"function","location":"app/models/concerns/account_interactions.rb:292","static":false}]}]},{"name":"Account","type":"class","children":[{"name":"local?","type":"function","location":"app/models/account.rb:163","static":false},{"name":"object_type","type":"function","location":"app/models/account.rb:385","static":false},{"name":"instance_actor?","type":"function","location":"app/models/account.rb:175","static":false},{"name":"to_param","type":"function","location":"app/models/account.rb:389","static":false}]}]},{"name":"lib/activitypub","type":"package","children":[{"name":"ActivityPub","type":"class","children":[{"name":"TagManager","type":"class","children":[{"name":"uri_for_username","type":"function","location":"app/lib/activitypub/tag_manager.rb:57","static":false},{"name":"uri_for","type":"function","location":"app/lib/activitypub/tag_manager.rb:36","static":false}]}]}]},{"name":"helpers","type":"package","children":[{"name":"ActivityPub","type":"class","children":[{"name":"TagManager","type":"class","children":[{"name":"default_url_options","type":"function","location":"app/helpers/routing_helper.rb:12","static":false}]}]}]}]},{"name":"logger","type":"package","children":[{"name":"Logger","type":"class","children":[{"name":"LogDevice","type":"class","children":[{"name":"write","type":"function","location":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb:31","static":false,"labels":["log"]}]}]}]},{"name":"lib/active_record","type":"package","children":[{"name":"ActiveRecord","type":"class","children":[{"name":"Batches","type":"class","children":[{"name":"pluck_each","type":"function","location":"lib/active_record/batches.rb:5","static":false}]}]}]},{"name":"ruby","type":"package","children":[{"name":"String","type":"class","children":[{"name":"unpack1","type":"function","location":"<internal:pack>:28","static":false,"labels":["string.unpack"]}]}]}],"events":[{"id":577705,"event":"call","thread_id":9160,"defined_class":"AccountInteractions","method_id":"local_followers_hash","path":"app/models/concerns/account_interactions.rb","lineno":292,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3839620,"value":"#<Account:0x00007fc919a74d80>"}},{"id":577706,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":3839660,"value":"Cache read: followers_hash:111361347203385763:local ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":577707,"event":"return","thread_id":9160,"parent_id":577706,"elapsed":0.00040652998723089695,"elapsed_instrumentation":0.00013680895790457726,"return_value":{"class":"Integer","value":"100","object_id":201}},{"id":577708,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":3839680,"value":"Cache generate: followers_hash:111361347203385763:local ({:compress=>false, :compress_threshold=>102 (...4 more characters)","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":577709,"event":"return","thread_id":9160,"parent_id":577708,"elapsed":0.00045888900058344007,"elapsed_instrumentation":0.00012502999743446708,"return_value":{"class":"Integer","value":"104","object_id":209}},{"id":577710,"event":"call","thread_id":9160,"defined_class":"ActiveRecord::Batches","method_id":"pluck_each","path":"lib/active_record/batches.rb","lineno":5,"static":false,"parameters":[{"name":"column_names","class":"Array","object_id":3839700,"value":"[:username]","kind":"rest","size":1}],"receiver":{"class":"ActiveRecord::AssociationRelation","object_id":3839720,"value":"#<Account::ActiveRecord_AssociationRelation:0x00007fc919a71400>"}},{"id":577711,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"accounts\".\"id\", \"accounts\".\"username\" FROM \"accounts\" INNER JOIN \"follows\" ON \"accounts\".\"id\" = \"follows\".\"account_id\" WHERE \"follows\".\"target_account_id\" = $1 AND \"accounts\".\"domain\" IS NULL ORDER BY \"accounts\".\"id\" ASC LIMIT $2","database_type":"postgres"}},{"id":577712,"event":"return","thread_id":9160,"parent_id":577711,"elapsed":0.001021454,"elapsed_instrumentation":9.365798905491829e-05},{"id":577713,"event":"call","thread_id":9160,"defined_class":"ActivityPub::TagManager","method_id":"uri_for_username","path":"app/lib/activitypub/tag_manager.rb","lineno":57,"static":false,"parameters":[{"name":"username","class":"String","object_id":3839740,"value":"Me","kind":"req"}],"receiver":{"class":"ActivityPub::TagManager","object_id":325700,"value":"#<ActivityPub::TagManager:0x00007fc937c92608>"}},{"id":577714,"event":"call","thread_id":9160,"defined_class":"ActivityPub::TagManager","method_id":"default_url_options","path":"app/helpers/routing_helper.rb","lineno":12,"static":false,"parameters":[],"receiver":{"class":"ActivityPub::TagManager","object_id":325700,"value":"#<ActivityPub::TagManager:0x00007fc937c92608>"}},{"id":577715,"event":"return","thread_id":9160,"parent_id":577714,"elapsed":5.737005267292261e-06,"elapsed_instrumentation":0.0001179660321213305,"return_value":{"class":"Hash","value":"{:host=>cb6e6126.ngrok.io, :protocol=>https://, :trailing_slash=>false}","object_id":325720,"size":3}},{"id":577716,"event":"return","thread_id":9160,"parent_id":577713,"elapsed":0.0003144320216961205,"elapsed_instrumentation":0.00016160396626219153,"return_value":{"class":"String","value":"https://cb6e6126.ngrok.io/users/Me","object_id":3839760}},{"id":577717,"event":"return","thread_id":9160,"parent_id":577710,"elapsed":0.0034509249962866306,"elapsed_instrumentation":0.0002200250164605677},{"id":577718,"event":"call","thread_id":9160,"defined_class":"String","method_id":"unpack1","path":"<internal:pack>","lineno":28,"static":false,"parameters":[{"name":"fmt","class":"String","object_id":3826100,"value":"H*","kind":"req"},{"name":"offset","class":"NilClass","object_id":4,"value":null,"kind":"key"}],"receiver":{"class":"String","object_id":3839780,"value":"i__\u0010`\u001b_\u0003_]4____d_E\u001fy__\u0013\u001d\u0010$___L"}},{"id":577719,"event":"return","thread_id":9160,"parent_id":577718,"elapsed":4.408007953315973e-06,"elapsed_instrumentation":9.911094093695283e-05,"return_value":{"class":"String","value":"698b9a10601b8303cc5d34e0dee2df64c37f451f79ed84e3131d1024f0d4cd4c","object_id":3839800}},{"id":577720,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":3839820,"value":"Cache write: followers_hash:111361347203385763:local ({:compress=>false, :compress_threshold=>1024}) (...1 more characters)","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":577721,"event":"return","thread_id":9160,"parent_id":577720,"elapsed":0.0005825810367241502,"elapsed_instrumentation":0.00022302696015685797,"return_value":{"class":"Integer","value":"101","object_id":203}},{"id":577722,"event":"return","thread_id":9160,"parent_id":577705,"elapsed":0.008972287003416568,"elapsed_instrumentation":0.00034786801552399993,"return_value":{"class":"String","value":"698b9a10601b8303cc5d34e0dee2df64c37f451f79ed84e3131d1024f0d4cd4c","object_id":3839800}},{"id":577723,"event":"call","thread_id":9160,"defined_class":"ActivityPub::TagManager","method_id":"uri_for","path":"app/lib/activitypub/tag_manager.rb","lineno":36,"static":false,"parameters":[{"name":"target","class":"Account","object_id":3839580,"value":"#<Account:0x00007fc919a79c40>","kind":"req"}],"receiver":{"class":"ActivityPub::TagManager","object_id":325700,"value":"#<ActivityPub::TagManager:0x00007fc937c92608>"}},{"id":577724,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3839580,"value":"#<Account:0x00007fc919a79c40>"}},{"id":577725,"event":"return","thread_id":9160,"parent_id":577724,"elapsed":1.078099012374878e-05,"elapsed_instrumentation":7.5034040492028e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":577726,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"object_type","path":"app/models/account.rb","lineno":385,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3839580,"value":"#<Account:0x00007fc919a79c40>"}},{"id":577727,"event":"return","thread_id":9160,"parent_id":577726,"elapsed":3.0380324460566044e-06,"elapsed_instrumentation":9.296601638197899e-05,"return_value":{"class":"Symbol","value":":person","object_id":20438108}},{"id":577728,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"instance_actor?","path":"app/models/account.rb","lineno":175,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3839580,"value":"#<Account:0x00007fc919a79c40>"}},{"id":577729,"event":"return","thread_id":9160,"parent_id":577728,"elapsed":8.684000931680202e-06,"elapsed_instrumentation":5.316303577274084e-05},{"id":577730,"event":"call","thread_id":9160,"defined_class":"ActivityPub::TagManager","method_id":"default_url_options","path":"app/helpers/routing_helper.rb","lineno":12,"static":false,"parameters":[],"receiver":{"class":"ActivityPub::TagManager","object_id":325700,"value":"#<ActivityPub::TagManager:0x00007fc937c92608>"}},{"id":577731,"event":"return","thread_id":9160,"parent_id":577730,"elapsed":4.4549815356731415e-06,"elapsed_instrumentation":0.00011036609066650271,"return_value":{"class":"Hash","value":"{:host=>cb6e6126.ngrok.io, :protocol=>https://, :trailing_slash=>false}","object_id":325720,"size":3}},{"id":577732,"event":"call","thread_id":9160,"defined_class":"ActivityPub::TagManager","method_id":"default_url_options","path":"app/helpers/routing_helper.rb","lineno":12,"static":false,"parameters":[],"receiver":{"class":"ActivityPub::TagManager","object_id":325700,"value":"#<ActivityPub::TagManager:0x00007fc937c92608>"}},{"id":577733,"event":"return","thread_id":9160,"parent_id":577732,"elapsed":2.6400084607303143e-06,"elapsed_instrumentation":9.523198241367936e-05,"return_value":{"class":"Hash","value":"{:host=>cb6e6126.ngrok.io, :protocol=>https://, :trailing_slash=>false}","object_id":325720,"size":3}},{"id":577734,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"to_param","path":"app/models/account.rb","lineno":389,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3839580,"value":"#<Account:0x00007fc919a79c40>"}},{"id":577735,"event":"return","thread_id":9160,"parent_id":577734,"elapsed":1.6219040844589472e-05,"elapsed_instrumentation":7.394899148494005e-05,"return_value":{"class":"String","value":"Me","object_id":3839840}},{"id":577736,"event":"return","thread_id":9160,"parent_id":577723,"elapsed":0.0009308679727837443,"elapsed_instrumentation":0.00014201801968738437,"return_value":{"class":"String","value":"https://cb6e6126.ngrok.io/users/Me","object_id":3839860}}]}