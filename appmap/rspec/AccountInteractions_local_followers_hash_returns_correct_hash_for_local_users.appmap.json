{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"743782bd299fd54e12a4a5829872efc505132ab3","status":["M .husky/pre-commit","?? sql_warning.txt"],"git_last_annotated_tag":"0.1.2-14597-g743782bd299fd54e12a4a5829872efc505132ab3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"AccountInteractions #local_followers_hash returns correct hash for local users","source_location":"spec/models/concerns/account_interactions_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"models","type":"package","children":[{"name":"concerns","type":"package","children":[{"name":"AccountInteractions","type":"class","children":[{"name":"local_followers_hash","type":"function","location":"app/models/concerns/account_interactions.rb:292","static":false}]}]},{"name":"Account","type":"class","children":[{"name":"local?","type":"function","location":"app/models/account.rb:163","static":false},{"name":"object_type","type":"function","location":"app/models/account.rb:385","static":false},{"name":"instance_actor?","type":"function","location":"app/models/account.rb:175","static":false},{"name":"to_param","type":"function","location":"app/models/account.rb:389","static":false}]}]},{"name":"lib/activitypub","type":"package","children":[{"name":"ActivityPub","type":"class","children":[{"name":"TagManager","type":"class","children":[{"name":"uri_for_username","type":"function","location":"app/lib/activitypub/tag_manager.rb:57","static":false},{"name":"uri_for","type":"function","location":"app/lib/activitypub/tag_manager.rb:36","static":false}]}]}]},{"name":"helpers","type":"package","children":[{"name":"ActivityPub","type":"class","children":[{"name":"TagManager","type":"class","children":[{"name":"default_url_options","type":"function","location":"app/helpers/routing_helper.rb:12","static":false}]}]}]}]},{"name":"logger","type":"package","children":[{"name":"Logger","type":"class","children":[{"name":"LogDevice","type":"class","children":[{"name":"write","type":"function","location":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb:31","static":false,"labels":["log"]}]}]}]},{"name":"lib/active_record","type":"package","children":[{"name":"ActiveRecord","type":"class","children":[{"name":"Batches","type":"class","children":[{"name":"pluck_each","type":"function","location":"lib/active_record/batches.rb:5","static":false}]}]}]},{"name":"ruby","type":"package","children":[{"name":"String","type":"class","children":[{"name":"unpack1","type":"function","location":"<internal:pack>:28","static":false,"labels":["string.unpack"]}]}]}],"events":[{"id":1032691,"event":"call","thread_id":9160,"defined_class":"AccountInteractions","method_id":"local_followers_hash","path":"app/models/concerns/account_interactions.rb","lineno":292,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":5887880,"value":"#<Account:0x00007fdc06f4be08>"}},{"id":1032692,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":5887920,"value":"Cache read: followers_hash:111360495683686643:local ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1032693,"event":"return","thread_id":9160,"parent_id":1032692,"elapsed":0.0014346190146170557,"elapsed_instrumentation":0.0003338699752930552,"return_value":{"class":"Integer","value":"100","object_id":201}},{"id":1032694,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":5887940,"value":"Cache generate: followers_hash:111360495683686643:local ({:compress=>false, :compress_threshold=>102 (...4 more characters)","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1032695,"event":"return","thread_id":9160,"parent_id":1032694,"elapsed":0.0014509669854305685,"elapsed_instrumentation":0.0002889570314437151,"return_value":{"class":"Integer","value":"104","object_id":209}},{"id":1032696,"event":"call","thread_id":9160,"defined_class":"ActiveRecord::Batches","method_id":"pluck_each","path":"lib/active_record/batches.rb","lineno":5,"static":false,"parameters":[{"name":"column_names","class":"Array","object_id":5887960,"value":"[:username]","kind":"rest","size":1}],"receiver":{"class":"ActiveRecord::AssociationRelation","object_id":5887980,"value":"#<Account::ActiveRecord_AssociationRelation:0x00007fdc06f49108>"}},{"id":1032697,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"accounts\".\"id\", \"accounts\".\"username\" FROM \"accounts\" INNER JOIN \"follows\" ON \"accounts\".\"id\" = \"follows\".\"account_id\" WHERE \"follows\".\"target_account_id\" = $1 AND \"accounts\".\"domain\" IS NULL ORDER BY \"accounts\".\"id\" ASC LIMIT $2","database_type":"postgres"}},{"id":1032698,"event":"return","thread_id":9160,"parent_id":1032697,"elapsed":0.001157076,"elapsed_instrumentation":0.00013692598440684378},{"id":1032699,"event":"call","thread_id":9160,"defined_class":"ActivityPub::TagManager","method_id":"uri_for_username","path":"app/lib/activitypub/tag_manager.rb","lineno":57,"static":false,"parameters":[{"name":"username","class":"String","object_id":5888000,"value":"Me","kind":"req"}],"receiver":{"class":"ActivityPub::TagManager","object_id":212080,"value":"#<ActivityPub::TagManager:0x00007fdc0a7306e8>"}},{"id":1032700,"event":"call","thread_id":9160,"defined_class":"ActivityPub::TagManager","method_id":"default_url_options","path":"app/helpers/routing_helper.rb","lineno":12,"static":false,"parameters":[],"receiver":{"class":"ActivityPub::TagManager","object_id":212080,"value":"#<ActivityPub::TagManager:0x00007fdc0a7306e8>"}},{"id":1032701,"event":"return","thread_id":9160,"parent_id":1032700,"elapsed":9.045004844665527e-06,"elapsed_instrumentation":0.00025247098528780043,"return_value":{"class":"Hash","value":"{:host=>cb6e6126.ngrok.io, :protocol=>https://, :trailing_slash=>false}","object_id":212100,"size":3}},{"id":1032702,"event":"return","thread_id":9160,"parent_id":1032699,"elapsed":0.0008934529905673116,"elapsed_instrumentation":0.000524091039551422,"return_value":{"class":"String","value":"https://cb6e6126.ngrok.io/users/Me","object_id":5888020}},{"id":1032703,"event":"return","thread_id":9160,"parent_id":1032696,"elapsed":0.006884642003569752,"elapsed_instrumentation":0.0004561549867503345},{"id":1032704,"event":"call","thread_id":9160,"defined_class":"String","method_id":"unpack1","path":"<internal:pack>","lineno":28,"static":false,"parameters":[{"name":"fmt","class":"String","object_id":5888040,"value":"H*","kind":"req"},{"name":"offset","class":"NilClass","object_id":4,"value":null,"kind":"key"}],"receiver":{"class":"String","object_id":5888060,"value":"i__\u0010`\u001b_\u0003_]4____d_E\u001fy__\u0013\u001d\u0010$___L"}},{"id":1032705,"event":"return","thread_id":9160,"parent_id":1032704,"elapsed":5.765003152191639e-06,"elapsed_instrumentation":0.00014456201461143792,"return_value":{"class":"String","value":"698b9a10601b8303cc5d34e0dee2df64c37f451f79ed84e3131d1024f0d4cd4c","object_id":5888080}},{"id":1032706,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":5888100,"value":"Cache write: followers_hash:111360495683686643:local ({:compress=>false, :compress_threshold=>1024}) (...1 more characters)","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":1032707,"event":"return","thread_id":9160,"parent_id":1032706,"elapsed":0.0012071520031895489,"elapsed_instrumentation":0.00018414400983601809,"return_value":{"class":"Integer","value":"101","object_id":203}},{"id":1032708,"event":"return","thread_id":9160,"parent_id":1032691,"elapsed":0.0160813560069073,"elapsed_instrumentation":0.0002242869813926518,"return_value":{"class":"String","value":"698b9a10601b8303cc5d34e0dee2df64c37f451f79ed84e3131d1024f0d4cd4c","object_id":5888080}},{"id":1032709,"event":"call","thread_id":9160,"defined_class":"ActivityPub::TagManager","method_id":"uri_for","path":"app/lib/activitypub/tag_manager.rb","lineno":36,"static":false,"parameters":[{"name":"target","class":"Account","object_id":5887840,"value":"#<Account:0x00007fdc06de2940>","kind":"req"}],"receiver":{"class":"ActivityPub::TagManager","object_id":212080,"value":"#<ActivityPub::TagManager:0x00007fdc0a7306e8>"}},{"id":1032710,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":5887840,"value":"#<Account:0x00007fdc06de2940>"}},{"id":1032711,"event":"return","thread_id":9160,"parent_id":1032710,"elapsed":1.4071003533899784e-05,"elapsed_instrumentation":7.536698831245303e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1032712,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"object_type","path":"app/models/account.rb","lineno":385,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":5887840,"value":"#<Account:0x00007fdc06de2940>"}},{"id":1032713,"event":"return","thread_id":9160,"parent_id":1032712,"elapsed":2.689979737624526e-06,"elapsed_instrumentation":9.656799375079572e-05,"return_value":{"class":"Symbol","value":":person","object_id":20438108}},{"id":1032714,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"instance_actor?","path":"app/models/account.rb","lineno":175,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":5887840,"value":"#<Account:0x00007fdc06de2940>"}},{"id":1032715,"event":"return","thread_id":9160,"parent_id":1032714,"elapsed":7.933995220810175e-06,"elapsed_instrumentation":5.715899169445038e-05},{"id":1032716,"event":"call","thread_id":9160,"defined_class":"ActivityPub::TagManager","method_id":"default_url_options","path":"app/helpers/routing_helper.rb","lineno":12,"static":false,"parameters":[],"receiver":{"class":"ActivityPub::TagManager","object_id":212080,"value":"#<ActivityPub::TagManager:0x00007fdc0a7306e8>"}},{"id":1032717,"event":"return","thread_id":9160,"parent_id":1032716,"elapsed":7.25302379578352e-06,"elapsed_instrumentation":0.00017881998792290688,"return_value":{"class":"Hash","value":"{:host=>cb6e6126.ngrok.io, :protocol=>https://, :trailing_slash=>false}","object_id":212100,"size":3}},{"id":1032718,"event":"call","thread_id":9160,"defined_class":"ActivityPub::TagManager","method_id":"default_url_options","path":"app/helpers/routing_helper.rb","lineno":12,"static":false,"parameters":[],"receiver":{"class":"ActivityPub::TagManager","object_id":212080,"value":"#<ActivityPub::TagManager:0x00007fdc0a7306e8>"}},{"id":1032719,"event":"return","thread_id":9160,"parent_id":1032718,"elapsed":5.754001904278994e-06,"elapsed_instrumentation":0.00017052298062480986,"return_value":{"class":"Hash","value":"{:host=>cb6e6126.ngrok.io, :protocol=>https://, :trailing_slash=>false}","object_id":212100,"size":3}},{"id":1032720,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"to_param","path":"app/models/account.rb","lineno":389,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":5887840,"value":"#<Account:0x00007fdc06de2940>"}},{"id":1032721,"event":"return","thread_id":9160,"parent_id":1032720,"elapsed":2.3216998670250177e-05,"elapsed_instrumentation":0.00011885500862263143,"return_value":{"class":"String","value":"Me","object_id":5888120}},{"id":1032722,"event":"return","thread_id":9160,"parent_id":1032709,"elapsed":0.001286791986785829,"elapsed_instrumentation":0.00024576601572334766,"return_value":{"class":"String","value":"https://cb6e6126.ngrok.io/users/Me","object_id":5888140}}]}