{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"743782bd299fd54e12a4a5829872efc505132ab3","status":["M .husky/pre-commit","?? sql_warning.txt"],"git_last_annotated_tag":"0.1.2-14597-g743782bd299fd54e12a4a5829872efc505132ab3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"User .those_who_can when there are users with roles returns the users with the role","source_location":"spec/models/user_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app/models","type":"package","children":[{"name":"User","type":"class","children":[{"name":"those_who_can","type":"function","location":"app/models/user.rb:143","static":true}]},{"name":"UserRole","type":"class","children":[{"name":"that_can","type":"function","location":"app/models/user_role.rb:111","static":true},{"name":"can?","type":"function","location":"app/models/user_role.rb:131","static":false},{"name":"computed_permissions","type":"function","location":"app/models/user_role.rb:139","static":false},{"name":"everyone?","type":"function","location":"app/models/user_role.rb:115","static":false},{"name":"nobody?","type":"function","location":"app/models/user_role.rb:119","static":false},{"name":"everyone","type":"function","location":"app/models/user_role.rb:105","static":true}]}]}],"events":[{"id":1424271,"event":"call","thread_id":9160,"defined_class":"User","method_id":"those_who_can","path":"app/models/user.rb","lineno":143,"static":true,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7652460,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"Class","object_id":35120,"value":"User"}},{"id":1424272,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"that_can","path":"app/models/user_role.rb","lineno":111,"static":true,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7652480,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1424273,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\"","database_type":"postgres"}},{"id":1424274,"event":"return","thread_id":9160,"parent_id":1424273,"elapsed":0.000829599,"elapsed_instrumentation":0.0007380960159935057},{"id":1424275,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7652500,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7652520,"value":"#<UserRole:0x00007fdbf64935c0>"}},{"id":1424276,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652520,"value":"#<UserRole:0x00007fdbf64935c0>"}},{"id":1424277,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652520,"value":"#<UserRole:0x00007fdbf64935c0>"}},{"id":1424278,"event":"return","thread_id":9160,"parent_id":1424277,"elapsed":1.8001010175794363e-05,"elapsed_instrumentation":6.865599425509572e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1424279,"event":"return","thread_id":9160,"parent_id":1424276,"elapsed":0.00011086600716225803,"elapsed_instrumentation":6.920099258422852e-05,"return_value":{"class":"Integer","value":"65536","object_id":131073}},{"id":1424280,"event":"return","thread_id":9160,"parent_id":1424275,"elapsed":0.00020354700973257422,"elapsed_instrumentation":0.00013185697025619447},{"id":1424281,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7652540,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7652560,"value":"#<UserRole:0x00007fdbf6493480>"}},{"id":1424282,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652560,"value":"#<UserRole:0x00007fdbf6493480>"}},{"id":1424283,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652560,"value":"#<UserRole:0x00007fdbf6493480>"}},{"id":1424284,"event":"return","thread_id":9160,"parent_id":1424283,"elapsed":1.7615006072446704e-05,"elapsed_instrumentation":8.930600597523153e-05},{"id":1424285,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"nobody?","path":"app/models/user_role.rb","lineno":119,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652560,"value":"#<UserRole:0x00007fdbf6493480>"}},{"id":1424286,"event":"return","thread_id":9160,"parent_id":1424285,"elapsed":7.170019671320915e-06,"elapsed_instrumentation":7.576699135825038e-05},{"id":1424287,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone","path":"app/models/user_role.rb","lineno":105,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1424288,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2","database_type":"postgres"}},{"id":1424289,"event":"return","thread_id":9160,"parent_id":1424288,"elapsed":0.000987754,"elapsed_instrumentation":0.0002116830146405846},{"id":1424290,"event":"return","thread_id":9160,"parent_id":1424287,"elapsed":0.0023391300055664033,"elapsed_instrumentation":0.00016278799739666283,"return_value":{"class":"UserRole","value":"#<UserRole:0x00007fdbf6492f80>","object_id":7652580}},{"id":1424291,"event":"return","thread_id":9160,"parent_id":1424282,"elapsed":0.0029081800021231174,"elapsed_instrumentation":0.0001064020034391433,"return_value":{"class":"Integer","value":"66844","object_id":133689}},{"id":1424292,"event":"return","thread_id":9160,"parent_id":1424281,"elapsed":0.0030465470044873655,"elapsed_instrumentation":0.0001685120223555714},{"id":1424293,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7652600,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7652620,"value":"#<UserRole:0x00007fdbf6493340>"}},{"id":1424294,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652620,"value":"#<UserRole:0x00007fdbf6493340>"}},{"id":1424295,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652620,"value":"#<UserRole:0x00007fdbf6493340>"}},{"id":1424296,"event":"return","thread_id":9160,"parent_id":1424295,"elapsed":1.0868010576814413e-05,"elapsed_instrumentation":5.0255999667569995e-05},{"id":1424297,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"nobody?","path":"app/models/user_role.rb","lineno":119,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652620,"value":"#<UserRole:0x00007fdbf6493340>"}},{"id":1424298,"event":"return","thread_id":9160,"parent_id":1424297,"elapsed":4.756002454087138e-06,"elapsed_instrumentation":4.898500628769398e-05},{"id":1424299,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone","path":"app/models/user_role.rb","lineno":105,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1424300,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2","database_type":"postgres"}},{"id":1424301,"event":"return","thread_id":9160,"parent_id":1424300,"elapsed":0.000528336,"elapsed_instrumentation":0.00011555798118934035},{"id":1424302,"event":"return","thread_id":9160,"parent_id":1424299,"elapsed":0.0019478670146781951,"elapsed_instrumentation":0.00011114997323602438,"return_value":{"class":"UserRole","value":"#<UserRole:0x00007fdbf6492d00>","object_id":7652640}},{"id":1424303,"event":"return","thread_id":9160,"parent_id":1424294,"elapsed":0.002236719010397792,"elapsed_instrumentation":7.117702625691891e-05,"return_value":{"class":"Integer","value":"1048572","object_id":2097145}},{"id":1424304,"event":"return","thread_id":9160,"parent_id":1424293,"elapsed":0.0023302620102185756,"elapsed_instrumentation":0.00013507500989362597,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1424305,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7652660,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7652680,"value":"#<UserRole:0x00007fdbf6493200>"}},{"id":1424306,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652680,"value":"#<UserRole:0x00007fdbf6493200>"}},{"id":1424307,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652680,"value":"#<UserRole:0x00007fdbf6493200>"}},{"id":1424308,"event":"return","thread_id":9160,"parent_id":1424307,"elapsed":1.750900992192328e-05,"elapsed_instrumentation":0.00012297500506974757},{"id":1424309,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"nobody?","path":"app/models/user_role.rb","lineno":119,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7652680,"value":"#<UserRole:0x00007fdbf6493200>"}},{"id":1424310,"event":"return","thread_id":9160,"parent_id":1424309,"elapsed":7.758004358038306e-06,"elapsed_instrumentation":0.0001153170014731586},{"id":1424311,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone","path":"app/models/user_role.rb","lineno":105,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1424312,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2","database_type":"postgres"}},{"id":1424313,"event":"return","thread_id":9160,"parent_id":1424312,"elapsed":0.000732791,"elapsed_instrumentation":8.221800089813769e-05},{"id":1424314,"event":"return","thread_id":9160,"parent_id":1424311,"elapsed":0.0016942069923970848,"elapsed_instrumentation":0.00011950201587751508,"return_value":{"class":"UserRole","value":"#<UserRole:0x00007fdbf6492a80>","object_id":7652700}},{"id":1424315,"event":"return","thread_id":9160,"parent_id":1424306,"elapsed":0.0022204169945325702,"elapsed_instrumentation":0.00027753101312555373,"return_value":{"class":"Integer","value":"1048575","object_id":2097151}},{"id":1424316,"event":"return","thread_id":9160,"parent_id":1424305,"elapsed":0.002524991985410452,"elapsed_instrumentation":0.00011414900654926896,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1424317,"event":"return","thread_id":9160,"parent_id":1424272,"elapsed":0.011301508988253772,"elapsed_instrumentation":0.00040737001108936965,"return_value":{"class":"Array","value":"[#<UserRole:0x00007fdbf6493340>, #<UserRole:0x00007fdbf6493200>]","object_id":7652720,"size":2}},{"id":1424318,"event":"return","thread_id":9160,"parent_id":1424271,"elapsed":0.01202761399326846,"elapsed_instrumentation":0.00027086801128461957,"return_value":{"class":"ActiveRecord::Relation","value":"#<User::ActiveRecord_Relation:0x00007fdbf66dd218>","object_id":7652740}},{"id":1424319,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"users\".\"id\", \"users\".\"email\", \"users\".\"created_at\", \"users\".\"updated_at\", \"users\".\"encrypted_password\", \"users\".\"reset_password_token\", \"users\".\"reset_password_sent_at\", \"users\".\"sign_in_count\", \"users\".\"current_sign_in_at\", \"users\".\"last_sign_in_at\", \"users\".\"admin\", \"users\".\"confirmation_token\", \"users\".\"confirmed_at\", \"users\".\"confirmation_sent_at\", \"users\".\"unconfirmed_email\", \"users\".\"locale\", \"users\".\"encrypted_otp_secret\", \"users\".\"encrypted_otp_secret_iv\", \"users\".\"encrypted_otp_secret_salt\", \"users\".\"consumed_timestep\", \"users\".\"otp_required_for_login\", \"users\".\"last_emailed_at\", \"users\".\"otp_backup_codes\", \"users\".\"account_id\", \"users\".\"disabled\", \"users\".\"moderator\", \"users\".\"invite_id\", \"users\".\"chosen_languages\", \"users\".\"created_by_application_id\", \"users\".\"approved\", \"users\".\"sign_in_token\", \"users\".\"sign_in_token_sent_at\", \"users\".\"webauthn_id\", \"users\".\"sign_up_ip\", \"users\".\"role_id\", \"users\".\"settings\", \"users\".\"time_zone\" FROM \"users\" WHERE \"users\".\"role_id\" IN ($1, $2)","database_type":"postgres"}},{"id":1424320,"event":"return","thread_id":9160,"parent_id":1424319,"elapsed":0.001175366,"elapsed_instrumentation":8.268302190117538e-05}]}