{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","status":["M .husky/pre-commit"],"git_last_annotated_tag":"0.1.2-14608-g2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"User .those_who_can when there are users with roles returns the users with the role","source_location":"spec/models/user_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app/models","type":"package","children":[{"name":"User","type":"class","children":[{"name":"those_who_can","type":"function","location":"app/models/user.rb:143","static":true}]},{"name":"UserRole","type":"class","children":[{"name":"that_can","type":"function","location":"app/models/user_role.rb:111","static":true},{"name":"can?","type":"function","location":"app/models/user_role.rb:131","static":false},{"name":"computed_permissions","type":"function","location":"app/models/user_role.rb:139","static":false},{"name":"everyone?","type":"function","location":"app/models/user_role.rb:115","static":false},{"name":"nobody?","type":"function","location":"app/models/user_role.rb:119","static":false},{"name":"everyone","type":"function","location":"app/models/user_role.rb:105","static":true}]}]}],"events":[{"id":1348362,"event":"call","thread_id":9160,"defined_class":"User","method_id":"those_who_can","path":"app/models/user.rb","lineno":143,"static":true,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702480,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"Class","object_id":35120,"value":"User"}},{"id":1348363,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"that_can","path":"app/models/user_role.rb","lineno":111,"static":true,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702500,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1348364,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\"","database_type":"postgres"}},{"id":1348365,"event":"return","thread_id":9160,"parent_id":1348364,"elapsed":0.000507868,"elapsed_instrumentation":0.00010131701128557324},{"id":1348366,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702520,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7702540,"value":"#<UserRole:0x00007fc91a3b3ae0>"}},{"id":1348367,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702540,"value":"#<UserRole:0x00007fc91a3b3ae0>"}},{"id":1348368,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702540,"value":"#<UserRole:0x00007fc91a3b3ae0>"}},{"id":1348369,"event":"return","thread_id":9160,"parent_id":1348368,"elapsed":3.731600008904934e-05,"elapsed_instrumentation":8.816499030217528e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1348370,"event":"return","thread_id":9160,"parent_id":1348367,"elapsed":0.00015434902161359787,"elapsed_instrumentation":7.155101047828794e-05,"return_value":{"class":"Integer","value":"65536","object_id":131073}},{"id":1348371,"event":"return","thread_id":9160,"parent_id":1348366,"elapsed":0.0002505239681340754,"elapsed_instrumentation":0.00013878196477890015},{"id":1348372,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702560,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7702580,"value":"#<UserRole:0x00007fc91a3b39a0>"}},{"id":1348373,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702580,"value":"#<UserRole:0x00007fc91a3b39a0>"}},{"id":1348374,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702580,"value":"#<UserRole:0x00007fc91a3b39a0>"}},{"id":1348375,"event":"return","thread_id":9160,"parent_id":1348374,"elapsed":9.749026503413916e-06,"elapsed_instrumentation":5.0615984946489334e-05},{"id":1348376,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"nobody?","path":"app/models/user_role.rb","lineno":119,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702580,"value":"#<UserRole:0x00007fc91a3b39a0>"}},{"id":1348377,"event":"return","thread_id":9160,"parent_id":1348376,"elapsed":9.124982170760632e-06,"elapsed_instrumentation":0.0002404690021649003},{"id":1348378,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone","path":"app/models/user_role.rb","lineno":105,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1348379,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2","database_type":"postgres"}},{"id":1348380,"event":"return","thread_id":9160,"parent_id":1348379,"elapsed":0.000446926,"elapsed_instrumentation":0.0002516069798730314},{"id":1348381,"event":"return","thread_id":9160,"parent_id":1348378,"elapsed":0.0013426500372588634,"elapsed_instrumentation":0.00013183202827349305,"return_value":{"class":"UserRole","value":"#<UserRole:0x00007fc91a3b3360>","object_id":7702600}},{"id":1348382,"event":"return","thread_id":9160,"parent_id":1348373,"elapsed":0.0018600010080263019,"elapsed_instrumentation":8.733803406357765e-05,"return_value":{"class":"Integer","value":"66844","object_id":133689}},{"id":1348383,"event":"return","thread_id":9160,"parent_id":1348372,"elapsed":0.001988109026569873,"elapsed_instrumentation":0.00012589897960424423},{"id":1348384,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702620,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7702640,"value":"#<UserRole:0x00007fc91a3b3720>"}},{"id":1348385,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702640,"value":"#<UserRole:0x00007fc91a3b3720>"}},{"id":1348386,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702640,"value":"#<UserRole:0x00007fc91a3b3720>"}},{"id":1348387,"event":"return","thread_id":9160,"parent_id":1348386,"elapsed":9.606999810785055e-06,"elapsed_instrumentation":5.0366041250526905e-05},{"id":1348388,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"nobody?","path":"app/models/user_role.rb","lineno":119,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702640,"value":"#<UserRole:0x00007fc91a3b3720>"}},{"id":1348389,"event":"return","thread_id":9160,"parent_id":1348388,"elapsed":7.855996955186129e-06,"elapsed_instrumentation":9.690906153991818e-05},{"id":1348390,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone","path":"app/models/user_role.rb","lineno":105,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1348391,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2","database_type":"postgres"}},{"id":1348392,"event":"return","thread_id":9160,"parent_id":1348391,"elapsed":0.000402373,"elapsed_instrumentation":0.0002477910020388663},{"id":1348393,"event":"return","thread_id":9160,"parent_id":1348390,"elapsed":0.0012265439727343619,"elapsed_instrumentation":0.00011632498353719711,"return_value":{"class":"UserRole","value":"#<UserRole:0x00007fc91a3b2fa0>","object_id":7702660}},{"id":1348394,"event":"return","thread_id":9160,"parent_id":1348385,"elapsed":0.0016677569947205484,"elapsed_instrumentation":6.46929838694632e-05,"return_value":{"class":"Integer","value":"1048572","object_id":2097145}},{"id":1348395,"event":"return","thread_id":9160,"parent_id":1348384,"elapsed":0.0017540489789098501,"elapsed_instrumentation":0.00011165603064000607,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1348396,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"can?","path":"app/models/user_role.rb","lineno":131,"static":false,"parameters":[{"name":"any_of_privileges","class":"Array","object_id":7702680,"value":"[:manage_blocks]","kind":"rest","size":1}],"receiver":{"class":"UserRole","object_id":7702700,"value":"#<UserRole:0x00007fc91a3b35e0>"}},{"id":1348397,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"computed_permissions","path":"app/models/user_role.rb","lineno":139,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702700,"value":"#<UserRole:0x00007fc91a3b35e0>"}},{"id":1348398,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone?","path":"app/models/user_role.rb","lineno":115,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702700,"value":"#<UserRole:0x00007fc91a3b35e0>"}},{"id":1348399,"event":"return","thread_id":9160,"parent_id":1348398,"elapsed":8.785980753600597e-06,"elapsed_instrumentation":4.829699173569679e-05},{"id":1348400,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"nobody?","path":"app/models/user_role.rb","lineno":119,"static":false,"parameters":[],"receiver":{"class":"UserRole","object_id":7702700,"value":"#<UserRole:0x00007fc91a3b35e0>"}},{"id":1348401,"event":"return","thread_id":9160,"parent_id":1348400,"elapsed":5.0120288506150246e-06,"elapsed_instrumentation":4.922901280224323e-05},{"id":1348402,"event":"call","thread_id":9160,"defined_class":"UserRole","method_id":"everyone","path":"app/models/user_role.rb","lineno":105,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":62120,"value":"UserRole"}},{"id":1348403,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2","database_type":"postgres"}},{"id":1348404,"event":"return","thread_id":9160,"parent_id":1348403,"elapsed":0.000373003,"elapsed_instrumentation":8.066702866926789e-05},{"id":1348405,"event":"return","thread_id":9160,"parent_id":1348402,"elapsed":0.0016109169810079038,"elapsed_instrumentation":0.00023524201242253184,"return_value":{"class":"UserRole","value":"#<UserRole:0x00007fc91a3b2d20>","object_id":7702720}},{"id":1348406,"event":"return","thread_id":9160,"parent_id":1348397,"elapsed":0.002024889981839806,"elapsed_instrumentation":6.757205119356513e-05,"return_value":{"class":"Integer","value":"1048575","object_id":2097151}},{"id":1348407,"event":"return","thread_id":9160,"parent_id":1348396,"elapsed":0.0021147759980522096,"elapsed_instrumentation":0.00010875600855797529,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":1348408,"event":"return","thread_id":9160,"parent_id":1348363,"elapsed":0.008214969013351947,"elapsed_instrumentation":0.00013767497148364782,"return_value":{"class":"Array","value":"[#<UserRole:0x00007fc91a3b3720>, #<UserRole:0x00007fc91a3b35e0>]","object_id":7702740,"size":2}},{"id":1348409,"event":"return","thread_id":9160,"parent_id":1348362,"elapsed":0.008907089999411255,"elapsed_instrumentation":0.00024037098046392202,"return_value":{"class":"ActiveRecord::Relation","value":"#<User::ActiveRecord_Relation:0x00007fc919b158c0>","object_id":7702760}},{"id":1348410,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"users\".\"id\", \"users\".\"email\", \"users\".\"created_at\", \"users\".\"updated_at\", \"users\".\"encrypted_password\", \"users\".\"reset_password_token\", \"users\".\"reset_password_sent_at\", \"users\".\"sign_in_count\", \"users\".\"current_sign_in_at\", \"users\".\"last_sign_in_at\", \"users\".\"admin\", \"users\".\"confirmation_token\", \"users\".\"confirmed_at\", \"users\".\"confirmation_sent_at\", \"users\".\"unconfirmed_email\", \"users\".\"locale\", \"users\".\"encrypted_otp_secret\", \"users\".\"encrypted_otp_secret_iv\", \"users\".\"encrypted_otp_secret_salt\", \"users\".\"consumed_timestep\", \"users\".\"otp_required_for_login\", \"users\".\"last_emailed_at\", \"users\".\"otp_backup_codes\", \"users\".\"account_id\", \"users\".\"disabled\", \"users\".\"moderator\", \"users\".\"invite_id\", \"users\".\"chosen_languages\", \"users\".\"created_by_application_id\", \"users\".\"approved\", \"users\".\"sign_in_token\", \"users\".\"sign_in_token_sent_at\", \"users\".\"webauthn_id\", \"users\".\"sign_up_ip\", \"users\".\"role_id\", \"users\".\"settings\", \"users\".\"time_zone\" FROM \"users\" WHERE \"users\".\"role_id\" IN ($1, $2)","database_type":"postgres"}},{"id":1348411,"event":"return","thread_id":9160,"parent_id":1348410,"elapsed":0.001035453,"elapsed_instrumentation":0.00010989297879859805}]}