{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"743782bd299fd54e12a4a5829872efc505132ab3","status":["M .husky/pre-commit","?? sql_warning.txt"],"git_last_annotated_tag":"0.1.2-14597-g743782bd299fd54e12a4a5829872efc505132ab3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Mastodon::CLI::IpBlocks #export when --format option is set to \"nginx\" does not export bloked IPs with different severities","source_location":"spec/lib/mastodon/cli/ip_blocks_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"activesupport","type":"package","children":[{"name":"ActiveSupport","type":"class","children":[{"name":"Callbacks","type":"class","children":[{"name":"CallbackSequence","type":"class","children":[{"name":"invoke_before","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:597","static":false,"labels":["mvc.before_action"]},{"name":"invoke_after","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:601","static":false,"labels":["mvc.after_action"]}]}]}]}]},{"name":"logger","type":"package","children":[{"name":"Logger","type":"class","children":[{"name":"LogDevice","type":"class","children":[{"name":"write","type":"function","location":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb:31","static":false,"labels":["log"]}]}]}]},{"name":"lib/mastodon/cli","type":"package","children":[{"name":"Mastodon","type":"class","children":[{"name":"CLI","type":"class","children":[{"name":"IpBlocks","type":"class","children":[{"name":"export","type":"function","location":"lib/mastodon/cli/ip_blocks.rb:113","static":false}]}]}]}]}],"events":[{"id":836137,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5109840,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":218200,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0e23d088>"}},{"id":836138,"event":"return","thread_id":9160,"parent_id":836137,"elapsed":2.5765999453142285e-05,"elapsed_instrumentation":0.00043386800098232925,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0a1a2168 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":218220,"size":1}},{"id":836139,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5109860,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":5084860,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09affab8>"}},{"id":836140,"event":"call","thread_id":9160,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres"}},{"id":836141,"event":"return","thread_id":9160,"parent_id":836140,"elapsed":0.000774708,"elapsed_instrumentation":0.00015857300604693592},{"id":836142,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT 1 AS one FROM \"ip_blocks\" WHERE \"ip_blocks\".\"ip\" = $1 LIMIT $2","database_type":"postgres"}},{"id":836143,"event":"return","thread_id":9160,"parent_id":836142,"elapsed":0.002338939,"elapsed_instrumentation":0.00011890201130881906},{"id":836144,"event":"return","thread_id":9160,"parent_id":836139,"elapsed":0.003937845001928508,"elapsed_instrumentation":0.00025422999169677496,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0dca16b0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0dca2ba0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0dca3550 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":5084880,"size":3}},{"id":836145,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5109860,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":5084860,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09affab8>"}},{"id":836146,"event":"return","thread_id":9160,"parent_id":836145,"elapsed":5.557987606152892e-06,"elapsed_instrumentation":0.0009586930100340396,"return_value":{"class":"Array","value":"[]","object_id":5084900,"size":0}},{"id":836147,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5109840,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":218200,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0e23d088>"}},{"id":836148,"event":"return","thread_id":9160,"parent_id":836147,"elapsed":4.672008799389005e-06,"elapsed_instrumentation":0.00013179198140278459,"return_value":{"class":"Array","value":"[]","object_id":218320,"size":0}},{"id":836149,"event":"call","thread_id":9160,"sql_query":{"sql":"INSERT INTO \"ip_blocks\" (\"created_at\", \"updated_at\", \"expires_at\", \"ip\", \"severity\", \"comment\") VALUES ($1, $2, $3, $4, $5, $6) RETURNING \"id\"","database_type":"postgres"}},{"id":836150,"event":"return","thread_id":9160,"parent_id":836149,"elapsed":0.001543801,"elapsed_instrumentation":0.00014493500930257142},{"id":836151,"event":"call","thread_id":9160,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres"}},{"id":836152,"event":"return","thread_id":9160,"parent_id":836151,"elapsed":0.000902033,"elapsed_instrumentation":0.0003390649799257517},{"id":836153,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5109900,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":5084940,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09afeb18>"}},{"id":836154,"event":"return","thread_id":9160,"parent_id":836153,"elapsed":4.784989869222045e-06,"elapsed_instrumentation":0.00019985000835731626,"return_value":{"class":"Array","value":"[]","object_id":5084960,"size":0}},{"id":836155,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5109900,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":5084940,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09afeb18>"}},{"id":836156,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":5109920,"value":"Cache delete: blocked_ips\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":836157,"event":"return","thread_id":9160,"parent_id":836156,"elapsed":0.0011709420068655163,"elapsed_instrumentation":0.00040482101030647755,"return_value":{"class":"Integer","value":"26","object_id":53}},{"id":836158,"event":"return","thread_id":9160,"parent_id":836155,"elapsed":0.0017566659953445196,"elapsed_instrumentation":0.00013752098311670125,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0dd15ce0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":5085000,"size":1}},{"id":836159,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5109940,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":218200,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0e23d088>"}},{"id":836160,"event":"return","thread_id":9160,"parent_id":836159,"elapsed":3.057401045225561e-05,"elapsed_instrumentation":0.0003756869991775602,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0a1a2168 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":218220,"size":1}},{"id":836161,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5109960,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":5084860,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09affab8>"}},{"id":836162,"event":"call","thread_id":9160,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres"}},{"id":836163,"event":"return","thread_id":9160,"parent_id":836162,"elapsed":0.000634436,"elapsed_instrumentation":9.972101543098688e-05},{"id":836164,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT 1 AS one FROM \"ip_blocks\" WHERE \"ip_blocks\".\"ip\" = $1 LIMIT $2","database_type":"postgres"}},{"id":836165,"event":"return","thread_id":9160,"parent_id":836164,"elapsed":0.001899635,"elapsed_instrumentation":7.829500827938318e-05},{"id":836166,"event":"return","thread_id":9160,"parent_id":836161,"elapsed":0.0033151860116049647,"elapsed_instrumentation":0.00026888897991739213,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0dca16b0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0dca2ba0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0dca3550 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":5084880,"size":3}},{"id":836167,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5109960,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":5084860,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09affab8>"}},{"id":836168,"event":"return","thread_id":9160,"parent_id":836167,"elapsed":3.4789845813065767e-06,"elapsed_instrumentation":0.00011059202370233834,"return_value":{"class":"Array","value":"[]","object_id":5084900,"size":0}},{"id":836169,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5109940,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":218200,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0e23d088>"}},{"id":836170,"event":"return","thread_id":9160,"parent_id":836169,"elapsed":3.403984010219574e-06,"elapsed_instrumentation":0.00032962701516225934,"return_value":{"class":"Array","value":"[]","object_id":218320,"size":0}},{"id":836171,"event":"call","thread_id":9160,"sql_query":{"sql":"INSERT INTO \"ip_blocks\" (\"created_at\", \"updated_at\", \"expires_at\", \"ip\", \"severity\", \"comment\") VALUES ($1, $2, $3, $4, $5, $6) RETURNING \"id\"","database_type":"postgres"}},{"id":836172,"event":"return","thread_id":9160,"parent_id":836171,"elapsed":0.000933786,"elapsed_instrumentation":8.033402264118195e-05},{"id":836173,"event":"call","thread_id":9160,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres"}},{"id":836174,"event":"return","thread_id":9160,"parent_id":836173,"elapsed":0.000582821,"elapsed_instrumentation":7.29209859855473e-05},{"id":836175,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5110000,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":5084940,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09afeb18>"}},{"id":836176,"event":"return","thread_id":9160,"parent_id":836175,"elapsed":3.3879769034683704e-06,"elapsed_instrumentation":0.00012058301945216954,"return_value":{"class":"Array","value":"[]","object_id":5084960,"size":0}},{"id":836177,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":5110000,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":5084940,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09afeb18>"}},{"id":836178,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":5110020,"value":"Cache delete: blocked_ips\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fdc1b4b7180>"}},{"id":836179,"event":"return","thread_id":9160,"parent_id":836178,"elapsed":0.0010205720027443022,"elapsed_instrumentation":0.0003543079656083137,"return_value":{"class":"Integer","value":"26","object_id":53}},{"id":836180,"event":"return","thread_id":9160,"parent_id":836177,"elapsed":0.001551002002088353,"elapsed_instrumentation":0.00012266499106772244,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0dd15ce0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":5085000,"size":1}},{"id":836181,"event":"call","thread_id":9160,"defined_class":"Mastodon::CLI::IpBlocks","method_id":"export","path":"lib/mastodon/cli/ip_blocks.rb","lineno":113,"static":false,"parameters":[],"receiver":{"class":"Mastodon::CLI::IpBlocks","object_id":5110040,"value":"#<Mastodon::CLI::IpBlocks:0x00007fdc09528b30>"}},{"id":836182,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"ip_blocks\".* FROM \"ip_blocks\" WHERE \"ip_blocks\".\"severity\" = $1 ORDER BY \"ip_blocks\".\"id\" ASC LIMIT $2","database_type":"postgres"}},{"id":836183,"event":"return","thread_id":9160,"parent_id":836182,"elapsed":0.000705809,"elapsed_instrumentation":8.283599163405597e-05},{"id":836184,"event":"return","thread_id":9160,"parent_id":836181,"elapsed":0.0031263820128515363,"elapsed_instrumentation":0.00012070301454514265}]}