{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","status":["M .husky/pre-commit"],"git_last_annotated_tag":"0.1.2-14608-g2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"StatusReachFinder #inboxes with a local status when it has been favourited by a remote account includes the inbox of the favouriter","source_location":"spec/lib/status_reach_finder_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"lib","type":"package","children":[{"name":"StatusReachFinder","type":"class","children":[{"name":"inboxes","type":"function","location":"app/lib/status_reach_finder.rb:12","static":false}]},{"name":"DeliveryFailureTracker","type":"class","children":[{"name":"without_unavailable","type":"function","location":"app/lib/delivery_failure_tracker.rb:43","static":true}]}]},{"name":"models","type":"package","children":[{"name":"Status","type":"class","children":[{"name":"reblog?","type":"function","location":"app/models/status.rb:196","static":false},{"name":"in_reply_to_local_account?","type":"function","location":"app/models/status.rb:192","static":false},{"name":"reply?","type":"function","location":"app/models/status.rb:184","static":false}]},{"name":"Account","type":"class","children":[{"name":"inboxes","type":"function","location":"app/models/account.rb:436","static":true}]}]}]},{"name":"logger","type":"package","children":[{"name":"Logger","type":"class","children":[{"name":"LogDevice","type":"class","children":[{"name":"write","type":"function","location":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb:31","static":false,"labels":["log"]}]}]}]},{"name":"ruby","type":"package","children":[{"name":"Marshal","type":"class","children":[{"name":"dump","type":"function","location":"Marshal.dump","static":true,"labels":["serialize"]},{"name":"load","type":"function","location":"<internal:marshal>:33","static":true,"labels":["deserialize.unsafe"]}]}]}],"events":[{"id":1582884,"event":"call","thread_id":9160,"defined_class":"StatusReachFinder","method_id":"inboxes","path":"app/lib/status_reach_finder.rb","lineno":12,"static":false,"parameters":[],"receiver":{"class":"StatusReachFinder","object_id":8608320,"value":"#<StatusReachFinder:0x00007fc8e2957a10>"}},{"id":1582885,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"reblog?","path":"app/models/status.rb","lineno":196,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":8608240,"value":"#<Status:0x00007fc8e2a48c30>"}},{"id":1582886,"event":"return","thread_id":9160,"parent_id":1582885,"elapsed":5.438498919829726e-05,"elapsed_instrumentation":9.421497816219926e-05},{"id":1582887,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"reblog?","path":"app/models/status.rb","lineno":196,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":8608240,"value":"#<Status:0x00007fc8e2a48c30>"}},{"id":1582888,"event":"return","thread_id":9160,"parent_id":1582887,"elapsed":1.0516028851270676e-05,"elapsed_instrumentation":0.00017645797925069928},{"id":1582889,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"mentions\".\"account_id\" FROM \"mentions\" WHERE \"mentions\".\"status_id\" = $1","database_type":"postgres"}},{"id":1582890,"event":"return","thread_id":9160,"parent_id":1582889,"elapsed":0.000870402,"elapsed_instrumentation":0.00010552298044785857},{"id":1582891,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"statuses\".\"account_id\" FROM \"statuses\" WHERE \"statuses\".\"reblog_of_id\" = $1 AND \"statuses\".\"deleted_at\" IS NULL ORDER BY \"statuses\".\"id\" DESC","database_type":"postgres"}},{"id":1582892,"event":"return","thread_id":9160,"parent_id":1582891,"elapsed":0.001022901,"elapsed_instrumentation":0.0003333970089443028},{"id":1582893,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"favourites\".\"account_id\" FROM \"favourites\" WHERE \"favourites\".\"status_id\" = $1","database_type":"postgres"}},{"id":1582894,"event":"return","thread_id":9160,"parent_id":1582893,"elapsed":0.000722811,"elapsed_instrumentation":0.0002346509718336165},{"id":1582895,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"statuses\".\"account_id\" FROM \"statuses\" WHERE \"statuses\".\"deleted_at\" IS NULL AND \"statuses\".\"in_reply_to_id\" = $1 ORDER BY \"statuses\".\"id\" DESC","database_type":"postgres"}},{"id":1582896,"event":"return","thread_id":9160,"parent_id":1582895,"elapsed":0.000828706,"elapsed_instrumentation":0.00011397100752219558},{"id":1582897,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"inboxes","path":"app/models/account.rb","lineno":436,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":36600,"value":"Account"}},{"id":1582898,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT coalesce(nullif(accounts.shared_inbox_url, ''), accounts.inbox_url) AS preferred_inbox_url FROM \"accounts\" WHERE \"accounts\".\"id\" = $1 AND \"accounts\".\"protocol\" = $2 GROUP BY \"preferred_inbox_url\"","database_type":"postgres"}},{"id":1582899,"event":"return","thread_id":9160,"parent_id":1582898,"elapsed":0.000919042,"elapsed_instrumentation":0.00010232598287984729},{"id":1582900,"event":"call","thread_id":9160,"defined_class":"DeliveryFailureTracker","method_id":"without_unavailable","path":"app/lib/delivery_failure_tracker.rb","lineno":43,"static":true,"parameters":[{"name":"urls","class":"Array","object_id":8608340,"value":"[https://foo.bar/inbox]","kind":"req","size":1}],"receiver":{"class":"Class","object_id":52940,"value":"DeliveryFailureTracker"}},{"id":1582901,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":8608360,"value":"Cache read: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":1582902,"event":"return","thread_id":9160,"parent_id":1582901,"elapsed":0.000700375996530056,"elapsed_instrumentation":0.00014986004680395126,"return_value":{"class":"Integer","value":"80","object_id":161}},{"id":1582903,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":8608380,"value":"Cache generate: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":1582904,"event":"return","thread_id":9160,"parent_id":1582903,"elapsed":0.0009890919900499284,"elapsed_instrumentation":0.00016474799485877156,"return_value":{"class":"Integer","value":"84","object_id":169}},{"id":1582905,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"unavailable_domains\".\"domain\" FROM \"unavailable_domains\"","database_type":"postgres"}},{"id":1582906,"event":"return","thread_id":9160,"parent_id":1582905,"elapsed":0.000969316,"elapsed_instrumentation":0.00011820299550890923},{"id":1582907,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":8608400,"value":"Cache write: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":1582908,"event":"return","thread_id":9160,"parent_id":1582907,"elapsed":0.0011123389704152942,"elapsed_instrumentation":0.0005552120273932815,"return_value":{"class":"Integer","value":"81","object_id":163}},{"id":1582909,"event":"call","thread_id":9160,"defined_class":"Marshal","method_id":"dump","path":"Marshal.dump","static":true,"parameters":[{"name":"arg","class":"Array","object_id":8608420,"value":"[{}]","kind":"rest","size":1}],"receiver":{"class":"Module","object_id":318180,"value":"Marshal"}},{"id":1582910,"event":"return","thread_id":9160,"parent_id":1582909,"elapsed":9.516952559351921e-06,"elapsed_instrumentation":0.00017599103739485145,"return_value":{"class":"String","value":"\u0004\b{\u0000","object_id":8608440}},{"id":1582911,"event":"return","thread_id":9160,"parent_id":1582900,"elapsed":0.007340423995628953,"elapsed_instrumentation":0.0002992379595525563,"return_value":{"class":"Array","value":"[https://foo.bar/inbox]","object_id":8608460,"size":1}},{"id":1582912,"event":"return","thread_id":9160,"parent_id":1582897,"elapsed":0.010251822008285671,"elapsed_instrumentation":0.00015911395894363523,"return_value":{"class":"Array","value":"[https://foo.bar/inbox]","object_id":8608460,"size":1}},{"id":1582913,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"in_reply_to_local_account?","path":"app/models/status.rb","lineno":192,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":8608240,"value":"#<Status:0x00007fc8e2a48c30>"}},{"id":1582914,"event":"call","thread_id":9160,"defined_class":"Status","method_id":"reply?","path":"app/models/status.rb","lineno":184,"static":false,"parameters":[],"receiver":{"class":"Status","object_id":8608240,"value":"#<Status:0x00007fc8e2a48c30>"}},{"id":1582915,"event":"return","thread_id":9160,"parent_id":1582914,"elapsed":6.730400491505861e-05,"elapsed_instrumentation":5.235796561464667e-05},{"id":1582916,"event":"return","thread_id":9160,"parent_id":1582913,"elapsed":0.00018159998580813408,"elapsed_instrumentation":8.692394476383924e-05},{"id":1582917,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"inboxes","path":"app/models/account.rb","lineno":436,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":36600,"value":"Account"}},{"id":1582918,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT coalesce(nullif(accounts.shared_inbox_url, ''), accounts.inbox_url) AS preferred_inbox_url FROM \"accounts\" INNER JOIN \"follows\" ON \"accounts\".\"id\" = \"follows\".\"account_id\" WHERE \"follows\".\"target_account_id\" = $1 AND \"accounts\".\"protocol\" = $2 GROUP BY \"preferred_inbox_url\"","database_type":"postgres"}},{"id":1582919,"event":"return","thread_id":9160,"parent_id":1582918,"elapsed":0.001946145,"elapsed_instrumentation":0.0001284260069951415},{"id":1582920,"event":"call","thread_id":9160,"defined_class":"DeliveryFailureTracker","method_id":"without_unavailable","path":"app/lib/delivery_failure_tracker.rb","lineno":43,"static":true,"parameters":[{"name":"urls","class":"Array","object_id":8608480,"value":"[]","kind":"req","size":0}],"receiver":{"class":"Class","object_id":52940,"value":"DeliveryFailureTracker"}},{"id":1582921,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":8608500,"value":"Cache read: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":1582922,"event":"return","thread_id":9160,"parent_id":1582921,"elapsed":0.0006784619763493538,"elapsed_instrumentation":0.00031895405845716596,"return_value":{"class":"Integer","value":"80","object_id":161}},{"id":1582923,"event":"call","thread_id":9160,"defined_class":"Marshal","method_id":"load","path":"<internal:marshal>","lineno":33,"static":true,"parameters":[{"name":"source","class":"String","object_id":8608440,"value":"\u0004\b{\u0000","kind":"req"},{"name":"arg","class":"Array","object_id":8608520,"value":"[]","kind":"rest","size":0}],"receiver":{"class":"Module","object_id":318180,"value":"Marshal"}},{"id":1582924,"event":"return","thread_id":9160,"parent_id":1582923,"elapsed":1.2616976164281368e-05,"elapsed_instrumentation":0.0003571150009520352,"return_value":{"class":"Hash","value":"{}","object_id":8608540,"size":0}},{"id":1582925,"event":"call","thread_id":9160,"defined_class":"Logger::LogDevice","method_id":"write","path":"/usr/local/lib/ruby/3.2.0/logger/log_device.rb","lineno":31,"static":false,"parameters":[{"name":"message","class":"String","object_id":8608560,"value":"Cache fetch_hit: unavailable_domains ({:compress=>false, :compress_threshold=>1024})\n","kind":"req"}],"receiver":{"class":"Logger::LogDevice","object_id":19780,"value":"#<Logger::LogDevice:0x00007fc942103e80>"}},{"id":1582926,"event":"return","thread_id":9160,"parent_id":1582925,"elapsed":0.000812919985037297,"elapsed_instrumentation":0.0001353789702989161,"return_value":{"class":"Integer","value":"85","object_id":171}},{"id":1582927,"event":"return","thread_id":9160,"parent_id":1582920,"elapsed":0.0027548729558475316,"elapsed_instrumentation":0.00016438699094578624,"return_value":{"class":"Array","value":"[]","object_id":8608580,"size":0}},{"id":1582928,"event":"return","thread_id":9160,"parent_id":1582917,"elapsed":0.006923772976733744,"elapsed_instrumentation":0.00016879895702004433,"return_value":{"class":"Array","value":"[]","object_id":8608580,"size":0}},{"id":1582929,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"relays\".\"inbox_url\" FROM \"relays\" WHERE \"relays\".\"state\" = $1","database_type":"postgres"}},{"id":1582930,"event":"return","thread_id":9160,"parent_id":1582929,"elapsed":0.00085765,"elapsed_instrumentation":9.563699131831527e-05},{"id":1582931,"event":"return","thread_id":9160,"parent_id":1582884,"elapsed":0.036471511994022876,"elapsed_instrumentation":0.00030707998666912317,"return_value":{"class":"Array","value":"[https://foo.bar/inbox]","object_id":8608600,"size":1}}]}