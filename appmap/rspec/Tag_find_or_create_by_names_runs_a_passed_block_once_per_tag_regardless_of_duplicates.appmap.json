{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","status":["M .husky/pre-commit"],"git_last_annotated_tag":"0.1.2-14608-g2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Tag .find_or_create_by_names runs a passed block once per tag regardless of duplicates","source_location":"spec/models/tag_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"models","type":"package","children":[{"name":"Tag","type":"class","children":[{"name":"find_or_create_by_names","type":"function","location":"app/models/tag.rb:114","static":true},{"name":"normalize","type":"function","location":"app/models/tag.rb:156","static":true},{"name":"matching_name","type":"function","location":"app/models/tag.rb:146","static":true},{"name":"display_name","type":"function","location":"app/models/tag.rb:67","static":false}]}]},{"name":"lib","type":"package","children":[{"name":"HashtagNormalizer","type":"class","children":[{"name":"normalize","type":"function","location":"app/lib/hashtag_normalizer.rb:4","static":false}]},{"name":"ASCIIFolding","type":"class","children":[{"name":"fold","type":"function","location":"app/lib/ascii_folding.rb:7","static":false}]}]}]},{"name":"activesupport","type":"package","children":[{"name":"ActiveSupport","type":"class","children":[{"name":"Callbacks","type":"class","children":[{"name":"CallbackSequence","type":"class","children":[{"name":"invoke_before","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:597","static":false,"labels":["mvc.before_action"]},{"name":"invoke_after","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:601","static":false,"labels":["mvc.after_action"]}]}]}]}]}],"events":[{"id":1180990,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"find_or_create_by_names","path":"app/models/tag.rb","lineno":114,"static":true,"parameters":[{"name":"name_or_names","class":"Array","object_id":6822460,"value":"[abcABCａｂｃＡＢＣやゆよ, abcabcａｂｃａｂｃやゆよ]","kind":"req","size":2}],"receiver":{"class":"Class","object_id":37120,"value":"Tag"}},{"id":1180991,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"normalize","path":"app/models/tag.rb","lineno":156,"static":true,"parameters":[{"name":"str","class":"String","object_id":6822480,"value":"abcABCａｂｃＡＢＣやゆよ","kind":"req"}],"receiver":{"class":"Class","object_id":37120,"value":"Tag"}},{"id":1180992,"event":"call","thread_id":9160,"defined_class":"HashtagNormalizer","method_id":"normalize","path":"app/lib/hashtag_normalizer.rb","lineno":4,"static":false,"parameters":[{"name":"str","class":"String","object_id":6822480,"value":"abcABCａｂｃＡＢＣやゆよ","kind":"req"}],"receiver":{"class":"HashtagNormalizer","object_id":6822500,"value":"#<HashtagNormalizer:0x00007fc932754920>"}},{"id":1180993,"event":"call","thread_id":9160,"defined_class":"ASCIIFolding","method_id":"fold","path":"app/lib/ascii_folding.rb","lineno":7,"static":false,"parameters":[{"name":"str","class":"String","object_id":6822520,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"ASCIIFolding","object_id":6822540,"value":"#<ASCIIFolding:0x00007fc932753930>"}},{"id":1180994,"event":"return","thread_id":9160,"parent_id":1180993,"elapsed":0.0003697560168802738,"elapsed_instrumentation":0.00023417104966938496,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":6822560}},{"id":1180995,"event":"return","thread_id":9160,"parent_id":1180992,"elapsed":0.0007552099996246397,"elapsed_instrumentation":0.00018047494813799858,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":6822580}},{"id":1180996,"event":"return","thread_id":9160,"parent_id":1180991,"elapsed":0.0009819130063988268,"elapsed_instrumentation":0.00038531696191057563,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":6822580}},{"id":1180997,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"normalize","path":"app/models/tag.rb","lineno":156,"static":true,"parameters":[{"name":"str","class":"String","object_id":6822600,"value":"abcabcａｂｃａｂｃやゆよ","kind":"req"}],"receiver":{"class":"Class","object_id":37120,"value":"Tag"}},{"id":1180998,"event":"call","thread_id":9160,"defined_class":"HashtagNormalizer","method_id":"normalize","path":"app/lib/hashtag_normalizer.rb","lineno":4,"static":false,"parameters":[{"name":"str","class":"String","object_id":6822600,"value":"abcabcａｂｃａｂｃやゆよ","kind":"req"}],"receiver":{"class":"HashtagNormalizer","object_id":6822620,"value":"#<HashtagNormalizer:0x00007fc932751158>"}},{"id":1180999,"event":"call","thread_id":9160,"defined_class":"ASCIIFolding","method_id":"fold","path":"app/lib/ascii_folding.rb","lineno":7,"static":false,"parameters":[{"name":"str","class":"String","object_id":6822640,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"ASCIIFolding","object_id":6822660,"value":"#<ASCIIFolding:0x00007fc93276ede8>"}},{"id":1181000,"event":"return","thread_id":9160,"parent_id":1180999,"elapsed":3.14330100081861e-05,"elapsed_instrumentation":9.528896771371365e-05,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":6822680}},{"id":1181001,"event":"return","thread_id":9160,"parent_id":1180998,"elapsed":0.0002021240070462227,"elapsed_instrumentation":9.020895231515169e-05,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":6822700}},{"id":1181002,"event":"return","thread_id":9160,"parent_id":1180997,"elapsed":0.0003132210113108158,"elapsed_instrumentation":0.000110382039565593,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":6822700}},{"id":1181003,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"matching_name","path":"app/models/tag.rb","lineno":146,"static":true,"parameters":[{"name":"name_or_names","class":"String","object_id":6822580,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"Class","object_id":37120,"value":"Tag"}},{"id":1181004,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"normalize","path":"app/models/tag.rb","lineno":156,"static":true,"parameters":[{"name":"str","class":"String","object_id":6822580,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"Class","object_id":37120,"value":"Tag"}},{"id":1181005,"event":"call","thread_id":9160,"defined_class":"HashtagNormalizer","method_id":"normalize","path":"app/lib/hashtag_normalizer.rb","lineno":4,"static":false,"parameters":[{"name":"str","class":"String","object_id":6822580,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"HashtagNormalizer","object_id":6822720,"value":"#<HashtagNormalizer:0x00007fc93276aba8>"}},{"id":1181006,"event":"call","thread_id":9160,"defined_class":"ASCIIFolding","method_id":"fold","path":"app/lib/ascii_folding.rb","lineno":7,"static":false,"parameters":[{"name":"str","class":"String","object_id":6822740,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"ASCIIFolding","object_id":6822760,"value":"#<ASCIIFolding:0x00007fc932768f88>"}},{"id":1181007,"event":"return","thread_id":9160,"parent_id":1181006,"elapsed":3.3728021662682295e-05,"elapsed_instrumentation":0.00010743999155238271,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":6822780}},{"id":1181008,"event":"return","thread_id":9160,"parent_id":1181005,"elapsed":0.00020083901472389698,"elapsed_instrumentation":0.00014622992603108287,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":6822800}},{"id":1181009,"event":"return","thread_id":9160,"parent_id":1181004,"elapsed":0.00038364098872989416,"elapsed_instrumentation":0.00010108697460964322,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":6822800}},{"id":1181010,"event":"return","thread_id":9160,"parent_id":1181003,"elapsed":0.0008650160161778331,"elapsed_instrumentation":0.00010519498027861118,"return_value":{"class":"ActiveRecord::Relation","value":"#<Tag::ActiveRecord_Relation:0x00007fc91a5a88f0>","object_id":6822820}},{"id":1181011,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"tags\".* FROM \"tags\" WHERE LOWER(\"tags\".\"name\") = LOWER('abcabcabcabcやゆよ') ORDER BY \"tags\".\"id\" ASC LIMIT $1","database_type":"postgres"}},{"id":1181012,"event":"return","thread_id":9160,"parent_id":1181011,"elapsed":0.000707804,"elapsed_instrumentation":0.0003120190231129527},{"id":1181013,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":6822840,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1464720,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc931ce5700>"}},{"id":1181014,"event":"return","thread_id":9160,"parent_id":1181013,"elapsed":2.759898779913783e-05,"elapsed_instrumentation":0.0003464619512669742,"return_value":{"class":"Array","value":"[#<Proc:0x00007fc932f63f80 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1464740,"size":1}},{"id":1181015,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":6822860,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1464780,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc931ce56b0>"}},{"id":1181016,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"display_name","path":"app/models/tag.rb","lineno":67,"static":false,"parameters":[],"receiver":{"class":"Tag","object_id":6822880,"value":"#<Tag:0x00007fc91a3cb410>"}},{"id":1181017,"event":"return","thread_id":9160,"parent_id":1181016,"elapsed":9.289802983403206e-05,"elapsed_instrumentation":0.00011145998723804951,"return_value":{"class":"String","value":"abcABCａｂｃＡＢＣやゆよ","object_id":6822900}},{"id":1181018,"event":"return","thread_id":9160,"parent_id":1181015,"elapsed":0.0009297299548052251,"elapsed_instrumentation":0.00023405603133141994,"return_value":{"class":"Array","value":"[#<Proc:0x00007fc932f624c8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f62680 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f627c0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f62900 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f62a40 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f62b80 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f62cc0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f62e00 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f62f40 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f63120 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib (...3 more items)]","object_id":1464840,"size":13}},{"id":1181019,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":6822860,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1464780,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc931ce56b0>"}},{"id":1181020,"event":"return","thread_id":9160,"parent_id":1181019,"elapsed":4.265981260687113e-06,"elapsed_instrumentation":9.515602141618729e-05,"return_value":{"class":"Array","value":"[]","object_id":1464860,"size":0}},{"id":1181021,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":6822840,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1464720,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc931ce5700>"}},{"id":1181022,"event":"return","thread_id":9160,"parent_id":1181021,"elapsed":1.4231016393750906e-05,"elapsed_instrumentation":0.00012143701314926147,"return_value":{"class":"Array","value":"[#<Proc:0x00007fc932f63e40 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1464880,"size":1}},{"id":1181023,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":6822920,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1464920,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc931ce5610>"}},{"id":1181024,"event":"return","thread_id":9160,"parent_id":1181023,"elapsed":3.0919909477233887e-06,"elapsed_instrumentation":8.699501631781459e-05,"return_value":{"class":"Array","value":"[]","object_id":1464940,"size":0}},{"id":1181025,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":6822920,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1464960,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc931ce5660>"}},{"id":1181026,"event":"return","thread_id":9160,"parent_id":1181025,"elapsed":4.267028998583555e-06,"elapsed_instrumentation":0.00039141898741945624,"return_value":{"class":"Array","value":"[]","object_id":1464980,"size":0}},{"id":1181027,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":6822940,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1465020,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc931ce5520>"}},{"id":1181028,"event":"return","thread_id":9160,"parent_id":1181027,"elapsed":3.1130039133131504e-06,"elapsed_instrumentation":9.545701323077083e-05,"return_value":{"class":"Array","value":"[]","object_id":1465040,"size":0}},{"id":1181029,"event":"call","thread_id":9160,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres"}},{"id":1181030,"event":"return","thread_id":9160,"parent_id":1181029,"elapsed":0.000853343,"elapsed_instrumentation":0.00010699097765609622},{"id":1181031,"event":"call","thread_id":9160,"sql_query":{"sql":"INSERT INTO \"tags\" (\"name\", \"created_at\", \"updated_at\", \"usable\", \"trendable\", \"listable\", \"reviewed_at\", \"requested_review_at\", \"last_status_at\", \"max_score\", \"max_score_at\", \"display_name\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING \"id\"","database_type":"postgres"}},{"id":1181032,"event":"return","thread_id":9160,"parent_id":1181031,"elapsed":0.002173382,"elapsed_instrumentation":0.00010463799117133021},{"id":1181033,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":6822940,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1465020,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc931ce5520>"}},{"id":1181034,"event":"return","thread_id":9160,"parent_id":1181033,"elapsed":8.097500540316105e-05,"elapsed_instrumentation":0.0006799619877710938,"return_value":{"class":"Array","value":"[#<Proc:0x00007fc932f8f400 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f8f220 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f8f068 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f8eeb0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f8ecf8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f8eb40 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc932f8e988 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1465060,"size":7}},{"id":1181035,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":6822920,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1464960,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc931ce5660>"}},{"id":1181036,"event":"return","thread_id":9160,"parent_id":1181035,"elapsed":3.335007932037115e-06,"elapsed_instrumentation":0.00012274301843717694,"return_value":{"class":"Array","value":"[]","object_id":1465080,"size":0}},{"id":1181037,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":6822920,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1464920,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc931ce5610>"}},{"id":1181038,"event":"return","thread_id":9160,"parent_id":1181037,"elapsed":0.00010436295997351408,"elapsed_instrumentation":0.00011271401308476925,"return_value":{"class":"Array","value":"[#<Proc:0x00007fc932f60498 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1465100,"size":1}},{"id":1181039,"event":"call","thread_id":9160,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres"}},{"id":1181040,"event":"return","thread_id":9160,"parent_id":1181039,"elapsed":0.000639677,"elapsed_instrumentation":8.077401435002685e-05},{"id":1181041,"event":"return","thread_id":9160,"parent_id":1180990,"elapsed":0.015654415998142213,"elapsed_instrumentation":0.0003780769766308367,"return_value":{"class":"Array","value":"[#<Tag:0x00007fc91a3cb410>]","object_id":6822960,"size":1}}]}