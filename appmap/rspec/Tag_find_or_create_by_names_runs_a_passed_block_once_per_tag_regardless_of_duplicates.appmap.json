{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"743782bd299fd54e12a4a5829872efc505132ab3","status":["M .husky/pre-commit","?? sql_warning.txt"],"git_last_annotated_tag":"0.1.2-14597-g743782bd299fd54e12a4a5829872efc505132ab3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Tag .find_or_create_by_names runs a passed block once per tag regardless of duplicates","source_location":"spec/models/tag_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"app","type":"package","children":[{"name":"models","type":"package","children":[{"name":"Tag","type":"class","children":[{"name":"find_or_create_by_names","type":"function","location":"app/models/tag.rb:114","static":true},{"name":"normalize","type":"function","location":"app/models/tag.rb:156","static":true},{"name":"matching_name","type":"function","location":"app/models/tag.rb:146","static":true},{"name":"display_name","type":"function","location":"app/models/tag.rb:67","static":false}]}]},{"name":"lib","type":"package","children":[{"name":"HashtagNormalizer","type":"class","children":[{"name":"normalize","type":"function","location":"app/lib/hashtag_normalizer.rb:4","static":false}]},{"name":"ASCIIFolding","type":"class","children":[{"name":"fold","type":"function","location":"app/lib/ascii_folding.rb:7","static":false}]}]}]},{"name":"activesupport","type":"package","children":[{"name":"ActiveSupport","type":"class","children":[{"name":"Callbacks","type":"class","children":[{"name":"CallbackSequence","type":"class","children":[{"name":"invoke_before","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:597","static":false,"labels":["mvc.before_action"]},{"name":"invoke_after","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:601","static":false,"labels":["mvc.after_action"]}]}]}]}]}],"events":[{"id":426848,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"find_or_create_by_names","path":"app/models/tag.rb","lineno":114,"static":true,"parameters":[{"name":"name_or_names","class":"Array","object_id":2789040,"value":"[abcABCａｂｃＡＢＣやゆよ, abcabcａｂｃａｂｃやゆよ]","kind":"req","size":2}],"receiver":{"class":"Class","object_id":37120,"value":"Tag"}},{"id":426849,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"normalize","path":"app/models/tag.rb","lineno":156,"static":true,"parameters":[{"name":"str","class":"String","object_id":2788880,"value":"abcABCａｂｃＡＢＣやゆよ","kind":"req"}],"receiver":{"class":"Class","object_id":37120,"value":"Tag"}},{"id":426850,"event":"call","thread_id":9160,"defined_class":"HashtagNormalizer","method_id":"normalize","path":"app/lib/hashtag_normalizer.rb","lineno":4,"static":false,"parameters":[{"name":"str","class":"String","object_id":2788880,"value":"abcABCａｂｃＡＢＣやゆよ","kind":"req"}],"receiver":{"class":"HashtagNormalizer","object_id":2789060,"value":"#<HashtagNormalizer:0x00007fdc096b43c8>"}},{"id":426851,"event":"call","thread_id":9160,"defined_class":"ASCIIFolding","method_id":"fold","path":"app/lib/ascii_folding.rb","lineno":7,"static":false,"parameters":[{"name":"str","class":"String","object_id":2789080,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"ASCIIFolding","object_id":2789100,"value":"#<ASCIIFolding:0x00007fdc096b3158>"}},{"id":426852,"event":"return","thread_id":9160,"parent_id":426851,"elapsed":4.690501373261213e-05,"elapsed_instrumentation":0.00020237400894984603,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":2789120}},{"id":426853,"event":"return","thread_id":9160,"parent_id":426850,"elapsed":0.0003746180154848844,"elapsed_instrumentation":0.0001412539859302342,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":2789140}},{"id":426854,"event":"return","thread_id":9160,"parent_id":426849,"elapsed":0.0005470530013553798,"elapsed_instrumentation":0.000171844003489241,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":2789140}},{"id":426855,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"normalize","path":"app/models/tag.rb","lineno":156,"static":true,"parameters":[{"name":"str","class":"String","object_id":2788640,"value":"abcabcａｂｃａｂｃやゆよ","kind":"req"}],"receiver":{"class":"Class","object_id":37120,"value":"Tag"}},{"id":426856,"event":"call","thread_id":9160,"defined_class":"HashtagNormalizer","method_id":"normalize","path":"app/lib/hashtag_normalizer.rb","lineno":4,"static":false,"parameters":[{"name":"str","class":"String","object_id":2788640,"value":"abcabcａｂｃａｂｃやゆよ","kind":"req"}],"receiver":{"class":"HashtagNormalizer","object_id":2789160,"value":"#<HashtagNormalizer:0x00007fdc096b0ae8>"}},{"id":426857,"event":"call","thread_id":9160,"defined_class":"ASCIIFolding","method_id":"fold","path":"app/lib/ascii_folding.rb","lineno":7,"static":false,"parameters":[{"name":"str","class":"String","object_id":2789180,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"ASCIIFolding","object_id":2789200,"value":"#<ASCIIFolding:0x00007fdc0970f138>"}},{"id":426858,"event":"return","thread_id":9160,"parent_id":426857,"elapsed":3.289201413281262e-05,"elapsed_instrumentation":0.00011160198482684791,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":2789220}},{"id":426859,"event":"return","thread_id":9160,"parent_id":426856,"elapsed":0.00022113998420536518,"elapsed_instrumentation":8.345299283973873e-05,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":2789240}},{"id":426860,"event":"return","thread_id":9160,"parent_id":426855,"elapsed":0.00032563498825766146,"elapsed_instrumentation":0.000135750015033409,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":2789240}},{"id":426861,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"matching_name","path":"app/models/tag.rb","lineno":146,"static":true,"parameters":[{"name":"name_or_names","class":"String","object_id":2789140,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"Class","object_id":37120,"value":"Tag"}},{"id":426862,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"normalize","path":"app/models/tag.rb","lineno":156,"static":true,"parameters":[{"name":"str","class":"String","object_id":2789140,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"Class","object_id":37120,"value":"Tag"}},{"id":426863,"event":"call","thread_id":9160,"defined_class":"HashtagNormalizer","method_id":"normalize","path":"app/lib/hashtag_normalizer.rb","lineno":4,"static":false,"parameters":[{"name":"str","class":"String","object_id":2789140,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"HashtagNormalizer","object_id":2789260,"value":"#<HashtagNormalizer:0x00007fdc0970b538>"}},{"id":426864,"event":"call","thread_id":9160,"defined_class":"ASCIIFolding","method_id":"fold","path":"app/lib/ascii_folding.rb","lineno":7,"static":false,"parameters":[{"name":"str","class":"String","object_id":2789280,"value":"abcabcabcabcやゆよ","kind":"req"}],"receiver":{"class":"ASCIIFolding","object_id":2789300,"value":"#<ASCIIFolding:0x00007fdc09709eb8>"}},{"id":426865,"event":"return","thread_id":9160,"parent_id":426864,"elapsed":2.8592010494321585e-05,"elapsed_instrumentation":0.00011883198749274015,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":2789320}},{"id":426866,"event":"return","thread_id":9160,"parent_id":426863,"elapsed":0.0002187830104958266,"elapsed_instrumentation":0.00027391299954615533,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":2789340}},{"id":426867,"event":"return","thread_id":9160,"parent_id":426862,"elapsed":0.00052061298629269,"elapsed_instrumentation":9.852703078649938e-05,"return_value":{"class":"String","value":"abcabcabcabcやゆよ","object_id":2789340}},{"id":426868,"event":"return","thread_id":9160,"parent_id":426861,"elapsed":0.0007687500037718564,"elapsed_instrumentation":0.0001345470082014799,"return_value":{"class":"ActiveRecord::Relation","value":"#<Tag::ActiveRecord_Relation:0x00007fdc07c8dfd0>","object_id":2789360}},{"id":426869,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"tags\".* FROM \"tags\" WHERE LOWER(\"tags\".\"name\") = LOWER('abcabcabcabcやゆよ') ORDER BY \"tags\".\"id\" ASC LIMIT $1","database_type":"postgres"}},{"id":426870,"event":"return","thread_id":9160,"parent_id":426869,"elapsed":0.000934214,"elapsed_instrumentation":0.00010379200102761388},{"id":426871,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":2789380,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1592740,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0738cb70>"}},{"id":426872,"event":"return","thread_id":9160,"parent_id":426871,"elapsed":1.9019993487745523e-05,"elapsed_instrumentation":0.0001356499851681292,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0a3d9af8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1592760,"size":1}},{"id":426873,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":2789400,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1592800,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0738cb20>"}},{"id":426874,"event":"call","thread_id":9160,"defined_class":"Tag","method_id":"display_name","path":"app/models/tag.rb","lineno":67,"static":false,"parameters":[],"receiver":{"class":"Tag","object_id":2789420,"value":"#<Tag:0x00007fdc06de0f00>"}},{"id":426875,"event":"return","thread_id":9160,"parent_id":426874,"elapsed":0.0001197849924210459,"elapsed_instrumentation":0.00013029802357777953,"return_value":{"class":"String","value":"abcABCａｂｃＡＢＣやゆよ","object_id":2789440}},{"id":426876,"event":"return","thread_id":9160,"parent_id":426873,"elapsed":0.0008746919920668006,"elapsed_instrumentation":0.00017716799629852176,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0a3d4ee0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a3d55e8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a3d5840 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a3d5ae8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a3d5d40 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a3d5f98 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a3d6380 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a3d6a38 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a3d6f60 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a3d75c8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib (...3 more items)]","object_id":1592840,"size":13}},{"id":426877,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":2789400,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1592800,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0738cb20>"}},{"id":426878,"event":"return","thread_id":9160,"parent_id":426877,"elapsed":2.663000486791134e-06,"elapsed_instrumentation":8.266602526418865e-05,"return_value":{"class":"Array","value":"[]","object_id":1592860,"size":0}},{"id":426879,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":2789380,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1592740,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0738cb70>"}},{"id":426880,"event":"return","thread_id":9160,"parent_id":426879,"elapsed":1.3229000614956021e-05,"elapsed_instrumentation":0.00040828800410963595,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0a3d9698 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1592880,"size":1}},{"id":426881,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":2789460,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1614640,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0738ca80>"}},{"id":426882,"event":"return","thread_id":9160,"parent_id":426881,"elapsed":5.176989361643791e-06,"elapsed_instrumentation":0.00015036299009807408,"return_value":{"class":"Array","value":"[]","object_id":1614660,"size":0}},{"id":426883,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":2789460,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1614680,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0738cad0>"}},{"id":426884,"event":"return","thread_id":9160,"parent_id":426883,"elapsed":3.343011485412717e-06,"elapsed_instrumentation":0.00016466801753267646,"return_value":{"class":"Array","value":"[]","object_id":1614700,"size":0}},{"id":426885,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":2789480,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1614740,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0738c940>"}},{"id":426886,"event":"return","thread_id":9160,"parent_id":426885,"elapsed":3.2740063033998013e-06,"elapsed_instrumentation":0.00010551698505878448,"return_value":{"class":"Array","value":"[]","object_id":1614760,"size":0}},{"id":426887,"event":"call","thread_id":9160,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres"}},{"id":426888,"event":"return","thread_id":9160,"parent_id":426887,"elapsed":0.000659858,"elapsed_instrumentation":0.00011669800733216107},{"id":426889,"event":"call","thread_id":9160,"sql_query":{"sql":"INSERT INTO \"tags\" (\"name\", \"created_at\", \"updated_at\", \"usable\", \"trendable\", \"listable\", \"reviewed_at\", \"requested_review_at\", \"last_status_at\", \"max_score\", \"max_score_at\", \"display_name\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING \"id\"","database_type":"postgres"}},{"id":426890,"event":"return","thread_id":9160,"parent_id":426889,"elapsed":0.001792354,"elapsed_instrumentation":8.458600495941937e-05},{"id":426891,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":2789480,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1614740,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0738c940>"}},{"id":426892,"event":"return","thread_id":9160,"parent_id":426891,"elapsed":7.807000656612217e-05,"elapsed_instrumentation":0.00022493602591566741,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0a2ee828 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a2ee3c8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a2ee120 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a2ede00 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a2edb08 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a2ed810 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0a2ed568 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1614780,"size":7}},{"id":426893,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":2789460,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1614680,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0738cad0>"}},{"id":426894,"event":"return","thread_id":9160,"parent_id":426893,"elapsed":3.630993887782097e-06,"elapsed_instrumentation":9.507598588243127e-05,"return_value":{"class":"Array","value":"[]","object_id":1614800,"size":0}},{"id":426895,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":2789460,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1614640,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0738ca80>"}},{"id":426896,"event":"return","thread_id":9160,"parent_id":426895,"elapsed":0.0004937420017085969,"elapsed_instrumentation":0.00017946396837942302,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0a3d09f8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1614820,"size":1}},{"id":426897,"event":"call","thread_id":9160,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres"}},{"id":426898,"event":"return","thread_id":9160,"parent_id":426897,"elapsed":0.000847917,"elapsed_instrumentation":0.0001282119774259627},{"id":426899,"event":"return","thread_id":9160,"parent_id":426848,"elapsed":0.013573660020483658,"elapsed_instrumentation":0.000598216982325539,"return_value":{"class":"Array","value":"[#<Tag:0x00007fdc06de0f00>]","object_id":2789500,"size":1}}]}