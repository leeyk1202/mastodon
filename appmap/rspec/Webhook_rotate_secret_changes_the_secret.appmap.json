{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"743782bd299fd54e12a4a5829872efc505132ab3","status":["M .husky/pre-commit","?? sql_warning.txt"],"git_last_annotated_tag":"0.1.2-14597-g743782bd299fd54e12a4a5829872efc505132ab3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Webhook #rotate_secret! changes the secret","source_location":"spec/models/webhook_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"ruby","type":"package","children":[{"name":"String","type":"class","children":[{"name":"unpack1","type":"function","location":"<internal:pack>:28","static":false,"labels":["string.unpack"]}]}]},{"name":"activesupport","type":"package","children":[{"name":"ActiveSupport","type":"class","children":[{"name":"Callbacks","type":"class","children":[{"name":"CallbackSequence","type":"class","children":[{"name":"invoke_before","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:597","static":false,"labels":["mvc.before_action"]},{"name":"invoke_after","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:601","static":false,"labels":["mvc.after_action"]}]}]}]}]},{"name":"app","type":"package","children":[{"name":"validators","type":"package","children":[{"name":"URLValidator","type":"class","children":[{"name":"validate_each","type":"function","location":"app/validators/url_validator.rb:6","static":false}]}]},{"name":"models","type":"package","children":[{"name":"Webhook","type":"class","children":[{"name":"rotate_secret!","type":"function","location":"app/models/webhook.rb:43","static":false}]}]}]}],"events":[{"id":1400917,"event":"call","thread_id":9160,"defined_class":"String","method_id":"unpack1","path":"<internal:pack>","lineno":28,"static":false,"parameters":[{"name":"fmt","class":"String","object_id":210800,"value":"H*","kind":"req"},{"name":"offset","class":"NilClass","object_id":4,"value":null,"kind":"key"}],"receiver":{"class":"String","object_id":7501040,"value":"__'\f!_\u001d\t___Z|+\u0003_"}},{"id":1400918,"event":"return","thread_id":9160,"parent_id":1400917,"elapsed":7.688009645789862e-06,"elapsed_instrumentation":0.0008119429985526949,"return_value":{"class":"String","value":"c8ed270c21d91d099f91bf5a7c2b03f1","object_id":7501060}},{"id":1400919,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":7501080,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":2793240,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09578180>"}},{"id":1400920,"event":"return","thread_id":9160,"parent_id":1400919,"elapsed":0.0001446050009690225,"elapsed_instrumentation":0.0003084199852310121,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0b4d0848 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4d0dc0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4d14f0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":2793260,"size":3}},{"id":1400921,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":7501100,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":2793300,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09577fa0>"}},{"id":1400922,"event":"call","thread_id":9160,"defined_class":"URLValidator","method_id":"validate_each","path":"app/validators/url_validator.rb","lineno":6,"static":false,"parameters":[{"name":"record","class":"Webhook","object_id":7501120,"value":"#<Webhook:0x00007fdc0712b188>","kind":"req"},{"name":"attribute","class":"Symbol","object_id":1292188,"value":":url","kind":"req"},{"name":"value","class":"String","object_id":7501140,"value":"http://lesch.test/hyun","kind":"req"}],"receiver":{"class":"URLValidator","object_id":2793360,"value":"#<URLValidator:0x00007fdc0f98c608>"}},{"id":1400923,"event":"return","thread_id":9160,"parent_id":1400922,"elapsed":0.0003825399908237159,"elapsed_instrumentation":0.0002308670082129538},{"id":1400924,"event":"return","thread_id":9160,"parent_id":1400921,"elapsed":0.000940708996495232,"elapsed_instrumentation":0.00037756303208880126,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0b4f64a8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f6818 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f6e80 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f71f0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f80a0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f8320 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f8758 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f9270 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f94f0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":2793380,"size":9}},{"id":1400925,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":7501100,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":2793300,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09577fa0>"}},{"id":1400926,"event":"return","thread_id":9160,"parent_id":1400925,"elapsed":5.506008164957166e-06,"elapsed_instrumentation":0.00015087300562299788,"return_value":{"class":"Array","value":"[]","object_id":2793400,"size":0}},{"id":1400927,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":7501080,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":2793240,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09578180>"}},{"id":1400928,"event":"return","thread_id":9160,"parent_id":1400927,"elapsed":5.403999239206314e-06,"elapsed_instrumentation":0.0003258749784436077,"return_value":{"class":"Array","value":"[]","object_id":2793420,"size":0}},{"id":1400929,"event":"call","thread_id":9160,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres"}},{"id":1400930,"event":"return","thread_id":9160,"parent_id":1400929,"elapsed":0.000702531,"elapsed_instrumentation":0.00010717500117607415},{"id":1400931,"event":"call","thread_id":9160,"sql_query":{"sql":"INSERT INTO \"webhooks\" (\"url\", \"events\", \"secret\", \"enabled\", \"created_at\", \"updated_at\", \"template\") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING \"id\"","database_type":"postgres"}},{"id":1400932,"event":"return","thread_id":9160,"parent_id":1400931,"elapsed":0.001848486,"elapsed_instrumentation":9.575000149197876e-05},{"id":1400933,"event":"call","thread_id":9160,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres"}},{"id":1400934,"event":"return","thread_id":9160,"parent_id":1400933,"elapsed":0.000441734,"elapsed_instrumentation":0.00011147098848596215},{"id":1400935,"event":"call","thread_id":9160,"defined_class":"Webhook","method_id":"rotate_secret!","path":"app/models/webhook.rb","lineno":43,"static":false,"parameters":[],"receiver":{"class":"Webhook","object_id":7501120,"value":"#<Webhook:0x00007fdc0712b188>"}},{"id":1400936,"event":"call","thread_id":9160,"defined_class":"String","method_id":"unpack1","path":"<internal:pack>","lineno":28,"static":false,"parameters":[{"name":"fmt","class":"String","object_id":210800,"value":"H*","kind":"req"},{"name":"offset","class":"NilClass","object_id":4,"value":null,"kind":"key"}],"receiver":{"class":"String","object_id":7501160,"value":"5\t_^9f{_\u001f\u00077_A-__~1__"}},{"id":1400937,"event":"return","thread_id":9160,"parent_id":1400936,"elapsed":7.259019184857607e-06,"elapsed_instrumentation":0.0004888389958068728,"return_value":{"class":"String","value":"3509c35e39667b8b1f073782412df1be7e31bfc5","object_id":7501180}},{"id":1400938,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":7501200,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":2793240,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09578180>"}},{"id":1400939,"event":"return","thread_id":9160,"parent_id":1400938,"elapsed":0.00011059100506827235,"elapsed_instrumentation":0.0002682589984033257,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0b4d0848 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4d0dc0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4d14f0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":2793260,"size":3}},{"id":1400940,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":7501220,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":2793300,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09577fa0>"}},{"id":1400941,"event":"call","thread_id":9160,"defined_class":"URLValidator","method_id":"validate_each","path":"app/validators/url_validator.rb","lineno":6,"static":false,"parameters":[{"name":"record","class":"Webhook","object_id":7501120,"value":"#<Webhook:0x00007fdc0712b188>","kind":"req"},{"name":"attribute","class":"Symbol","object_id":1292188,"value":":url","kind":"req"},{"name":"value","class":"String","object_id":7501240,"value":"http://lesch.test/hyun","kind":"req"}],"receiver":{"class":"URLValidator","object_id":2793360,"value":"#<URLValidator:0x00007fdc0f98c608>"}},{"id":1400942,"event":"return","thread_id":9160,"parent_id":1400941,"elapsed":0.0003517419972922653,"elapsed_instrumentation":0.00019483300275169313},{"id":1400943,"event":"return","thread_id":9160,"parent_id":1400940,"elapsed":0.0009492989920545369,"elapsed_instrumentation":0.0004078319761902094,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0b4f64a8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f6818 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f6e80 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f71f0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f80a0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f8320 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f8758 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f9270 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0b4f94f0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":2793380,"size":9}},{"id":1400944,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":7501220,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":2793300,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09577fa0>"}},{"id":1400945,"event":"return","thread_id":9160,"parent_id":1400944,"elapsed":3.102992195636034e-06,"elapsed_instrumentation":0.00010519998613744974,"return_value":{"class":"Array","value":"[]","object_id":2793400,"size":0}},{"id":1400946,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":7501200,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":2793240,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc09578180>"}},{"id":1400947,"event":"return","thread_id":9160,"parent_id":1400946,"elapsed":2.797984052449465e-06,"elapsed_instrumentation":8.470300235785544e-05,"return_value":{"class":"Array","value":"[]","object_id":2793420,"size":0}},{"id":1400948,"event":"call","thread_id":9160,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres"}},{"id":1400949,"event":"return","thread_id":9160,"parent_id":1400948,"elapsed":0.000963829,"elapsed_instrumentation":8.79740109667182e-05},{"id":1400950,"event":"call","thread_id":9160,"sql_query":{"sql":"UPDATE \"webhooks\" SET \"secret\" = $1, \"updated_at\" = $2 WHERE \"webhooks\".\"id\" = $3","database_type":"postgres"}},{"id":1400951,"event":"return","thread_id":9160,"parent_id":1400950,"elapsed":0.002448116,"elapsed_instrumentation":7.686502067372203e-05},{"id":1400952,"event":"call","thread_id":9160,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres"}},{"id":1400953,"event":"return","thread_id":9160,"parent_id":1400952,"elapsed":0.000652245,"elapsed_instrumentation":6.937599391676486e-05},{"id":1400954,"event":"return","thread_id":9160,"parent_id":1400935,"elapsed":0.009522640000795946,"elapsed_instrumentation":0.00020405897521413863,"return_value":{"class":"TrueClass","value":"true","object_id":20}}]}