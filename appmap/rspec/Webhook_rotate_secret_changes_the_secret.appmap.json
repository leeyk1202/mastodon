{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","status":["M .husky/pre-commit"],"git_last_annotated_tag":"0.1.2-14608-g2c1ae2317e8741caf25b51e9b3b2c15776c54ae3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Webhook #rotate_secret! changes the secret","source_location":"spec/models/webhook_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"ruby","type":"package","children":[{"name":"String","type":"class","children":[{"name":"unpack1","type":"function","location":"<internal:pack>:28","static":false,"labels":["string.unpack"]}]}]},{"name":"activesupport","type":"package","children":[{"name":"ActiveSupport","type":"class","children":[{"name":"Callbacks","type":"class","children":[{"name":"CallbackSequence","type":"class","children":[{"name":"invoke_before","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:597","static":false,"labels":["mvc.before_action"]},{"name":"invoke_after","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:601","static":false,"labels":["mvc.after_action"]}]}]}]}]},{"name":"app","type":"package","children":[{"name":"validators","type":"package","children":[{"name":"URLValidator","type":"class","children":[{"name":"validate_each","type":"function","location":"app/validators/url_validator.rb:6","static":false}]}]},{"name":"models","type":"package","children":[{"name":"Webhook","type":"class","children":[{"name":"rotate_secret!","type":"function","location":"app/models/webhook.rb:43","static":false}]}]}]}],"events":[{"id":131635,"event":"call","thread_id":9160,"defined_class":"String","method_id":"unpack1","path":"<internal:pack>","lineno":28,"static":false,"parameters":[{"name":"fmt","class":"String","object_id":319240,"value":"H*","kind":"req"},{"name":"offset","class":"NilClass","object_id":4,"value":null,"kind":"key"}],"receiver":{"class":"String","object_id":1062900,"value":"___\u0011____G_+_P-_/"}},{"id":131636,"event":"return","thread_id":9160,"parent_id":131635,"elapsed":6.4070336520671844e-06,"elapsed_instrumentation":0.00021638191537931561,"return_value":{"class":"String","value":"c8f78c11d896cac2479f2bac502d862f","object_id":1062920}},{"id":131637,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":1062940,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1062560,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc930ba1fe8>"}},{"id":131638,"event":"return","thread_id":9160,"parent_id":131637,"elapsed":0.0003976490115746856,"elapsed_instrumentation":0.00019058998441323638,"return_value":{"class":"Array","value":"[#<Proc:0x00007fc933157800 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933157940 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933157a80 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1062580,"size":3}},{"id":131639,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":1062960,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1062620,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc930ba1e08>"}},{"id":131640,"event":"call","thread_id":9160,"defined_class":"URLValidator","method_id":"validate_each","path":"app/validators/url_validator.rb","lineno":6,"static":false,"parameters":[{"name":"record","class":"Webhook","object_id":1062980,"value":"#<Webhook:0x00007fc930db5780>","kind":"req"},{"name":"attribute","class":"Symbol","object_id":1292188,"value":":url","kind":"req"},{"name":"value","class":"String","object_id":1063000,"value":"http://goldner.example/jorge","kind":"req"}],"receiver":{"class":"URLValidator","object_id":1062680,"value":"#<URLValidator:0x00007fc9385cace8>"}},{"id":131641,"event":"return","thread_id":9160,"parent_id":131640,"elapsed":0.00018695200560614467,"elapsed_instrumentation":0.00012789096217602491},{"id":131642,"event":"return","thread_id":9160,"parent_id":131639,"elapsed":0.0005051770131103694,"elapsed_instrumentation":0.00029205193277448416,"return_value":{"class":"Array","value":"[#<Proc:0x00007fc9331554d8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155690 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155870 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155a50 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155c30 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155e10 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155ff0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933156130 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933156270 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1062700,"size":9}},{"id":131643,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":1062960,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1062620,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc930ba1e08>"}},{"id":131644,"event":"return","thread_id":9160,"parent_id":131643,"elapsed":3.959052264690399e-06,"elapsed_instrumentation":0.00010631501208990812,"return_value":{"class":"Array","value":"[]","object_id":1062720,"size":0}},{"id":131645,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":1062940,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1062560,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc930ba1fe8>"}},{"id":131646,"event":"return","thread_id":9160,"parent_id":131645,"elapsed":2.8180074878036976e-06,"elapsed_instrumentation":8.093798533082008e-05,"return_value":{"class":"Array","value":"[]","object_id":1062740,"size":0}},{"id":131647,"event":"call","thread_id":9160,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres"}},{"id":131648,"event":"return","thread_id":9160,"parent_id":131647,"elapsed":0.000715513,"elapsed_instrumentation":0.00010784401092678308},{"id":131649,"event":"call","thread_id":9160,"sql_query":{"sql":"INSERT INTO \"webhooks\" (\"url\", \"events\", \"secret\", \"enabled\", \"created_at\", \"updated_at\", \"template\") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING \"id\"","database_type":"postgres"}},{"id":131650,"event":"return","thread_id":9160,"parent_id":131649,"elapsed":0.002258453,"elapsed_instrumentation":0.00011071405606344342},{"id":131651,"event":"call","thread_id":9160,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres"}},{"id":131652,"event":"return","thread_id":9160,"parent_id":131651,"elapsed":0.00072927,"elapsed_instrumentation":0.000497333996463567},{"id":131653,"event":"call","thread_id":9160,"defined_class":"Webhook","method_id":"rotate_secret!","path":"app/models/webhook.rb","lineno":43,"static":false,"parameters":[],"receiver":{"class":"Webhook","object_id":1062980,"value":"#<Webhook:0x00007fc930db5780>"}},{"id":131654,"event":"call","thread_id":9160,"defined_class":"String","method_id":"unpack1","path":"<internal:pack>","lineno":28,"static":false,"parameters":[{"name":"fmt","class":"String","object_id":319240,"value":"H*","kind":"req"},{"name":"offset","class":"NilClass","object_id":4,"value":null,"kind":"key"}],"receiver":{"class":"String","object_id":1063020,"value":"___=_V_____3H_____\u0017_"}},{"id":131655,"event":"return","thread_id":9160,"parent_id":131654,"elapsed":7.71600753068924e-06,"elapsed_instrumentation":0.00020026200218126178,"return_value":{"class":"String","value":"af9caf3dd85690d695b5db334880ee95c6ae1793","object_id":1063040}},{"id":131656,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":1063060,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1062560,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc930ba1fe8>"}},{"id":131657,"event":"return","thread_id":9160,"parent_id":131656,"elapsed":0.00015244900714606047,"elapsed_instrumentation":0.0003961869515478611,"return_value":{"class":"Array","value":"[#<Proc:0x00007fc933157800 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933157940 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933157a80 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1062580,"size":3}},{"id":131658,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":1063080,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1062620,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc930ba1e08>"}},{"id":131659,"event":"call","thread_id":9160,"defined_class":"URLValidator","method_id":"validate_each","path":"app/validators/url_validator.rb","lineno":6,"static":false,"parameters":[{"name":"record","class":"Webhook","object_id":1062980,"value":"#<Webhook:0x00007fc930db5780>","kind":"req"},{"name":"attribute","class":"Symbol","object_id":1292188,"value":":url","kind":"req"},{"name":"value","class":"String","object_id":1063100,"value":"http://goldner.example/jorge","kind":"req"}],"receiver":{"class":"URLValidator","object_id":1062680,"value":"#<URLValidator:0x00007fc9385cace8>"}},{"id":131660,"event":"return","thread_id":9160,"parent_id":131659,"elapsed":0.0004315430414862931,"elapsed_instrumentation":0.0001391050172969699},{"id":131661,"event":"return","thread_id":9160,"parent_id":131658,"elapsed":0.0007900220225565135,"elapsed_instrumentation":0.00024690100690349936,"return_value":{"class":"Array","value":"[#<Proc:0x00007fc9331554d8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155690 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155870 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155a50 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155c30 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155e10 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933155ff0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933156130 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fc933156270 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":1062700,"size":9}},{"id":131662,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":1063080,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1062620,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc930ba1e08>"}},{"id":131663,"event":"return","thread_id":9160,"parent_id":131662,"elapsed":6.579968612641096e-06,"elapsed_instrumentation":0.0001451399875804782,"return_value":{"class":"Array","value":"[]","object_id":1062720,"size":0}},{"id":131664,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":1063060,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":1062560,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fc930ba1fe8>"}},{"id":131665,"event":"return","thread_id":9160,"parent_id":131664,"elapsed":2.9060174711048603e-06,"elapsed_instrumentation":9.068998042494059e-05,"return_value":{"class":"Array","value":"[]","object_id":1062740,"size":0}},{"id":131666,"event":"call","thread_id":9160,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres"}},{"id":131667,"event":"return","thread_id":9160,"parent_id":131666,"elapsed":0.000576767,"elapsed_instrumentation":0.00010314199607819319},{"id":131668,"event":"call","thread_id":9160,"sql_query":{"sql":"UPDATE \"webhooks\" SET \"secret\" = $1, \"updated_at\" = $2 WHERE \"webhooks\".\"id\" = $3","database_type":"postgres"}},{"id":131669,"event":"return","thread_id":9160,"parent_id":131668,"elapsed":0.00199801,"elapsed_instrumentation":0.00016433099517598748},{"id":131670,"event":"call","thread_id":9160,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres"}},{"id":131671,"event":"return","thread_id":9160,"parent_id":131670,"elapsed":0.000825164,"elapsed_instrumentation":0.00010239100083708763},{"id":131672,"event":"return","thread_id":9160,"parent_id":131653,"elapsed":0.008375790028367192,"elapsed_instrumentation":0.00048810895532369614,"return_value":{"class":"TrueClass","value":"true","object_id":20}}]}