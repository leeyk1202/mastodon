{"version":"1.12.0","metadata":{"app":"mastodon","language":{"name":"ruby","engine":"ruby","version":"3.2.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.102.1"},"frameworks":[{"name":"rails","version":"7.1.1"},{"name":"rspec","version":"3.12.2"}],"git":{"repository":"https://github.com/sgrigson/mastodon.git","branch":"appmap-config","commit":"743782bd299fd54e12a4a5829872efc505132ab3","status":["M .husky/pre-commit","?? sql_warning.txt"],"git_last_annotated_tag":"0.1.2-14597-g743782bd299fd54e12a4a5829872efc505132ab3","git_last_tag":"v4.2.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Account validations when is local is valid if we are creating an instance actor account with a period","source_location":"spec/models/account_spec.rb","recorder":{"name":"rspec","type":"tests"},"test_status":"succeeded"},"classMap":[{"name":"openssl","type":"package","children":[{"name":"OpenSSL","type":"class","children":[{"name":"Random","type":"class","children":[{"name":"random_bytes","type":"function","location":"OpenSSL::Random.random_bytes","static":true,"labels":["random.secure"]}]}]}]},{"name":"activesupport","type":"package","children":[{"name":"ActiveSupport","type":"class","children":[{"name":"Callbacks","type":"class","children":[{"name":"CallbackSequence","type":"class","children":[{"name":"invoke_before","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:597","static":false,"labels":["mvc.before_action"]},{"name":"invoke_after","type":"function","location":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb:601","static":false,"labels":["mvc.after_action"]}]}]}]}]},{"name":"app","type":"package","children":[{"name":"models","type":"package","children":[{"name":"Account","type":"class","children":[{"name":"local?","type":"function","location":"app/models/account.rb:163","static":false}]}]},{"name":"validators","type":"package","children":[{"name":"UniqueUsernameValidator","type":"class","children":[{"name":"validate","type":"function","location":"app/validators/unique_username_validator.rb:6","static":false}]}]}]}],"events":[{"id":534869,"event":"call","thread_id":9160,"defined_class":"OpenSSL::Random","method_id":"random_bytes","path":"OpenSSL::Random.random_bytes","static":true,"parameters":[{"name":"arg","class":"Integer","object_id":33,"value":"16","kind":"req"}],"receiver":{"class":"Module","object_id":208620,"value":"OpenSSL::Random"}},{"id":534870,"event":"return","thread_id":9160,"parent_id":534869,"elapsed":3.1229021260514855e-05,"elapsed_instrumentation":0.0002736189926508814,"return_value":{"class":"String","value":"__\bm__M____\r_\u0000T_","object_id":3357500}},{"id":534871,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT \"users\".\"id\", \"users\".\"email\", \"users\".\"created_at\", \"users\".\"updated_at\", \"users\".\"encrypted_password\", \"users\".\"reset_password_token\", \"users\".\"reset_password_sent_at\", \"users\".\"sign_in_count\", \"users\".\"current_sign_in_at\", \"users\".\"last_sign_in_at\", \"users\".\"admin\", \"users\".\"confirmation_token\", \"users\".\"confirmed_at\", \"users\".\"confirmation_sent_at\", \"users\".\"unconfirmed_email\", \"users\".\"locale\", \"users\".\"encrypted_otp_secret\", \"users\".\"encrypted_otp_secret_iv\", \"users\".\"encrypted_otp_secret_salt\", \"users\".\"consumed_timestep\", \"users\".\"otp_required_for_login\", \"users\".\"last_emailed_at\", \"users\".\"otp_backup_codes\", \"users\".\"account_id\", \"users\".\"disabled\", \"users\".\"moderator\", \"users\".\"invite_id\", \"users\".\"chosen_languages\", \"users\".\"created_by_application_id\", \"users\".\"approved\", \"users\".\"sign_in_token\", \"users\".\"sign_in_token_sent_at\", \"users\".\"webauthn_id\", \"users\".\"sign_up_ip\", \"users\".\"role_id\", \"users\".\"settings\", \"users\".\"time_zone\" FROM \"users\" WHERE \"users\".\"account_id\" = $1 LIMIT $2","database_type":"postgres"}},{"id":534872,"event":"return","thread_id":9160,"parent_id":534871,"elapsed":0.000993755,"elapsed_instrumentation":0.00013211500481702387},{"id":534873,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":3357520,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":208680,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0db59d48>"}},{"id":534874,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534875,"event":"return","thread_id":9160,"parent_id":534874,"elapsed":1.6920996131375432e-05,"elapsed_instrumentation":0.0001234410156030208,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534876,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534877,"event":"return","thread_id":9160,"parent_id":534876,"elapsed":7.939990609884262e-06,"elapsed_instrumentation":0.00012610602425411344,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534878,"event":"return","thread_id":9160,"parent_id":534873,"elapsed":0.0006887039926368743,"elapsed_instrumentation":0.0002206799981649965,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0aa3ac30 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa3b040 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa3b1f8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa3b4c8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":208720,"size":4}},{"id":534879,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_before","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":597,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":3357560,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":208760,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0db59898>"}},{"id":534880,"event":"call","thread_id":9160,"defined_class":"UniqueUsernameValidator","method_id":"validate","path":"app/validators/unique_username_validator.rb","lineno":6,"static":false,"parameters":[{"name":"account","class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>","kind":"req"}],"receiver":{"class":"UniqueUsernameValidator","object_id":208780,"value":"#<UniqueUsernameValidator:0x00007fdc16b80188>"}},{"id":534881,"event":"call","thread_id":9160,"sql_query":{"sql":"SELECT 1 AS one FROM \"accounts\" WHERE LOWER(\"accounts\".\"username\") = 'example.com' AND LOWER(\"accounts\".\"domain\") IS NULL LIMIT $1","database_type":"postgres"}},{"id":534882,"event":"return","thread_id":9160,"parent_id":534881,"elapsed":0.001690507,"elapsed_instrumentation":0.00010857198503799736},{"id":534883,"event":"return","thread_id":9160,"parent_id":534880,"elapsed":0.0028094959852751344,"elapsed_instrumentation":0.0005844100378453732},{"id":534884,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534885,"event":"return","thread_id":9160,"parent_id":534884,"elapsed":1.3329001376405358e-05,"elapsed_instrumentation":0.00018186599481850863,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534886,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534887,"event":"return","thread_id":9160,"parent_id":534886,"elapsed":9.306997526437044e-06,"elapsed_instrumentation":0.00010246899910271168,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534888,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534889,"event":"return","thread_id":9160,"parent_id":534888,"elapsed":5.2600225899368525e-06,"elapsed_instrumentation":7.4356998084113e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534890,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534891,"event":"return","thread_id":9160,"parent_id":534890,"elapsed":4.565023118630052e-06,"elapsed_instrumentation":6.925896741449833e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534892,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534893,"event":"return","thread_id":9160,"parent_id":534892,"elapsed":9.767012670636177e-06,"elapsed_instrumentation":0.0001450799754820764,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534894,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534895,"event":"return","thread_id":9160,"parent_id":534894,"elapsed":4.196015652269125e-06,"elapsed_instrumentation":6.802999996580184e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534896,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534897,"event":"return","thread_id":9160,"parent_id":534896,"elapsed":4.412984708324075e-06,"elapsed_instrumentation":6.625699461437762e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534898,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534899,"event":"return","thread_id":9160,"parent_id":534898,"elapsed":4.395988071337342e-06,"elapsed_instrumentation":6.00940256845206e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534900,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534901,"event":"return","thread_id":9160,"parent_id":534900,"elapsed":4.016008460894227e-06,"elapsed_instrumentation":5.945900920778513e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534902,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534903,"event":"return","thread_id":9160,"parent_id":534902,"elapsed":4.697998519986868e-06,"elapsed_instrumentation":6.4341991674155e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534904,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534905,"event":"return","thread_id":9160,"parent_id":534904,"elapsed":3.825000021606684e-06,"elapsed_instrumentation":5.889995372854173e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534906,"event":"call","thread_id":9160,"defined_class":"Account","method_id":"local?","path":"app/models/account.rb","lineno":163,"static":false,"parameters":[],"receiver":{"class":"Account","object_id":3357540,"value":"#<Account:0x00007fdc06610140>"}},{"id":534907,"event":"return","thread_id":9160,"parent_id":534906,"elapsed":7.4830022640526295e-06,"elapsed_instrumentation":0.0002902470005210489,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":534908,"event":"return","thread_id":9160,"parent_id":534879,"elapsed":0.006542887014802545,"elapsed_instrumentation":0.0002688750100787729,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0aa57768 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa57920 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa57ab0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa57cb8 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa58050 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa58370 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa58960 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa58e10 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa590e0 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib, #<Proc:0x00007fdc0aa59360 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib (...61 more items)]","object_id":209280,"size":71}},{"id":534909,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":3357560,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":208760,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0db59898>"}},{"id":534910,"event":"return","thread_id":9160,"parent_id":534909,"elapsed":3.0400115065276623e-06,"elapsed_instrumentation":9.138599853031337e-05,"return_value":{"class":"Array","value":"[]","object_id":209300,"size":0}},{"id":534911,"event":"call","thread_id":9160,"defined_class":"ActiveSupport::Callbacks::CallbackSequence","method_id":"invoke_after","path":"vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib/active_support/callbacks.rb","lineno":601,"static":false,"parameters":[{"name":"arg","class":"ActiveSupport::Callbacks::Filters::Environment","object_id":3357520,"value":null,"kind":"req"}],"receiver":{"class":"ActiveSupport::Callbacks::CallbackSequence","object_id":208680,"value":"#<ActiveSupport::Callbacks::CallbackSequence:0x00007fdc0db59d48>"}},{"id":534912,"event":"return","thread_id":9160,"parent_id":534911,"elapsed":1.064501702785492e-05,"elapsed_instrumentation":8.852800237946212e-05,"return_value":{"class":"Array","value":"[#<Proc:0x00007fdc0aa3a730 /workspaces/mastodon/vendor/bundle/ruby/3.2.0/gems/activesupport-7.1.1/lib]","object_id":209320,"size":1}}]}