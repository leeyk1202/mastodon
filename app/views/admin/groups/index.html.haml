- content_for :page_title do
  = t('admin.groups.title')

- content_for :header_tags do
  = javascript_pack_tag 'admin', async: true, crossorigin: 'anonymous'

= form_tag admin_groups_url, method: 'GET', class: 'simple_form' do
  .filters
    .filter-subset.filter-subset--with-select
      %strong= t('admin.accounts.location.title')
      .input.select.optional
        = select_tag :origin, options_for_select([[t('admin.accounts.location.local'), 'local'], [t('admin.accounts.location.remote'), 'remote']], params[:origin]), prompt: I18n.t('generic.all')
    .filter-subset.filter-subset--with-select
      %strong= t('admin.accounts.moderation.title')
      .input.select.optional
        = select_tag :status, options_for_select([[t('admin.accounts.moderation.active'), 'active'], [t('admin.accounts.moderation.suspended'), 'suspended']], params[:status]), prompt: I18n.t('generic.all')
    .filter-subset.filter-subset--with-select
      %strong= t 'generic.order_by'
      .input.select
        = select_tag :order, options_for_select([[t('relationships.most_recent'), 'recent'], [t('relationships.last_active'), 'active']], params[:order])

  .fields-group
    - %i(by_domain display_name).each do |key|
      - unless key == :by_domain && params[:origin] != 'remote'
        .input.string.optional
          = text_field_tag key, params[key], class: 'string optional', placeholder: I18n.t("admin.accounts.#{key}")

  .actions
    %button.button= t('admin.accounts.search')
    = link_to t('admin.accounts.reset'), admin_groups_path, class: 'button negative'

%hr.spacer/

= form_for(@form, url: batch_admin_groups_path) do |f|
  = hidden_field_tag :page, params[:page] || 1
  = hidden_field_tag :select_all_matching, '0'

  - GroupFilter::KEYS.each do |key|
    = hidden_field_tag key, params[key] if params[key].present?

  .batch-table
    .batch-table__toolbar
      %label.batch-table__toolbar__select.batch-checkbox-all
        = check_box_tag :batch_checkbox_all, nil, false
      .batch-table__toolbar__actions
        = f.button safe_join([fa_icon('lock'), t('admin.accounts.perform_full_suspension')]), name: :suspend, class: 'table-action-link', type: :submit, data: { confirm: t('admin.reports.are_you_sure') }
    - if @groups.total_count > @groups.size
      .batch-table__select-all
        .not-selected.active
          %span= t('generic.all_items_on_page_selected_html', count: @groups.size)
          %button{ type: 'button' }= t('generic.select_all_matching_items', count: @groups.total_count)
        .selected
          %span= t('generic.all_matching_items_selected_html', count: @groups.total_count)
          %button{ type: 'button' }= t('generic.deselect')
    .batch-table__body
      - if @groups.empty?
        = nothing_here 'nothing-here--under-tabs'
      - else
        = render partial: 'group', collection: @groups, locals: { f: f }

= paginate @groups
