- instance_presenter = InstancePresenter.new

= content_for :heading do
  .email-desktop-flex
    .email-header-left
      = render 'application/mailer/heading', heading_title: t('.title', name: @resource.account.username), heading_subtitle: t('.explanation')
    .email-header-right
      .email-header-card
        %table.email-header-card-table{ cellspacing: 0, cellpadding: 0, border: 0, role: 'presentation' }
          %tr
            %td
              %table.email-w-full{ cellspacing: 0, cellpadding: 0, border: 0, role: 'presentation' }
                %tr
                  %td.email-header-card-banner-td{ height: 140, background: full_asset_url(instance_presenter.thumbnail&.file&.url(:'@1x') || frontend_asset_path('images/preview.png')) }
              %table.email-w-full{ cellspacing: 0, cellpadding: 0, border: 0, role: 'presentation' }
                %tr
                  %td.email-header-card-body-td
                    %p.email-header-card-instance= @instance
                    - if instance_presenter.description.present?
                      %p.email-header-card-description= instance_presenter.description
                    = render 'application/mailer/button', text: t('.sign_in_action'), url: new_user_session_url, has_arrow: false

%table.email-w-full{ cellspacing: 0, cellpadding: 0, border: 0, role: 'presentation' }
  %tr
    %td.email-body-huge-padding-td
      %h2.email-h2= t('.checklist_title')
      %p.email-h-sub= t('.checklist_subtitle')
      = render 'application/mailer/checklist', key: 'edit_profile_step', title: t('.edit_profile_title'), text: t('.edit_profile_step'), checked: @has_account_fields, button_text: t('.edit_profile_action'), button_url: web_url('start/profile')
      = render 'application/mailer/checklist', key: 'follow_step', title: t('.follow_title'), text: t('.follow_step'), checked: @has_active_relationships, button_text: t('.follow_action'), button_url: web_url('start/follows')
      = render 'application/mailer/checklist', key: 'post_step', title: t('.post_title'), text: t('.post_step'), checked: @has_statuses, button_text: t('.post_action'), button_url: web_url
      = render 'application/mailer/checklist', key: 'share_step', title: t('.share_title'), text: t('.share_step'), checked: false, button_text: t('.share_action'), button_url: web_url('start/share')
      = render 'application/mailer/checklist', key: 'apps_step', title: t('.apps_title'), text: t('.apps_step'), checked: false, show_apps_buttons: true
%table.email-w-full{ cellspacing: 0, cellpadding: 0, border: 0, role: 'presentation' }
  %tr
    %td.email-body-columns-td
      .email-desktop-flex
        /[if mso]
          <table border="0" cellpadding="0" cellspacing="0" align="center" style="width:100%;" role="presentation"><tr><td style="width:50%; vertical-align:top;">
        .email-desktop-column
          %table.email-w-full{ cellspacing: 0, cellpadding: 0, border: 0, role: 'presentation' }
            %tr
              %td.email-column-td
                %h2.email-h2= t('.follows_title')
                %p.email-h-sub= t('.follows_subtitle')
                = render partial: 'application/mailer/follow', collection: @suggestions
                %table.email-w-full{ cellspacing: 0, cellpadding: 0, border: 0, role: 'presentation' }
                  %tr
                    %td.email-column-action-td
                      = link_to '', href: web_url('explore/suggestions'), class: 'email-link-with-arrow' do
                        = t('.follows_view_more')
                        %span= '❯'
        /[if mso]
          </td><td style="width:50%; vertical-align:top;">
        .email-desktop-column
          %table.email-w-full{ cellspacing: 0, cellpadding: 0, border: 0, role: 'presentation' }
            %tr
              %td.email-column-td
                %h2.email-h2= t('.hashtags_title')
                %p.email-h-sub= t('.hashtags_subtitle')
                = render partial: 'application/mailer/hashtag', collection: @tags
                %table.email-w-full{ cellspacing: 0, cellpadding: 0, border: 0, role: 'presentation' }
                  %tr
                    %td.email-column-action-td
                      = link_to '', href: web_url('explore/tags'), class: 'email-link-with-arrow' do
                        = t('.hashtags_view_more')
                        %span= '❯'
        /[if mso]
          </td></tr></table>
.email-extra-wave
%table.email-w-full{ cellspacing: 0, cellpadding: 0, border: 0, role: 'presentation' }
  %tr
    %td.email-extra-td
      = render 'application/mailer/feature', key: 'feature_control', feature_title: t('.feature_control_title'), feature_text: t('.feature_control'), text_first_on_desktop: true
      = render 'application/mailer/feature', key: 'feature_audience', feature_title: t('.feature_audience_title'), feature_text: t('.feature_audience'), text_first_on_desktop: false
      = render 'application/mailer/feature', key: 'feature_moderation', feature_title: t('.feature_moderation_title'), feature_text: t('.feature_moderation'), text_first_on_desktop: true
      = render 'application/mailer/feature', key: 'feature_creativity', feature_title: t('.feature_creativity_title'), feature_text: t('.feature_creativity'), text_first_on_desktop: false
